<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ANLY560 Time Series Project - Tegveer Ghura - ARMA/ARIMA/SARIMA Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">ARMA/ARIMA/SARIMA Models</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ANLY560 Time Series Project - Tegveer Ghura</a> 
        <div class="sidebar-tools-main">
    <a href="https://www.linkedin.com/in/tegveerg/" title="" class="sidebar-tool px-1"><i class="bi bi-linkedin"></i></a>
    <a href="" title="" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-github"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/TegveerG/Time-Series-Project">
          Source Code
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">About Tegveer</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data-Sources.html" class="sidebar-item-text sidebar-link">Data Sources</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data-Visualization.html" class="sidebar-item-text sidebar-link">Data Visualization</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Exploratory-Data-Analysis.html" class="sidebar-item-text sidebar-link">Exploratory Data Analysis</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ARMA-ARIMA-SARIMA.html" class="sidebar-item-text sidebar-link active">ARMA/ARIMA/SARIMA Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ARIMAX-SARIMAX-VAR.html" class="sidebar-item-text sidebar-link">ARIMAX/SARIMAX/VAR Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Financial-Models.html" class="sidebar-item-text sidebar-link">Financial Time Series Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Deep-Learning.html" class="sidebar-item-text sidebar-link">Deep Learning for TS</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Conclusion.html" class="sidebar-item-text sidebar-link">Conclusion</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#global-terrorism-database-arima-modeling" id="toc-global-terrorism-database-arima-modeling" class="nav-link" data-scroll-target="#global-terrorism-database-arima-modeling">Global Terrorism Database ARIMA Modeling</a>
  <ul class="collapse">
  <li><a href="#splitting-series-into-train-and-test-sets-for-model-validation-process" id="toc-splitting-series-into-train-and-test-sets-for-model-validation-process" class="nav-link" data-scroll-target="#splitting-series-into-train-and-test-sets-for-model-validation-process">Splitting Series into Train and Test Sets for Model Validation Process</a></li>
  <li><a href="#ACF" id="toc-ACF" class="nav-link" data-scroll-target="#ACF">ACF and PACF Plots of Monthly Attacks</a></li>
  <li><a href="#adf-test-of-monthly-attacks" id="toc-adf-test-of-monthly-attacks" class="nav-link" data-scroll-target="#adf-test-of-monthly-attacks">ADF Test of Monthly Attacks</a></li>
  <li><a href="#log-transformation-of-monthly-attacks-and-its-first-and-second-order-differencing" id="toc-log-transformation-of-monthly-attacks-and-its-first-and-second-order-differencing" class="nav-link" data-scroll-target="#log-transformation-of-monthly-attacks-and-its-first-and-second-order-differencing">Log-Transformation of Monthly Attacks and its First and Second Order Differencing</a></li>
  <li><a href="#adf-test-of-log-first-differenced-monthly-attacks" id="toc-adf-test-of-log-first-differenced-monthly-attacks" class="nav-link" data-scroll-target="#adf-test-of-log-first-differenced-monthly-attacks">ADF Test of Log First-Differenced Monthly Attacks</a></li>
  <li><a href="#lACF" id="toc-lACF" class="nav-link" data-scroll-target="#lACF">ACF and PACF Plots of Log First-Differenced Monthly Attacks</a></li>
  <li><a href="#best-fit" id="toc-best-fit" class="nav-link" data-scroll-target="#best-fit">Fitting ARIMA(p,d,q)</a></li>
  <li><a href="#ARIMA-Diag" id="toc-ARIMA-Diag" class="nav-link" data-scroll-target="#ARIMA-Diag">Model Diagnostics of ARIMA(0,1,1)</a></li>
  <li><a href="#model-diagnostics-of-arima213" id="toc-model-diagnostics-of-arima213" class="nav-link" data-scroll-target="#model-diagnostics-of-arima213">Model Diagnostics of ARIMA(2,1,3)</a></li>
  <li><a href="#checking-model-output-of-log-monthly-attacks-with-auto.arima" id="toc-checking-model-output-of-log-monthly-attacks-with-auto.arima" class="nav-link" data-scroll-target="#checking-model-output-of-log-monthly-attacks-with-auto.arima">Checking Model Output of Log Monthly Attacks with auto.arima()</a></li>
  <li><a href="#forecasting-arima011-and-arima213" id="toc-forecasting-arima011-and-arima213" class="nav-link" data-scroll-target="#forecasting-arima011-and-arima213">Forecasting ARIMA(0,1,1) and ARIMA(2,1,3)</a></li>
  <li><a href="#forecasting-arima011-using-sarima.for" id="toc-forecasting-arima011-using-sarima.for" class="nav-link" data-scroll-target="#forecasting-arima011-using-sarima.for">Forecasting ARIMA(0,1,1) using sarima.for()</a></li>
  <li><a href="#comparing-arima011-with-benchmarks" id="toc-comparing-arima011-with-benchmarks" class="nav-link" data-scroll-target="#comparing-arima011-with-benchmarks">Comparing ARIMA(0,1,1) with Benchmarks</a></li>
  </ul></li>
  <li><a href="#global-terrorism-database-sarima-modeling" id="toc-global-terrorism-database-sarima-modeling" class="nav-link" data-scroll-target="#global-terrorism-database-sarima-modeling">Global Terrorism Database SARIMA Modeling</a>
  <ul class="collapse">
  <li><a href="#visualizing-seasonal-components-of-monthly-attacks" id="toc-visualizing-seasonal-components-of-monthly-attacks" class="nav-link" data-scroll-target="#visualizing-seasonal-components-of-monthly-attacks">Visualizing Seasonal Components of Monthly Attacks</a></li>
  <li><a href="#visualizing-seasonally-differenced-monthly-attacks" id="toc-visualizing-seasonally-differenced-monthly-attacks" class="nav-link" data-scroll-target="#visualizing-seasonally-differenced-monthly-attacks">Visualizing Seasonally Differenced Monthly Attacks</a></li>
  <li><a href="#acf-and-pacf-plots-of-seasonally-differenced-monthly-attacks" id="toc-acf-and-pacf-plots-of-seasonally-differenced-monthly-attacks" class="nav-link" data-scroll-target="#acf-and-pacf-plots-of-seasonally-differenced-monthly-attacks">ACF and PACF Plots of Seasonally Differenced Monthly Attacks</a></li>
  <li><a href="#acf-and-pacf-plots-of-seasonally-and-first-order-differenced-monthly-attacks" id="toc-acf-and-pacf-plots-of-seasonally-and-first-order-differenced-monthly-attacks" class="nav-link" data-scroll-target="#acf-and-pacf-plots-of-seasonally-and-first-order-differenced-monthly-attacks">ACF and PACF Plots of Seasonally and First Order Differenced Monthly Attacks</a></li>
  <li><a href="#fitting-arimapdqpdq" id="toc-fitting-arimapdqpdq" class="nav-link" data-scroll-target="#fitting-arimapdqpdq">Fitting ARIMA(p,d,q)(P,D,Q)</a></li>
  <li><a href="#model-diagnostics-of-arima011011" id="toc-model-diagnostics-of-arima011011" class="nav-link" data-scroll-target="#model-diagnostics-of-arima011011">Model Diagnostics of ARIMA(0,1,1)(0,1,1)</a></li>
  <li><a href="#forecast-for-the-next-3-years-using-arima011011" id="toc-forecast-for-the-next-3-years-using-arima011011" class="nav-link" data-scroll-target="#forecast-for-the-next-3-years-using-arima011011">Forecast for the next 3 years using ARIMA(0,1,1)(0,1,1)</a></li>
  <li><a href="#comparing-arima011011-with-benchmarks" id="toc-comparing-arima011011-with-benchmarks" class="nav-link" data-scroll-target="#comparing-arima011011-with-benchmarks">Comparing ARIMA(0,1,1)(0,1,1) with benchmarks</a></li>
  <li><a href="#seasonal-cross-validation-of-arima011011-and-arima111011-using-1-step-ahead-forecasts" id="toc-seasonal-cross-validation-of-arima011011-and-arima111011-using-1-step-ahead-forecasts" class="nav-link" data-scroll-target="#seasonal-cross-validation-of-arima011011-and-arima111011-using-1-step-ahead-forecasts">Seasonal Cross Validation of ARIMA(0,1,1)(0,1,1) and ARIMA(1,1,1)(0,1,1) using 1 step ahead forecasts</a></li>
  <li><a href="#seasonal-cross-validation-of-arima011011-and-arima111011-using-12-steps-seasonal-period-ahead-forecasts" id="toc-seasonal-cross-validation-of-arima011011-and-arima111011-using-12-steps-seasonal-period-ahead-forecasts" class="nav-link" data-scroll-target="#seasonal-cross-validation-of-arima011011-and-arima111011-using-12-steps-seasonal-period-ahead-forecasts">Seasonal Cross Validation of ARIMA(0,1,1)(0,1,1) and ARIMA(1,1,1)(0,1,1) using 12 steps (seasonal period) ahead forecasts</a></li>
  </ul></li>
  <li><a href="#section-code" id="toc-section-code" class="nav-link" data-scroll-target="#section-code">Section Code</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">ARMA/ARIMA/SARIMA Models</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>After completing the exploratory data analysis (EDA) phase, the next step is to begin building time series models. In order to do so, one must first choose an appropriate model type, such as an ARMA (AutoRegressive Moving Average) model or one of its variations, including ARIMA (AutoRegressive Integrated Moving Average) or SARIMA (Seasonal AutoRegressive Integrated Moving Average).</p>
<p>An ARIMA model is generally notated as ARIMA(p,d,q) where p is the order of the AR process, d is the degree of differencing and q is the order of the MA process. The general equation of the model is given as follows:</p>
<p><span class="math inline">\(\phi(B)(1-B)^d x_t = \delta + \theta(B) w_t\)</span>, where <span class="math inline">\(B\)</span> is the backshift operator, <span class="math inline">\(w_t\)</span> is the Gaussian white noise process, <span class="math inline">\(\delta\)</span> is the drift term and <span class="math inline">\(\phi(B)\)</span> and <span class="math inline">\(\theta(B)\)</span> correspond to the AR and MA parts respectively.</p>
<p>Lag plots, auto-correlation function (ACF) and partial auto-correlation function (PACF) plots, decomposing the time series, and differencing are all useful techniques that were employed during the EDA phase to help inform the choice of model type and parameters. With a solid understanding of the data and its characteristics, one can begin to develop and refine time series models that can be used for forecasting.</p>
</section>
<section id="global-terrorism-database-arima-modeling" class="level2">
<h2 class="anchored" data-anchor-id="global-terrorism-database-arima-modeling">Global Terrorism Database ARIMA Modeling</h2>
<div class="cell">

</div>
<section id="splitting-series-into-train-and-test-sets-for-model-validation-process" class="level3">
<h3 class="anchored" data-anchor-id="splitting-series-into-train-and-test-sets-for-model-validation-process">Splitting Series into Train and Test Sets for Model Validation Process</h3>
<p>After cleaning and aggregating the Global Terrorism Database™ (GTD) <span class="citation" data-cites="GTD">(<a href="#ref-GTD" role="doc-biblioref"><span>“Codebook Methodology Inclusion Criteria and Variables - UMD,”</span> n.d.</a>)</span> by month, we shall be splitting the aggregated monthly data set into train and test sets for model validation. I have kept 587 observations for training and the remaining 48 observations for testing or validating. Therefore, I have kept aside 2 years (48 months or 48 observations) for forecasting purposes.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>train_series<span class="ot">=</span>monthly_attacks_ts[<span class="dv">1</span><span class="sc">:</span><span class="dv">587</span>] <span class="co"># close to 92%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>test_series<span class="ot">=</span>monthly_attacks_ts[<span class="dv">588</span><span class="sc">:</span><span class="dv">612</span>] <span class="co"># keeping 2 years (48 months or 48 observations) to predict/forecast</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ACF" class="level3">
<h3 class="anchored" data-anchor-id="ACF">ACF and PACF Plots of Monthly Attacks</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>train_series <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtsdisplay</span>(<span class="at">main=</span><span class="st">"ACF and PACF Plots of Monthly Attacks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/pacf-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="adf-test-of-monthly-attacks" class="level3">
<h3 class="anchored" data-anchor-id="adf-test-of-monthly-attacks">ADF Test of Monthly Attacks</h3>
<p><span class="math inline">\(H_0\)</span>: The time series is non-stationary. In other words, it has some time-dependent structure and does not have constant variance over time.</p>
<p><span class="math inline">\(H_1\)</span>: The time series is stationary.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(train_series)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  train_series
Dickey-Fuller = -7.2458, Lag order = 8, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>Because the p-value from the ADF test is less than <span class="math inline">\(\alpha\)</span> = 0.05, we reject the null hypothesis and conclude that the monthly attacks series is stationary. Although the ADF states that the original series is stationary, the ACF plots, which clearly indicate seasonality and trend, are more reliable than the ADF test. Therefore, it is safe to conclude that the series non-stationary as per the <a href="#ACF">ACF</a> section above.</p>
</section>
<section id="log-transformation-of-monthly-attacks-and-its-first-and-second-order-differencing" class="level3">
<h3 class="anchored" data-anchor-id="log-transformation-of-monthly-attacks-and-its-first-and-second-order-differencing">Log-Transformation of Monthly Attacks and its First and Second Order Differencing</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>lx <span class="ot">=</span> <span class="fu">log</span>(train_series<span class="sc">+</span><span class="dv">1</span>); dlx <span class="ot">=</span> <span class="fu">diff</span>(lx); ddlx <span class="ot">=</span> <span class="fu">diff</span>(dlx, <span class="dv">12</span>) <span class="co"># add 1 to lx to not get NAs</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> train_series</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(<span class="fu">cbind</span>(x,lx,dlx,ddlx), <span class="at">main=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/logadf-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">monthplot</span>(dlx); <span class="fu">monthplot</span>(ddlx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/logadf-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Simply taking log of the number of monthly attacks does not make it stationary. First-differencing the log number of monthly attacks does, however, make the series stationary and this series should be employed for building our time series model. Keep in mind that because first-differencing was enough to make the series stationary, we do not need to second-difference it, helping us avoid over differencing the number of monthly attacks.</p>
</section>
<section id="adf-test-of-log-first-differenced-monthly-attacks" class="level3">
<h3 class="anchored" data-anchor-id="adf-test-of-log-first-differenced-monthly-attacks">ADF Test of Log First-Differenced Monthly Attacks</h3>
<p><span class="math inline">\(H_0\)</span>: The time series is non-stationary. In other words, it has some time-dependent structure and does not have constant variance over time.</p>
<p><span class="math inline">\(H_1\)</span>: The time series is stationary.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(dlx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  dlx
Dickey-Fuller = -12.802, Lag order = 8, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>Because the p-value from the ADF test is less than <span class="math inline">\(\alpha\)</span> = 0.05, we reject the null hypothesis and conclude that the log first-differenced monthly attacks series is stationary. Let us now check whether the ACF plots supports this hypothesis.</p>
</section>
<section id="lACF" class="level3">
<h3 class="anchored" data-anchor-id="lACF">ACF and PACF Plots of Log First-Differenced Monthly Attacks</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dlx <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtsdisplay</span>(<span class="at">main=</span><span class="st">"ACF and PACF Plots of Log First-Differenced Monthly Attacks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/lfdpacf-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>p</strong> values obtained from PACF are 0, 1, 2, 3, 4 <strong>q</strong> values obtained from ACF are: 0, 1 <strong>d</strong> (Difference): 1</p>
</section>
<section id="best-fit" class="level3">
<h3 class="anchored" data-anchor-id="best-fit">Fitting ARIMA(p,d,q)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">24</span>),<span class="at">nrow=</span><span class="dv">24</span>) <span class="co"># roughly nrow = 3x4x2</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># p=0,1,2,3,4 </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="co"># q=0,1,2,3 (although we only found q=1 to be significant in ACF, we may want to compare a complex ARIMA model with greater "q" value compared to a simpler ARIMA model)</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span>)<span class="co"># d=1</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(lx,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>)) </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> temp[<span class="fu">order</span>(temp<span class="sc">$</span>BIC, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),] </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1129.146</td>
<td style="text-align: right;">1137.892</td>
<td style="text-align: right;">1129.166</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1131.028</td>
<td style="text-align: right;">1144.148</td>
<td style="text-align: right;">1131.069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1131.045</td>
<td style="text-align: right;">1144.165</td>
<td style="text-align: right;">1131.087</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1120.047</td>
<td style="text-align: right;">1146.287</td>
<td style="text-align: right;">1120.192</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1130.116</td>
<td style="text-align: right;">1147.609</td>
<td style="text-align: right;">1130.185</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1130.121</td>
<td style="text-align: right;">1147.614</td>
<td style="text-align: right;">1130.189</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1133.117</td>
<td style="text-align: right;">1150.610</td>
<td style="text-align: right;">1133.186</td>
</tr>
<tr class="even">
<td style="text-align: left;">14</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1131.179</td>
<td style="text-align: right;">1153.046</td>
<td style="text-align: right;">1131.283</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1131.272</td>
<td style="text-align: right;">1153.139</td>
<td style="text-align: right;">1131.376</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1131.710</td>
<td style="text-align: right;">1153.577</td>
<td style="text-align: right;">1131.813</td>
</tr>
<tr class="odd">
<td style="text-align: left;">16</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1126.189</td>
<td style="text-align: right;">1156.802</td>
<td style="text-align: right;">1126.383</td>
</tr>
<tr class="even">
<td style="text-align: left;">18</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1132.357</td>
<td style="text-align: right;">1158.597</td>
<td style="text-align: right;">1132.502</td>
</tr>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1132.897</td>
<td style="text-align: right;">1159.137</td>
<td style="text-align: right;">1133.042</td>
</tr>
<tr class="even">
<td style="text-align: left;">19</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1132.672</td>
<td style="text-align: right;">1163.285</td>
<td style="text-align: right;">1132.866</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1134.670</td>
<td style="text-align: right;">1169.657</td>
<td style="text-align: right;">1134.920</td>
</tr>
<tr class="even">
<td style="text-align: left;">17</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1176.672</td>
<td style="text-align: right;">1198.538</td>
<td style="text-align: right;">1176.775</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1187.101</td>
<td style="text-align: right;">1204.594</td>
<td style="text-align: right;">1187.170</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1201.337</td>
<td style="text-align: right;">1214.457</td>
<td style="text-align: right;">1201.379</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1255.509</td>
<td style="text-align: right;">1264.255</td>
<td style="text-align: right;">1255.529</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1434.634</td>
<td style="text-align: right;">1439.007</td>
<td style="text-align: right;">1434.640</td>
</tr>
<tr class="odd">
<td style="text-align: left;">21</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">22</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">24</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of AIC: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 Best Model in terms of AIC: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
12 2 1 3 1120.047 1146.287 1120.192</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of AICc: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 Best Model in terms of AICc: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q      AIC      BIC     AICc
12 2 1 3 1120.047 1146.287 1120.192</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of BIC: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 Best Model in terms of BIC: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q      AIC      BIC     AICc
2 0 1 1 1129.146 1137.892 1129.166</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model summary and error metrics of ARIMA(0, 1, 1): </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Model summary and error metrics of ARIMA(0, 1, 1): </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(lx, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># no drift included </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lx 
ARIMA(0,1,1) 

Coefficients:
          ma1
      -0.8436
s.e.   0.0240

sigma^2 = 0.3992:  log likelihood = -562.57
AIC=1129.15   AICc=1129.17   BIC=1137.89

Training set error measures:
                     ME      RMSE       MAE  MPE MAPE      MASE       ACF1
Training set -0.0182295 0.6307598 0.4949849 -Inf  Inf 0.7886882 0.01012716</code></pre>
</div>
</div>
<p>The best model with the lowest BIC metric is the ARIMA(0,1,1). This model is a pure moving average model with first-order differencing and a single lagged moving average term. Therefore, the model has no autoregressive terms, i.e., it does not use the past values of the variable to predict its future values. It uses only the difference between the current and previous values of the variable and the error term to make the forecast. Although, according to both AIC and AICc metrics, the ARIMA(2,1,3) model is better, we shall choose our model using the BIC metric because BIC is more stringent than AIC in penalizing the number of parameters used in the model, making it more effective in helping reduce overfitting.</p>
<p>ARIMA(2,1,3) is a time series model that involves taking the first-order difference of the series, using two Autoregressive (AR) terms and three Moving Average (MA) terms. This means that the model uses not only the past two values of the variable, but also the past three errors to make the forecast. The inclusion of the MA terms allows the model to capture the influence of random shocks or noise in the data. However, including too many autoregressive terms may lead to overfitting, which can result in poor forecast performance and we shall explore that in the next few sections</p>
<p>The choice between ARIMA(0,1,1) and ARIMA(2,1,3) depends on the nature of the data and the performance of the models in terms of RMSE or other error metrics. If the data has a clear trend, then including Autoregressive terms may improve the forecast accuracy. On the other hand, if the data is more random, then a simpler model like ARIMA(0,1,1) may be sufficient. There is a clear decreasing trend of monthly terrorist attacks from the 1970s to 2015, with random and/or seasonal fluctuations, but the number of attacks does start increasing sharply after 2015. Therefore, no single pattern is discerned along the entire series and, moreover, we shall be abiding by the principle of parsimony if we select ARIMA(0,1,1) as the best model.</p>
<p>The equation of the ARIMA(0,1,1) model is given by:</p>
<p><span class="math inline">\(\begin{equation}(1-B)(1-\theta_1B)X_t = \omega_t\end{equation}\)</span>, giving us:</p>
<p><span class="math inline">\(\begin{equation}\left(1-\theta_1B+B-\theta_1B^2\right)X_t = \omega_t\end{equation}\)</span>, giving us:</p>
<p><span class="math inline">\(\begin{equation}\left(1-\theta_1B\right)X_t - B\left(1-\theta_1B\right)X_t = \omega_t\end{equation}\)</span>, giving us:</p>
<p><span class="math inline">\(\begin{equation}X_t - \theta_1X_{t-1} - B\left(X_{t-1}-\theta_1X_{t-2}\right) = \omega_t\end{equation}\)</span>, finally substituting the MA(1) values from the model’s summary:</p>
<p><span class="math inline">\(\begin{equation}X_t = -0.8436X_{t-1} + X_{t-1} + 0.8436X_{t-2} + \omega_t\end{equation}\)</span>, where <span class="math inline">\((1-B)\)</span> is the differencing operator, which represents the first-order difference of the series. <span class="math inline">\(X_t\)</span> is the time series, <span class="math inline">\(\theta_1\)</span> is the parameter of the MA component, and <span class="math inline">\(\omega_t\)</span> is the Gaussian white noise process.</p>
<p>Note that <span class="math inline">\(B\)</span> is the backshift operator, which shifts the time series back by one period.</p>
</section>
<section id="ARIMA-Diag" class="level3">
<h3 class="anchored" data-anchor-id="ARIMA-Diag">Model Diagnostics of ARIMA(0,1,1)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(lx, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">24</span><span class="sc">:</span><span class="dv">55</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>converged
$fit

Call:
arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
    xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
        REPORT = 1, reltol = tol))

Coefficients:
          ma1  constant
      -0.8453   -0.0028
s.e.   0.0239    0.0041

sigma^2 estimated as 0.3982:  log likelihood = -562.33,  aic = 1130.67

$degrees_of_freedom
[1] 584

$ttable
         Estimate     SE  t.value p.value
ma1       -0.8453 0.0239 -35.3385  0.0000
constant  -0.0028 0.0041  -0.6943  0.4877

$AIC
[1] 1.929468

$AICc
[1] 1.929504

$BIC
[1] 1.951857</code></pre>
</div>
</div>
<p>Standardized Residuals: Essentially stating that if the errors are white noise. The model does look stationary as it captures all the signals and essentially captures the raw white noise.</p>
<p>ACF Of Residuals: Auto-correlation of the residuals. The only <strong>q</strong> value to inspect is 1.</p>
<p>Q-Q Plot: The series follows a normal distribution pretty closely as even the tails seem to be on the normal line.</p>
<p>p values of the Ljung-Box statistic: Ideally, we would like to fail to reject the null hypothesis. That is, we would like to see the p-value of the test be greater than 0.05 because this means the residuals for our time series model are independent, which is often an assumption we make when creating a model. Since all lag values greater than 5 have a p-value greater than 0.05, the residuals have no remaining autocorrelations.</p>
<p>The only MA term in the ARIMA(0,1,1) model is also significant at the <span class="math inline">\(\alpha\)</span>=5% level as shown by its p-value = 0. Let’s check whether all terms in the ARIMA(2,1,3) model are significant or not.</p>
</section>
<section id="model-diagnostics-of-arima213" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics-of-arima213">Model Diagnostics of ARIMA(2,1,3)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model_output2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(lx, <span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output2[<span class="dv">205</span><span class="sc">:</span><span class="dv">239</span>], model_output2[<span class="fu">length</span>(model_output2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$fit

Call:
arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
    xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
        REPORT = 1, reltol = tol))

Coefficients:
         ar1      ar2      ma1     ma2      ma3  constant
      0.8068  -0.5518  -1.6452  1.2913  -0.5429   -0.0026
s.e.  0.4763   0.4308   0.4609  0.7776   0.3347    0.0036

sigma^2 estimated as 0.3934:  log likelihood = -558.77,  aic = 1131.54

$degrees_of_freedom
[1] 580

$ttable
         Estimate     SE t.value p.value
ar1        0.8068 0.4763  1.6939  0.0908
ar2       -0.5518 0.4308 -1.2809  0.2007
ma1       -1.6452 0.4609 -3.5693  0.0004
ma2        1.2913 0.7776  1.6608  0.0973
ma3       -0.5429 0.3347 -1.6223  0.1053
constant  -0.0026 0.0036 -0.7029  0.4824

$AIC
[1] 1.93095

$AICc
[1] 1.931198

$BIC
[1] 1.983192</code></pre>
</div>
</div>
<p>Like the ARIMA(0,1,1) output for the summary of residuals, the ARIMA(2,1,3) does as well, if not better. The ACF of residuals for ARIMA(2,1,3), although, has spikes less significant than ARIMA(0,1,1) and the p-values for Ljung-Box test for ARIMA(2,1,3) are higher than those of ARIMA(0,1,1). However, a key difference is that only the MA(1) term in the ARIMA(2,1,3) model is significant at the <span class="math inline">\(\alpha\)</span>=5% level as shown by its p-value = 0.0004 and all other terms are not significant. Therefore, a simpler model, ARIMA(0,1,1), would be a better fit to the log of monthly attacks series.</p>
<p>Let’s see what model is outputted by <code>auto.arima()</code>.</p>
</section>
<section id="checking-model-output-of-log-monthly-attacks-with-auto.arima" class="level3">
<h3 class="anchored" data-anchor-id="checking-model-output-of-log-monthly-attacks-with-auto.arima">Checking Model Output of Log Monthly Attacks with auto.arima()</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">auto.arima</span>(lx, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model metrics using auto.arima(): </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model metrics using auto.arima(): </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: lx 
ARIMA(0,1,1) 

Coefficients:
          ma1
      -0.8436
s.e.   0.0240

sigma^2 = 0.3992:  log likelihood = -562.57
AIC=1129.15   AICc=1129.17   BIC=1137.89

Training set error measures:
                     ME      RMSE       MAE  MPE MAPE      MASE       ACF1
Training set -0.0182295 0.6307598 0.4949849 -Inf  Inf 0.7886882 0.01012716</code></pre>
</div>
</div>
<p>From the above output, <code>auto.arima()</code> too outputted an ARIMA(0,1,1) model, which is is the best model returned by the <code>Arima()</code> function in terms of <a href="#best-fit">lowest BIC</a>. Some points to keep in mind when using these functions is as follows:</p>
<p>The <code>auto.arima()</code> function in R uses a stepwise algorithm to search through the space of possible ARIMA models and select the one with the lowest AIC value. While this approach can be computationally efficient and provide a good starting point for model selection, it does not necessarily always find the best possible model for a given time series.</p>
<p>On the other hand, the <code>Arima()</code> function in R allows us to specify the exact order of the ARIMA model and can be used to fit more complex models, such as those with seasonality, exogenous variables, or other constraints. By specifying the exact order of the model, we have more control over the modeling process and can potentially obtain a better fit to the data.</p>
<p>In summary, the <code>auto.arima()</code> function can be a useful tool for quickly identifying a potentially good model, but it is not a substitute for careful model selection and customization seen when using the <code>Arima()</code> function.</p>
</section>
<section id="forecasting-arima011-and-arima213" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-arima011-and-arima213">Forecasting ARIMA(0,1,1) and ARIMA(2,1,3)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>arimaModel_1 <span class="ot">&lt;-</span> <span class="fu">arima</span>(lx, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>arimaModel_2 <span class="ot">&lt;-</span> <span class="fu">arima</span>(lx, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>forecast1<span class="ot">=</span><span class="fu">predict</span>(arimaModel_1, <span class="fu">length</span>(test_series)) <span class="co"># make forecasts for 2 years ahead as given by length of test_series</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>forecast2<span class="ot">=</span><span class="fu">predict</span>(arimaModel_2, <span class="fu">length</span>(test_series))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the time series and forecast objects to data frames</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>ts_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">time</span>(monthly_attacks_ts), <span class="at">value =</span> <span class="fu">as.numeric</span>(monthly_attacks_ts))</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>train_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">time</span>(monthly_attacks_ts)[<span class="dv">1</span><span class="sc">:</span><span class="dv">587</span>], <span class="at">value =</span> <span class="fu">as.numeric</span>(lx))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>forecast1_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">time</span>(monthly_attacks_ts)[<span class="dv">588</span><span class="sc">:</span><span class="dv">612</span>], <span class="at">value =</span> forecast1<span class="sc">$</span>pred)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>forecast2_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">time</span>(monthly_attacks_ts)[<span class="dv">588</span><span class="sc">:</span><span class="dv">612</span>], <span class="at">value =</span> forecast2<span class="sc">$</span>pred)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the time series and forecasts</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(<span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> train_df[<span class="dv">500</span><span class="sc">:</span><span class="dv">588</span>,], <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, </span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"Actual Train Values"</span>), <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> train_df[<span class="dv">500</span><span class="sc">:</span><span class="dv">588</span>,], <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value), </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">alpha=</span><span class="fl">0.4</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> forecast1_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, </span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="st">"ARIMA(0,1,1) Forecast"</span>), <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> forecast2_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, </span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="st">"ARIMA(2,1,3) Forecast"</span>), <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> ts_df[<span class="dv">588</span><span class="sc">:</span><span class="dv">612</span>,], <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> <span class="fu">log</span>(value), </span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="st">"Actual Forecast Values"</span>), <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Log of Number of Monthly Attacks"</span>, <span class="at">title =</span> <span class="st">"Forecasting ARIMA(0,1,1) and ARIMA(2,1,3)"</span>) <span class="sc">+</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Forecast"</span>, </span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"ARIMA(0,1,1) Forecast"</span> <span class="ot">=</span> <span class="st">"blue"</span>, </span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"ARIMA(2,1,3) Forecast"</span> <span class="ot">=</span> <span class="st">"green"</span>,</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Actual Forecast Values"</span> <span class="ot">=</span> <span class="st">"orange"</span>),</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"ARIMA(0,1,1) Forecast"</span>, </span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"ARIMA(2,1,3) Forecast"</span>,</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Actual Forecast Values"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f7e7b93ac78d26755bf8" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f7e7b93ac78d26755bf8">{"x":{"data":[{"x":[2011.58333333333,2011.66666666667,2011.75,2011.83333333333,2011.91666666667,2012,2012.08333333333,2012.16666666667,2012.25,2012.33333333333,2012.41666666667,2012.5,2012.58333333333,2012.66666666667,2012.75,2012.83333333333,2012.91666666667,2013,2013.08333333333,2013.16666666667,2013.25,2013.33333333333,2013.41666666667,2013.5,2013.58333333333,2013.66666666667,2013.75,2013.83333333333,2013.91666666667,2014,2014.08333333333,2014.16666666667,2014.25,2014.33333333333,2014.41666666667,2014.5,2014.58333333333,2014.66666666667,2014.75,2014.83333333333,2014.91666666667,2015,2015.08333333333,2015.16666666667,2015.25,2015.33333333333,2015.41666666667,2015.5,2015.58333333333,2015.66666666667,2015.75,2015.83333333333,2015.91666666667,2016,2016.08333333333,2016.16666666667,2016.25,2016.33333333333,2016.41666666667,2016.5,2016.58333333333,2016.66666666667,2016.75,2016.83333333333,2016.91666666667,2017,2017.08333333333,2017.16666666667,2017.25,2017.33333333333,2017.41666666667,2017.5,2017.58333333333,2017.66666666667,2017.75,2017.83333333333,2017.91666666667,2018,2018.08333333333,2018.16666666667,2018.25,2018.33333333333,2018.41666666667,2018.5,2018.58333333333,2018.66666666667,2018.75,2018.83333333333,null],"y":[0,0.693147180559945,0,0.693147180559945,0,2.19722457733622,0,0,0.693147180559945,1.38629436111989,0.693147180559945,0.693147180559945,1.6094379124341,0.693147180559945,0,0.693147180559945,0,0.693147180559945,1.09861228866811,0,2.07944154167984,1.38629436111989,0,0.693147180559945,1.09861228866811,0.693147180559945,1.09861228866811,0.693147180559945,0,0,0,1.09861228866811,1.6094379124341,1.38629436111989,1.79175946922805,0,0.693147180559945,1.09861228866811,1.38629436111989,1.94591014905531,1.38629436111989,0.693147180559945,1.79175946922805,1.38629436111989,0,0.693147180559945,1.79175946922805,1.79175946922805,1.79175946922805,1.38629436111989,0.693147180559945,2.07944154167984,1.79175946922805,1.38629436111989,1.38629436111989,0.693147180559945,1.09861228866811,1.38629436111989,1.79175946922805,2.70805020110221,2.39789527279837,2.484906649788,2.19722457733622,1.79175946922805,1.38629436111989,2.30258509299405,2.07944154167984,1.6094379124341,2.19722457733622,2.19722457733622,1.6094379124341,1.79175946922805,1.6094379124341,1.79175946922805,1.94591014905531,1.09861228866811,1.6094379124341,1.38629436111989,1.38629436111989,1.94591014905531,1.6094379124341,1.94591014905531,0.693147180559945,2.39789527279837,1.79175946922805,1.6094379124341,3.17805383034795,2.30258509299405,null],"text":["date: 2011.583<br />value: 0.0000000<br />colour: Actual Train Values","date: 2011.667<br />value: 0.6931472<br />colour: Actual Train Values","date: 2011.750<br />value: 0.0000000<br />colour: Actual Train Values","date: 2011.833<br />value: 0.6931472<br />colour: Actual Train Values","date: 2011.917<br />value: 0.0000000<br />colour: Actual Train Values","date: 2012.000<br />value: 2.1972246<br />colour: Actual Train Values","date: 2012.083<br />value: 0.0000000<br />colour: Actual Train Values","date: 2012.167<br />value: 0.0000000<br />colour: Actual Train Values","date: 2012.250<br />value: 0.6931472<br />colour: Actual Train Values","date: 2012.333<br />value: 1.3862944<br />colour: Actual Train Values","date: 2012.417<br />value: 0.6931472<br />colour: Actual Train Values","date: 2012.500<br />value: 0.6931472<br />colour: Actual Train Values","date: 2012.583<br />value: 1.6094379<br />colour: Actual Train Values","date: 2012.667<br />value: 0.6931472<br />colour: Actual Train Values","date: 2012.750<br />value: 0.0000000<br />colour: Actual Train Values","date: 2012.833<br />value: 0.6931472<br />colour: Actual Train Values","date: 2012.917<br />value: 0.0000000<br />colour: Actual Train Values","date: 2013.000<br />value: 0.6931472<br />colour: Actual Train Values","date: 2013.083<br />value: 1.0986123<br />colour: Actual Train Values","date: 2013.167<br />value: 0.0000000<br />colour: Actual Train Values","date: 2013.250<br />value: 2.0794415<br />colour: Actual Train Values","date: 2013.333<br />value: 1.3862944<br />colour: Actual Train Values","date: 2013.417<br />value: 0.0000000<br />colour: Actual Train Values","date: 2013.500<br />value: 0.6931472<br />colour: Actual Train Values","date: 2013.583<br />value: 1.0986123<br />colour: Actual Train Values","date: 2013.667<br />value: 0.6931472<br />colour: Actual Train Values","date: 2013.750<br />value: 1.0986123<br />colour: Actual Train Values","date: 2013.833<br />value: 0.6931472<br />colour: Actual Train Values","date: 2013.917<br />value: 0.0000000<br />colour: Actual Train Values","date: 2014.000<br />value: 0.0000000<br />colour: Actual Train Values","date: 2014.083<br />value: 0.0000000<br />colour: Actual Train Values","date: 2014.167<br />value: 1.0986123<br />colour: Actual Train Values","date: 2014.250<br />value: 1.6094379<br />colour: Actual Train Values","date: 2014.333<br />value: 1.3862944<br />colour: Actual Train Values","date: 2014.417<br />value: 1.7917595<br />colour: Actual Train Values","date: 2014.500<br />value: 0.0000000<br />colour: Actual Train Values","date: 2014.583<br />value: 0.6931472<br />colour: Actual Train Values","date: 2014.667<br />value: 1.0986123<br />colour: Actual Train Values","date: 2014.750<br />value: 1.3862944<br />colour: Actual Train Values","date: 2014.833<br />value: 1.9459101<br />colour: Actual Train Values","date: 2014.917<br />value: 1.3862944<br />colour: Actual Train Values","date: 2015.000<br />value: 0.6931472<br />colour: Actual Train Values","date: 2015.083<br />value: 1.7917595<br />colour: Actual Train Values","date: 2015.167<br />value: 1.3862944<br />colour: Actual Train Values","date: 2015.250<br />value: 0.0000000<br />colour: Actual Train Values","date: 2015.333<br />value: 0.6931472<br />colour: Actual Train Values","date: 2015.417<br />value: 1.7917595<br />colour: Actual Train Values","date: 2015.500<br />value: 1.7917595<br />colour: Actual Train Values","date: 2015.583<br />value: 1.7917595<br />colour: Actual Train Values","date: 2015.667<br />value: 1.3862944<br />colour: Actual Train Values","date: 2015.750<br />value: 0.6931472<br />colour: Actual Train Values","date: 2015.833<br />value: 2.0794415<br />colour: Actual Train Values","date: 2015.917<br />value: 1.7917595<br />colour: Actual Train Values","date: 2016.000<br />value: 1.3862944<br />colour: Actual Train Values","date: 2016.083<br />value: 1.3862944<br />colour: Actual Train Values","date: 2016.167<br />value: 0.6931472<br />colour: Actual Train Values","date: 2016.250<br />value: 1.0986123<br />colour: Actual Train Values","date: 2016.333<br />value: 1.3862944<br />colour: Actual Train Values","date: 2016.417<br />value: 1.7917595<br />colour: Actual Train Values","date: 2016.500<br />value: 2.7080502<br />colour: Actual Train Values","date: 2016.583<br />value: 2.3978953<br />colour: Actual Train Values","date: 2016.667<br />value: 2.4849066<br />colour: Actual Train Values","date: 2016.750<br />value: 2.1972246<br />colour: Actual Train Values","date: 2016.833<br />value: 1.7917595<br />colour: Actual Train Values","date: 2016.917<br />value: 1.3862944<br />colour: Actual Train Values","date: 2017.000<br />value: 2.3025851<br />colour: Actual Train Values","date: 2017.083<br />value: 2.0794415<br />colour: Actual Train Values","date: 2017.167<br />value: 1.6094379<br />colour: Actual Train Values","date: 2017.250<br />value: 2.1972246<br />colour: Actual Train Values","date: 2017.333<br />value: 2.1972246<br />colour: Actual Train Values","date: 2017.417<br />value: 1.6094379<br />colour: Actual Train Values","date: 2017.500<br />value: 1.7917595<br />colour: Actual Train Values","date: 2017.583<br />value: 1.6094379<br />colour: Actual Train Values","date: 2017.667<br />value: 1.7917595<br />colour: Actual Train Values","date: 2017.750<br />value: 1.9459101<br />colour: Actual Train Values","date: 2017.833<br />value: 1.0986123<br />colour: Actual Train Values","date: 2017.917<br />value: 1.6094379<br />colour: Actual Train Values","date: 2018.000<br />value: 1.3862944<br />colour: Actual Train Values","date: 2018.083<br />value: 1.3862944<br />colour: Actual Train Values","date: 2018.167<br />value: 1.9459101<br />colour: Actual Train Values","date: 2018.250<br />value: 1.6094379<br />colour: Actual Train Values","date: 2018.333<br />value: 1.9459101<br />colour: Actual Train Values","date: 2018.417<br />value: 0.6931472<br />colour: Actual Train Values","date: 2018.500<br />value: 2.3978953<br />colour: Actual Train Values","date: 2018.583<br />value: 1.7917595<br />colour: Actual Train Values","date: 2018.667<br />value: 1.6094379<br />colour: Actual Train Values","date: 2018.750<br />value: 3.1780538<br />colour: Actual Train Values","date: 2018.833<br />value: 2.3025851<br />colour: Actual Train Values","date:       NA<br />value:        NA<br />colour: Actual Train Values"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(127,127,127,0.6)","dash":"solid"},"hoveron":"points","name":"Actual Train Values","legendgroup":"Actual Train Values","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2011.58333333333,2011.66666666667,2011.75,2011.83333333333,2011.91666666667,2012,2012.08333333333,2012.16666666667,2012.25,2012.33333333333,2012.41666666667,2012.5,2012.58333333333,2012.66666666667,2012.75,2012.83333333333,2012.91666666667,2013,2013.08333333333,2013.16666666667,2013.25,2013.33333333333,2013.41666666667,2013.5,2013.58333333333,2013.66666666667,2013.75,2013.83333333333,2013.91666666667,2014,2014.08333333333,2014.16666666667,2014.25,2014.33333333333,2014.41666666667,2014.5,2014.58333333333,2014.66666666667,2014.75,2014.83333333333,2014.91666666667,2015,2015.08333333333,2015.16666666667,2015.25,2015.33333333333,2015.41666666667,2015.5,2015.58333333333,2015.66666666667,2015.75,2015.83333333333,2015.91666666667,2016,2016.08333333333,2016.16666666667,2016.25,2016.33333333333,2016.41666666667,2016.5,2016.58333333333,2016.66666666667,2016.75,2016.83333333333,2016.91666666667,2017,2017.08333333333,2017.16666666667,2017.25,2017.33333333333,2017.41666666667,2017.5,2017.58333333333,2017.66666666667,2017.75,2017.83333333333,2017.91666666667,2018,2018.08333333333,2018.16666666667,2018.25,2018.33333333333,2018.41666666667,2018.5,2018.58333333333,2018.66666666667,2018.75,2018.83333333333,null],"y":[0,0.693147180559945,0,0.693147180559945,0,2.19722457733622,0,0,0.693147180559945,1.38629436111989,0.693147180559945,0.693147180559945,1.6094379124341,0.693147180559945,0,0.693147180559945,0,0.693147180559945,1.09861228866811,0,2.07944154167984,1.38629436111989,0,0.693147180559945,1.09861228866811,0.693147180559945,1.09861228866811,0.693147180559945,0,0,0,1.09861228866811,1.6094379124341,1.38629436111989,1.79175946922805,0,0.693147180559945,1.09861228866811,1.38629436111989,1.94591014905531,1.38629436111989,0.693147180559945,1.79175946922805,1.38629436111989,0,0.693147180559945,1.79175946922805,1.79175946922805,1.79175946922805,1.38629436111989,0.693147180559945,2.07944154167984,1.79175946922805,1.38629436111989,1.38629436111989,0.693147180559945,1.09861228866811,1.38629436111989,1.79175946922805,2.70805020110221,2.39789527279837,2.484906649788,2.19722457733622,1.79175946922805,1.38629436111989,2.30258509299405,2.07944154167984,1.6094379124341,2.19722457733622,2.19722457733622,1.6094379124341,1.79175946922805,1.6094379124341,1.79175946922805,1.94591014905531,1.09861228866811,1.6094379124341,1.38629436111989,1.38629436111989,1.94591014905531,1.6094379124341,1.94591014905531,0.693147180559945,2.39789527279837,1.79175946922805,1.6094379124341,3.17805383034795,2.30258509299405,null],"text":["date: 2011.583<br />value: 0.0000000","date: 2011.667<br />value: 0.6931472","date: 2011.750<br />value: 0.0000000","date: 2011.833<br />value: 0.6931472","date: 2011.917<br />value: 0.0000000","date: 2012.000<br />value: 2.1972246","date: 2012.083<br />value: 0.0000000","date: 2012.167<br />value: 0.0000000","date: 2012.250<br />value: 0.6931472","date: 2012.333<br />value: 1.3862944","date: 2012.417<br />value: 0.6931472","date: 2012.500<br />value: 0.6931472","date: 2012.583<br />value: 1.6094379","date: 2012.667<br />value: 0.6931472","date: 2012.750<br />value: 0.0000000","date: 2012.833<br />value: 0.6931472","date: 2012.917<br />value: 0.0000000","date: 2013.000<br />value: 0.6931472","date: 2013.083<br />value: 1.0986123","date: 2013.167<br />value: 0.0000000","date: 2013.250<br />value: 2.0794415","date: 2013.333<br />value: 1.3862944","date: 2013.417<br />value: 0.0000000","date: 2013.500<br />value: 0.6931472","date: 2013.583<br />value: 1.0986123","date: 2013.667<br />value: 0.6931472","date: 2013.750<br />value: 1.0986123","date: 2013.833<br />value: 0.6931472","date: 2013.917<br />value: 0.0000000","date: 2014.000<br />value: 0.0000000","date: 2014.083<br />value: 0.0000000","date: 2014.167<br />value: 1.0986123","date: 2014.250<br />value: 1.6094379","date: 2014.333<br />value: 1.3862944","date: 2014.417<br />value: 1.7917595","date: 2014.500<br />value: 0.0000000","date: 2014.583<br />value: 0.6931472","date: 2014.667<br />value: 1.0986123","date: 2014.750<br />value: 1.3862944","date: 2014.833<br />value: 1.9459101","date: 2014.917<br />value: 1.3862944","date: 2015.000<br />value: 0.6931472","date: 2015.083<br />value: 1.7917595","date: 2015.167<br />value: 1.3862944","date: 2015.250<br />value: 0.0000000","date: 2015.333<br />value: 0.6931472","date: 2015.417<br />value: 1.7917595","date: 2015.500<br />value: 1.7917595","date: 2015.583<br />value: 1.7917595","date: 2015.667<br />value: 1.3862944","date: 2015.750<br />value: 0.6931472","date: 2015.833<br />value: 2.0794415","date: 2015.917<br />value: 1.7917595","date: 2016.000<br />value: 1.3862944","date: 2016.083<br />value: 1.3862944","date: 2016.167<br />value: 0.6931472","date: 2016.250<br />value: 1.0986123","date: 2016.333<br />value: 1.3862944","date: 2016.417<br />value: 1.7917595","date: 2016.500<br />value: 2.7080502","date: 2016.583<br />value: 2.3978953","date: 2016.667<br />value: 2.4849066","date: 2016.750<br />value: 2.1972246","date: 2016.833<br />value: 1.7917595","date: 2016.917<br />value: 1.3862944","date: 2017.000<br />value: 2.3025851","date: 2017.083<br />value: 2.0794415","date: 2017.167<br />value: 1.6094379","date: 2017.250<br />value: 2.1972246","date: 2017.333<br />value: 2.1972246","date: 2017.417<br />value: 1.6094379","date: 2017.500<br />value: 1.7917595","date: 2017.583<br />value: 1.6094379","date: 2017.667<br />value: 1.7917595","date: 2017.750<br />value: 1.9459101","date: 2017.833<br />value: 1.0986123","date: 2017.917<br />value: 1.6094379","date: 2018.000<br />value: 1.3862944","date: 2018.083<br />value: 1.3862944","date: 2018.167<br />value: 1.9459101","date: 2018.250<br />value: 1.6094379","date: 2018.333<br />value: 1.9459101","date: 2018.417<br />value: 0.6931472","date: 2018.500<br />value: 2.3978953","date: 2018.583<br />value: 1.7917595","date: 2018.667<br />value: 1.6094379","date: 2018.750<br />value: 3.1780538","date: 2018.833<br />value: 2.3025851","date:       NA<br />value:        NA"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","opacity":0.4,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2018.91666666667,2019,2019.08333333333,2019.16666666667,2019.25,2019.33333333333,2019.41666666667,2019.5,2019.58333333333,2019.66666666667,2019.75,2019.83333333333,2019.91666666667,2020,2020.08333333333,2020.16666666667,2020.25,2020.33333333333,2020.41666666667,2020.5,2020.58333333333,2020.66666666667,2020.75,2020.83333333333,2020.91666666667],"y":[1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963,1.9778211122963],"text":["date: 2018.917<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.000<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.083<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.167<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.250<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.333<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.417<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.500<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.583<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.667<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.750<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.833<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2019.917<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.000<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.083<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.167<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.250<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.333<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.417<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.500<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.583<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.667<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.750<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.833<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast","date: 2020.917<br />value: 1.977821<br />colour: ARIMA(0,1,1) Forecast"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,255,1)","dash":"solid"},"hoveron":"points","name":"ARIMA(0,1,1) Forecast","legendgroup":"ARIMA(0,1,1) Forecast","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2018.91666666667,2019,2019.08333333333,2019.16666666667,2019.25,2019.33333333333,2019.41666666667,2019.5,2019.58333333333,2019.66666666667,2019.75,2019.83333333333,2019.91666666667,2020,2020.08333333333,2020.16666666667,2020.25,2020.33333333333,2020.41666666667,2020.5,2020.58333333333,2020.66666666667,2020.75,2020.83333333333,2020.91666666667],"y":[1.96185854059495,1.95196869136936,1.9446059758522,1.94610137408539,1.95457971865533,1.96212861249843,1.96215249765788,1.95510353014507,1.94763982994639,1.9463663895863,1.95201641469742,1.95917428356553,1.96143583984688,1.9571155288983,1.95043540852534,1.94743209732025,1.95052166153252,1.95659764081797,1.96011653540487,1.95813740195251,1.95275049968133,1.94891843513527,1.94992122296028,1.95457091193706,1.95853967767191],"text":["date: 2018.917<br />value: 1.961859<br />colour: ARIMA(2,1,3) Forecast","date: 2019.000<br />value: 1.951969<br />colour: ARIMA(2,1,3) Forecast","date: 2019.083<br />value: 1.944606<br />colour: ARIMA(2,1,3) Forecast","date: 2019.167<br />value: 1.946101<br />colour: ARIMA(2,1,3) Forecast","date: 2019.250<br />value: 1.954580<br />colour: ARIMA(2,1,3) Forecast","date: 2019.333<br />value: 1.962129<br />colour: ARIMA(2,1,3) Forecast","date: 2019.417<br />value: 1.962152<br />colour: ARIMA(2,1,3) Forecast","date: 2019.500<br />value: 1.955104<br />colour: ARIMA(2,1,3) Forecast","date: 2019.583<br />value: 1.947640<br />colour: ARIMA(2,1,3) Forecast","date: 2019.667<br />value: 1.946366<br />colour: ARIMA(2,1,3) Forecast","date: 2019.750<br />value: 1.952016<br />colour: ARIMA(2,1,3) Forecast","date: 2019.833<br />value: 1.959174<br />colour: ARIMA(2,1,3) Forecast","date: 2019.917<br />value: 1.961436<br />colour: ARIMA(2,1,3) Forecast","date: 2020.000<br />value: 1.957116<br />colour: ARIMA(2,1,3) Forecast","date: 2020.083<br />value: 1.950435<br />colour: ARIMA(2,1,3) Forecast","date: 2020.167<br />value: 1.947432<br />colour: ARIMA(2,1,3) Forecast","date: 2020.250<br />value: 1.950522<br />colour: ARIMA(2,1,3) Forecast","date: 2020.333<br />value: 1.956598<br />colour: ARIMA(2,1,3) Forecast","date: 2020.417<br />value: 1.960117<br />colour: ARIMA(2,1,3) Forecast","date: 2020.500<br />value: 1.958137<br />colour: ARIMA(2,1,3) Forecast","date: 2020.583<br />value: 1.952750<br />colour: ARIMA(2,1,3) Forecast","date: 2020.667<br />value: 1.948918<br />colour: ARIMA(2,1,3) Forecast","date: 2020.750<br />value: 1.949921<br />colour: ARIMA(2,1,3) Forecast","date: 2020.833<br />value: 1.954571<br />colour: ARIMA(2,1,3) Forecast","date: 2020.917<br />value: 1.958540<br />colour: ARIMA(2,1,3) Forecast"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,255,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA(2,1,3) Forecast","legendgroup":"ARIMA(2,1,3) Forecast","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2018.91666666667,2019,2019.08333333333,2019.16666666667,2019.25,2019.33333333333,2019.41666666667,2019.5,2019.58333333333,2019.66666666667,2019.75,2019.83333333333,2019.91666666667,2020,2020.08333333333,2020.16666666667,2020.25,2020.33333333333,2020.41666666667,2020.5,2020.58333333333,2020.66666666667,2020.75,2020.83333333333,2020.91666666667],"y":[0.693147180559945,1.09861228866811,0,2.77258872223978,2.484906649788,2.07944154167984,1.79175946922805,1.38629436111989,1.94591014905531,0,0.693147180559945,1.09861228866811,2.19722457733622,1.6094379124341,2.07944154167984,1.79175946922805,1.6094379124341,2.83321334405622,2.63905732961526,2.07944154167984,2.30258509299405,2.39789527279837,1.94591014905531,1.94591014905531,1.6094379124341],"text":["date: 2018.917<br />log(value): 0.6931472<br />colour: Actual Forecast Values","date: 2019.000<br />log(value): 1.0986123<br />colour: Actual Forecast Values","date: 2019.083<br />log(value): 0.0000000<br />colour: Actual Forecast Values","date: 2019.167<br />log(value): 2.7725887<br />colour: Actual Forecast Values","date: 2019.250<br />log(value): 2.4849066<br />colour: Actual Forecast Values","date: 2019.333<br />log(value): 2.0794415<br />colour: Actual Forecast Values","date: 2019.417<br />log(value): 1.7917595<br />colour: Actual Forecast Values","date: 2019.500<br />log(value): 1.3862944<br />colour: Actual Forecast Values","date: 2019.583<br />log(value): 1.9459101<br />colour: Actual Forecast Values","date: 2019.667<br />log(value): 0.0000000<br />colour: Actual Forecast Values","date: 2019.750<br />log(value): 0.6931472<br />colour: Actual Forecast Values","date: 2019.833<br />log(value): 1.0986123<br />colour: Actual Forecast Values","date: 2019.917<br />log(value): 2.1972246<br />colour: Actual Forecast Values","date: 2020.000<br />log(value): 1.6094379<br />colour: Actual Forecast Values","date: 2020.083<br />log(value): 2.0794415<br />colour: Actual Forecast Values","date: 2020.167<br />log(value): 1.7917595<br />colour: Actual Forecast Values","date: 2020.250<br />log(value): 1.6094379<br />colour: Actual Forecast Values","date: 2020.333<br />log(value): 2.8332133<br />colour: Actual Forecast Values","date: 2020.417<br />log(value): 2.6390573<br />colour: Actual Forecast Values","date: 2020.500<br />log(value): 2.0794415<br />colour: Actual Forecast Values","date: 2020.583<br />log(value): 2.3025851<br />colour: Actual Forecast Values","date: 2020.667<br />log(value): 2.3978953<br />colour: Actual Forecast Values","date: 2020.750<br />log(value): 1.9459101<br />colour: Actual Forecast Values","date: 2020.833<br />log(value): 1.9459101<br />colour: Actual Forecast Values","date: 2020.917<br />log(value): 1.6094379<br />colour: Actual Forecast Values"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,165,0,1)","dash":"solid"},"hoveron":"points","name":"Actual Forecast Values","legendgroup":"Actual Forecast Values","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":31.4155251141553},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Forecasting ARIMA(0,1,1) and ARIMA(2,1,3)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2011.11666666667,2021.38333333333],"tickmode":"array","ticktext":["2012","2014","2016","2018","2020"],"tickvals":[2012,2014,2016,2018,2020],"categoryorder":"array","categoryarray":["2012","2014","2016","2018","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Date","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.158902691517397,3.33695652186534],"tickmode":"array","ticktext":["0","1","2","3"],"tickvals":[0,1,2,3],"categoryorder":"array","categoryarray":["0","1","2","3"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Log of Number of Monthly Attacks","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"Forecast","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"76392c0d6738":{"x":{},"y":{},"colour":{},"type":"scatter"},"763923f3a420":{"x":{},"y":{}},"7639509c4350":{"x":{},"y":{},"colour":{}},"763943076288":{"x":{},"y":{},"colour":{}},"763919d5f119":{"x":{},"y":{},"colour":{}}},"cur_data":"76392c0d6738","visdat":{"76392c0d6738":["function (y) ","x"],"763923f3a420":["function (y) ","x"],"7639509c4350":["function (y) ","x"],"763943076288":["function (y) ","x"],"763919d5f119":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>From the above graph, we can note that the forecasted number of attacks remains constant at around 1 for both models on the test set (October 2010 to December 2020). This performance is not what was expected and, hence, it is possible that the models are not able to capture the underlying patterns in the data. This can be due to a variety of reasons, such as insufficient data and the models not being complex enough to capture the variation in the data. It is, however, pragmatic to check whether the <code>sarima.for()</code> function’s predictions may forecast differently. Let us find out below.</p>
</section>
<section id="forecasting-arima011-using-sarima.for" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-arima011-using-sarima.for">Forecasting ARIMA(0,1,1) using sarima.for()</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>log_monthly_attacks <span class="ot">&lt;-</span> <span class="fu">ts</span>(lx, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1970</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>) <span class="co"># Objects of class &lt;numeric&gt; are not supported by autoplot.</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima.for</span>(<span class="fu">ts</span>(train_df<span class="sc">$</span>value, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1970</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>), <span class="dv">24</span>, <span class="at">p =</span> <span class="dv">0</span>, <span class="at">d =</span> <span class="dv">1</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">"Forecasting ARIMA(0,1,1) using sarima.for()"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$pred
          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
2018                                                                        
2019 1.954087 1.951260 1.948432 1.945605 1.942778 1.939950 1.937123 1.934296
2020 1.920159 1.917332 1.914505 1.911678 1.908850 1.906023 1.903196 1.900368
          Sep      Oct      Nov      Dec
2018                            1.956914
2019 1.931469 1.928641 1.925814 1.922987
2020 1.897541 1.894714 1.891886         

$se
           Jan       Feb       Mar       Apr       May       Jun       Jul
2018                                                                      
2019 0.6385446 0.6459664 0.6533040 0.6605600 0.6677372 0.6748381 0.6818650
2020 0.7225930 0.7291599 0.7356681 0.7421193 0.7485148 0.7548562 0.7611448
           Aug       Sep       Oct       Nov       Dec
2018                                         0.6310354
2019 0.6888203 0.6957060 0.7025242 0.7092769 0.7159659
2020 0.7673818 0.7735685 0.7797062 0.7857959          </code></pre>
</div>
</div>
<p>Like the previous forecast, we can note that <code>sarima.for()</code> too does not accurately capture the inherent randomness and/or seasonality in the series and, hence, it outputs a highly linear, downward trending forecast. As per its 95% confidence bound, the number of attacks will fluctuate anywhere between 3 to 12 attacks every month from 2019 to end of 2020 (keep in mind that the plot is log of monthly attacks).</p>
</section>
<section id="comparing-arima011-with-benchmarks" class="level3">
<h3 class="anchored" data-anchor-id="comparing-arima011-with-benchmarks">Comparing ARIMA(0,1,1) with Benchmarks</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(log_monthly_attacks) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(<span class="fu">Arima</span>(log_monthly_attacks, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="dv">24</span>), </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA(0,1,1)"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log of Monthly Attacks"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Forecasting ARIMA(0,1,1) and Benchmarks"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ARIMA(0,1,1) model metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ARIMA(0,1,1) model metrics: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(log_monthly_attacks, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: log_monthly_attacks 
ARIMA(0,1,1) 

Coefficients:
          ma1
      -0.8436
s.e.   0.0240

sigma^2 = 0.3992:  log likelihood = -562.57
AIC=1129.15   AICc=1129.17   BIC=1137.89

Training set error measures:
                     ME      RMSE       MAE  MPE MAPE      MASE       ACF1
Training set -0.0182295 0.6307598 0.4949849 -Inf  Inf 0.7143174 0.01012716</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Mean metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Mean metrics: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">meanf</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>) </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(f1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Mean
Q* = 2327.6, df = 23, p-value &lt; 2.2e-16

Model df: 1.   Total lags used: 24</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       ME      RMSE       MAE  MPE MAPE      MASE     ACF1
Training set 1.113627e-15 0.8556503 0.6744582 -Inf  Inf 0.9733169 0.534751</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Snaive metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Snaive metrics: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">snaive</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>) </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(f2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Seasonal naive method
Q* = 173.01, df = 24, p-value &lt; 2.2e-16

Model df: 0.   Total lags used: 24</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      ME      RMSE       MAE  MPE MAPE MASE      ACF1
Training set -0.03643642 0.8807625 0.6929481 -Inf  Inf    1 0.1556335</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Random Walk metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Random Walk metrics: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">rwf</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>) </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(f3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from Random walk
Q* = 178.32, df = 24, p-value &lt; 2.2e-16

Model df: 0.   Total lags used: 24</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       ME      RMSE       MAE  MPE MAPE      MASE       ACF1
Training set -0.001694969 0.8215562 0.6276053 -Inf  Inf 0.9057032 -0.5152558</code></pre>
</div>
</div>
<p>From the above plot, only the Snaive benchmark method’s forecasts seem more plausible compared to that of the ARIMA(0,1,1) model. The forecasts produced from the Snaive benchmark have the greatest amount of fluctuations or seasonality in a higher range of number of monthly attacks. However, the metrics paint a different story. The ARIMA(0,1,1) model’s training error measures are better than those of all the benchmarks. There are several reasons for this phenomenon:</p>
<p>Model Assumptions: The ARIMA model assumes that the data is stationary, which means that the mean and variance of the data do not change over time. If the data violates this assumption, the ARIMA model may not perform well. In contrast, the Snaive model does not assume stationarity, which may make it more robust to non-stationary data.</p>
<p>Parameter Estimation: The ARIMA model has three parameters (p, d, q) that need to be estimated, whereas the Snaive model has only one parameter (the seasonality). It is possible that the parameter estimation process for the ARIMA model was not optimal, leading to suboptimal forecast performance.</p>
<p>Forecast Horizon: The Snaive model may perform better than the ARIMA model for shorter forecast horizons, while the ARIMA model may perform better for longer forecast horizons. This is because the Snaive model assumes that the future values of the time series will be the same as the past values at the same time of year, which may be a reasonable assumption for short forecast horizons, but not for longer ones.</p>
</section>
</section>
<section id="global-terrorism-database-sarima-modeling" class="level2">
<h2 class="anchored" data-anchor-id="global-terrorism-database-sarima-modeling">Global Terrorism Database SARIMA Modeling</h2>
<section id="visualizing-seasonal-components-of-monthly-attacks" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-seasonal-components-of-monthly-attacks">Visualizing Seasonal Components of Monthly Attacks</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Seasonal Component</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>attacks.s<span class="ot">=</span><span class="fu">decompose</span>(monthly_attacks_ts)<span class="sc">$</span>seasonal</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(attacks.s, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">'Seasonal Component of Number of Monthly Terrorist Attacks in the US Over Time'</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">type=</span><span class="st">'c'</span>) </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>Quarters <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>) </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(attacks.s, <span class="at">pch=</span>Quarters, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">font=</span><span class="dv">4</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>); <span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">gray</span>(.<span class="dv">7</span>))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>); <span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/sznlcomp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above seasonal component graph of the number of monthly terrorist attacks, we notice there does exist some level of seasonality in the original series. The seasonal component graph illustrates the degree of seasonal variation in the number of terrorist attacks. The magnitude of the seasonal variation is shown on the y-axis of the graph, and it indicates how much the number of terrorist attacks deviates from the average value for each season. The graph shows a repeating pattern in the number of terrorist attacks over time, with clear peaks in the first and second quarters and troughs in the third quarter. This pattern implies that the number of terrorist attacks in the US <em>might</em> be influenced by the season of the year.</p>
</section>
<section id="visualizing-seasonally-differenced-monthly-attacks" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-seasonally-differenced-monthly-attacks">Visualizing Seasonally Differenced Monthly Attacks</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seasonal differenced</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>attacks.diff<span class="ot">=</span><span class="fu">diff</span>(monthly_attacks_ts,<span class="dv">12</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(attacks.diff, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">'Number of Monthly Terrorist Attacks (S. differenced)'</span>,<span class="at">type=</span><span class="st">'c'</span>) <span class="co">#with type='c' I get dashed lines</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>Quarters <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>) </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(attacks.diff, <span class="at">pch=</span>Quarters, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">font=</span><span class="dv">4</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>); <span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">gray</span>(.<span class="dv">7</span>))</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>); <span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/sznldiff-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="acf-and-pacf-plots-of-seasonally-differenced-monthly-attacks" class="level3">
<h3 class="anchored" data-anchor-id="acf-and-pacf-plots-of-seasonally-differenced-monthly-attacks">ACF and PACF Plots of Seasonally Differenced Monthly Attacks</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>monthly_attacks_ts <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="at">lag=</span><span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtsdisplay</span>(<span class="at">main=</span><span class="st">"ACF and PACF Plots of First Seasonal Differenced Monthly Attacks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/pacfsznldiff-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After first ordinary differencing the original series <span class="citation" data-cites="ACF">(<a href="#ref-ACF" role="doc-biblioref"><strong>ACF?</strong></a>)</span>, we saw a lot of seasonal correlation left, suggesting that first order differencing did not help in transforming the raw data into a stationary series. This differenced series cannot be used for building a robust SARIMA model. Therefore, a seasonal differencing on the original monthly attacks was performed above and we can still notice some correlation left, but lesser compared to when the raw series was differenced with first order. Therefore, it could be that D=1 and d=0. Let’s keep this as one option and let’s proceed with performing both seasonal differencing and first-order differencing the raw monthly attacks series.</p>
</section>
<section id="acf-and-pacf-plots-of-seasonally-and-first-order-differenced-monthly-attacks" class="level3">
<h3 class="anchored" data-anchor-id="acf-and-pacf-plots-of-seasonally-and-first-order-differenced-monthly-attacks">ACF and PACF Plots of Seasonally and First Order Differenced Monthly Attacks</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>monthly_attacks_ts <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="at">lag=</span><span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtsdisplay</span>(<span class="at">main=</span><span class="st">"ACF and PACF Plots of Seasonally and First Order Differenced Monthly Attacks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/pacfsznlfodiff-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After both seasonal differencing and ordinary differencing together the raw data, the ACF and PACF plots seem to portray the least correlation than the individual differencing methods. Next, we shall difference and select the relevant p,d,q,P,D,Q values from the original monthly attacks series for our SARIMA model.</p>
<p>From the seasonal differencing and ordinary differencing (together) ACF and PACF plots, the following combinations for p,d,q,P,D,Q are:</p>
<p>q values obtained from ACF = 0,1,2,3,4 Q values obtained from ACF = 1 p values obtained from PACF = 0,1,2,3,4 P values obtained from PACF = 1,2 d (Difference) = 1 D (Seasonal Difference) = 1</p>
</section>
<section id="fitting-arimapdqpdq" class="level3">
<h3 class="anchored" data-anchor-id="fitting-arimapdqpdq">Fitting ARIMA(p,d,q)(P,D,Q)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">29</span>),<span class="at">nrow=</span><span class="dv">29</span>)</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>) <span class="co"># parsimonious principle</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>))</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,2,3,4; Q=1 and PACF plot: p=0,1,2,3,4; P=1,2; D=1 and d=1</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">5</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">5</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">3</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">2</span>,<span class="at">data=</span>monthly_attacks_ts)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">p</th>
<th style="text-align: right;">d</th>
<th style="text-align: right;">q</th>
<th style="text-align: right;">P</th>
<th style="text-align: right;">D</th>
<th style="text-align: right;">Q</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3952.891</td>
<td style="text-align: right;">3957.286</td>
<td style="text-align: right;">3952.897</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3670.269</td>
<td style="text-align: right;">3679.059</td>
<td style="text-align: right;">3670.289</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3827.797</td>
<td style="text-align: right;">3836.587</td>
<td style="text-align: right;">3827.817</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3670.336</td>
<td style="text-align: right;">3683.521</td>
<td style="text-align: right;">3670.376</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3765.751</td>
<td style="text-align: right;">3778.937</td>
<td style="text-align: right;">3765.791</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3671.380</td>
<td style="text-align: right;">3688.961</td>
<td style="text-align: right;">3671.447</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3705.459</td>
<td style="text-align: right;">3714.249</td>
<td style="text-align: right;">3705.479</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3495.035</td>
<td style="text-align: right;">3508.220</td>
<td style="text-align: right;">3495.075</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3596.169</td>
<td style="text-align: right;">3609.355</td>
<td style="text-align: right;">3596.209</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3492.557</td>
<td style="text-align: right;">3510.138</td>
<td style="text-align: right;">3492.625</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3570.165</td>
<td style="text-align: right;">3587.746</td>
<td style="text-align: right;">3570.232</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3701.229</td>
<td style="text-align: right;">3714.415</td>
<td style="text-align: right;">3701.269</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3493.391</td>
<td style="text-align: right;">3510.972</td>
<td style="text-align: right;">3493.458</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3595.313</td>
<td style="text-align: right;">3612.894</td>
<td style="text-align: right;">3595.381</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3699.991</td>
<td style="text-align: right;">3717.572</td>
<td style="text-align: right;">3700.058</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3818.806</td>
<td style="text-align: right;">3827.596</td>
<td style="text-align: right;">3818.826</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3553.235</td>
<td style="text-align: right;">3566.421</td>
<td style="text-align: right;">3553.276</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3693.837</td>
<td style="text-align: right;">3707.023</td>
<td style="text-align: right;">3693.878</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3552.817</td>
<td style="text-align: right;">3570.398</td>
<td style="text-align: right;">3552.884</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3651.212</td>
<td style="text-align: right;">3668.793</td>
<td style="text-align: right;">3651.279</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3700.223</td>
<td style="text-align: right;">3713.408</td>
<td style="text-align: right;">3700.263</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3492.442</td>
<td style="text-align: right;">3510.023</td>
<td style="text-align: right;">3492.510</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3594.929</td>
<td style="text-align: right;">3612.510</td>
<td style="text-align: right;">3594.996</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3704.894</td>
<td style="text-align: right;">3722.475</td>
<td style="text-align: right;">3704.961</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3777.584</td>
<td style="text-align: right;">3790.770</td>
<td style="text-align: right;">3777.624</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3521.643</td>
<td style="text-align: right;">3539.224</td>
<td style="text-align: right;">3521.710</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3654.644</td>
<td style="text-align: right;">3672.225</td>
<td style="text-align: right;">3654.712</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3700.164</td>
<td style="text-align: right;">3717.745</td>
<td style="text-align: right;">3700.232</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3772.136</td>
<td style="text-align: right;">3789.717</td>
<td style="text-align: right;">3772.204</td>
</tr>
</tbody>
</table>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of AIC: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 Best Model in terms of AIC: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC    AICc
22 1 1 1 0 1 1 3492.442 3510.023 3492.51</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of AICc: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 Best Model in terms of AICc: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   p d q P D Q      AIC      BIC    AICc
22 1 1 1 0 1 1 3492.442 3510.023 3492.51</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of BIC: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 Best Model in terms of BIC: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  p d q P D Q      AIC     BIC     AICc
8 0 1 1 0 1 1 3495.035 3508.22 3495.075</code></pre>
</div>
</div>
<p>The best model with the lowest BIC metric is the SARIMA(0,1,1,0,1,1) model. Although, according to both AIC and AICc metrics, the SARIMA(1,1,1,0,1,1) is better, we shall choose our model using the BIC metric because BIC is more stringent than AIC in penalizing the number of parameters used in the model, making it more effective in helping reduce overfitting. The equation of the SARIMA(0,1,1,0,1,1) model is given by:</p>
<p><span class="math inline">\(\begin{equation}(1-B)(1-B^1)y_t = \delta + (1+\phi_1B)(1-\theta_1B-\theta_2B^2)w_t\end{equation}\)</span>, where <span class="math inline">\((1-B)\)</span> and <span class="math inline">\((1-B^1)\)</span> are the differencing operators, which represent the first-order difference of the series. <span class="math inline">\(y_t\)</span> is the time series, <span class="math inline">\(\delta\)</span> is the drift term, <span class="math inline">\(\phi_1\)</span> and <span class="math inline">\(\theta_1\)</span>, <span class="math inline">\(\theta_2\)</span> are the parameters of the AR and MA parts, respectively, and <span class="math inline">\(w_t\)</span> is the Gaussian white noise process.</p>
<p>Note that <span class="math inline">\(B\)</span> is the backshift operator, which shifts the time series back by one period.</p>
</section>
<section id="model-diagnostics-of-arima011011" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics-of-arima011011">Model Diagnostics of ARIMA(0,1,1)(0,1,1)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(monthly_attacks_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Standardized Residuals: Essentially stating if the errors are white noise. The model does look stationary as it captures all the signals and essentially captures the raw white noise.</p>
<p>ACF Of Residuals: However, looking at the ACF of the Residuals gives us a definitive answer to whether the model is stationary. Because some spikes are not within the significance limits, the model is not being able to capture all the signal in the data. In fact, the <a href="#ARIMA-Diag">ARIMA(1,1,2) model’s diagnostics</a> are better than that of ARIMA(0,1,1)(0,1,1) above.</p>
<p>Q-Q Plot: The series weakly follows a normal distribution as the tails waver away significantly from the normal line.</p>
<p>p values of the Ljung-Box statistic: Ideally, we would like to fail to reject the null hypothesis. That is, we would like to see the p-value of the test be greater than 0.05 because this means the residuals for our time series model are independent, which is often an assumption we make when creating a model. Since all lag values greater than 5 have a p-value less than 0.05, residuals have remaining autocorrelations.</p>
</section>
<section id="forecast-for-the-next-3-years-using-arima011011" class="level3">
<h3 class="anchored" data-anchor-id="forecast-for-the-next-3-years-using-arima011011">Forecast for the next 3 years using ARIMA(0,1,1)(0,1,1)</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: monthly_attacks_ts 
ARIMA(0,1,1)(0,1,1)[12] 

Coefficients:
          ma1     sma1
      -0.6661  -0.9261
s.e.   0.0374   0.0322

sigma^2 = 19.11:  log likelihood = -1744.52
AIC=3495.03   AICc=3495.07   BIC=3508.22

Training set error measures:
                    ME     RMSE      MAE MPE MAPE      MASE       ACF1
Training set 0.4707554 4.317518 2.887572 NaN  Inf 0.7582246 0.07436485</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>() <span class="co">#next 3 years</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="comparing-arima011011-with-benchmarks" class="level3">
<h3 class="anchored" data-anchor-id="comparing-arima011011-with-benchmarks">Comparing ARIMA(0,1,1)(0,1,1) with benchmarks</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best model metrics: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(monthly_attacks_ts) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(monthly_attacks_ts, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(monthly_attacks_ts, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(monthly_attacks_ts, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(monthly_attacks_ts, <span class="at">h=</span><span class="dv">36</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit,<span class="dv">36</span>), </span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best model metrics: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: monthly_attacks_ts 
ARIMA(0,1,1)(0,1,1)[12] 

Coefficients:
          ma1     sma1
      -0.6661  -0.9261
s.e.   0.0374   0.0322

sigma^2 = 19.11:  log likelihood = -1744.52
AIC=3495.03   AICc=3495.07   BIC=3508.22

Training set error measures:
                    ME     RMSE      MAE MPE MAPE      MASE       ACF1
Training set 0.4707554 4.317518 2.887572 NaN  Inf 0.7582246 0.07436485</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Snaive metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Snaive metrics: </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">snaive</span>(monthly_attacks_ts, <span class="at">h=</span><span class="dv">36</span>) </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     ME     RMSE      MAE  MPE MAPE MASE      ACF1
Training set -0.6016667 6.093029 3.808333 -Inf  Inf    1 0.4168619</code></pre>
</div>
</div>
</section>
<section id="seasonal-cross-validation-of-arima011011-and-arima111011-using-1-step-ahead-forecasts" class="level3">
<h3 class="anchored" data-anchor-id="seasonal-cross-validation-of-arima011011-and-arima111011-using-1-step-ahead-forecasts">Seasonal Cross Validation of ARIMA(0,1,1)(0,1,1) and ARIMA(1,1,1)(0,1,1) using 1 step ahead forecasts</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">75</span> <span class="co"># minimum data length for fitting a model </span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(monthly_attacks_ts)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k # rest of the observations</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">133</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">h=</span>h)}</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(monthly_attacks_ts, farima1, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>MAE1 <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MAE for ARIMA(0,1,1)(0,1,1) is: "</span>, MAE1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>MAE for ARIMA(0,1,1)(0,1,1) is:  2.155092</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>RMSE1<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">mean</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="co">#one-step time series cross-validation</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RMSE for ARIMA(0,1,1)(0,1,1) is: "</span>, RMSE1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
RMSE for ARIMA(0,1,1)(0,1,1) is:  7.428068</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>farima2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">h=</span>h)}</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(monthly_attacks_ts, farima2, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>MAE2 <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">MAE for ARIMA(1,1,1)(0,1,1) is: "</span>, MAE2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
MAE for ARIMA(1,1,1)(0,1,1) is:  2.092574</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>RMSE2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">mean</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="co">#one-step time series cross-validation</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RMSE for ARIMA(1,1,1)(0,1,1) is: "</span>, RMSE2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
RMSE for ARIMA(1,1,1)(0,1,1) is:  7.410171</code></pre>
</div>
</div>
<p>Both MAE and RMSE metrics agree that ARIMA(1,1,1)(0,1,1) is the best model by a slight margin. However, the BIC metric does not agree with this result as it outputted ARIMA(0,1,1)(0,1,1) as the model with lowest BIC. AIC and AICc metrics, however, do agree with the MAE and RMSE metrics generated from Seasonal Cross Validation using 1 step ahead forecasts. Let’s see whether this is the case when forecasting 12 steps ahead.</p>
</section>
<section id="seasonal-cross-validation-of-arima011011-and-arima111011-using-12-steps-seasonal-period-ahead-forecasts" class="level3">
<h3 class="anchored" data-anchor-id="seasonal-cross-validation-of-arima011011-and-arima111011-using-12-steps-seasonal-period-ahead-forecasts">Seasonal Cross Validation of ARIMA(0,1,1)(0,1,1) and ARIMA(1,1,1)(0,1,1) using 12 steps (seasonal period) ahead forecasts</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">75</span> <span class="co"># minimum data length for fitting a model </span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(monthly_attacks_ts)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>n<span class="sc">-</span>k <span class="co"># rest of the observations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 537</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">133</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">h=</span>h)}</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(monthly_attacks_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>mse1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>farima2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">h=</span>h)}</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(monthly_attacks_ts, <span class="at">forecastfunction =</span> farima2, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>mse2 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE1 =</span> mse1, <span class="at">MSE2 =</span> mse2) <span class="sc">%&gt;%</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>MSE1,<span class="at">x=</span> h)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>MSE2,<span class="at">x=</span> h)) <span class="sc">+</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>MSE1,<span class="at">x=</span> h,<span class="at">colour=</span><span class="st">"MSE for ARIMA(0,1,1)(0,1,1)"</span>)) <span class="sc">+</span> </span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>MSE2,<span class="at">x=</span> h,<span class="at">colour=</span><span class="st">"MSE for ARIMA(1,1,1)(0,1,1)"</span>))<span class="sc">+</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ARMA-ARIMA-SARIMA_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot gives cross-validation statistics up to horizon 12. The procedure for seasonal cross validation using 12 steps ahead is very similar to seasonal cross validation using 1 step ahead. We need to change the “h” parameter to the desired the number of time horizons we want to forecast for. The <code>farima()</code> function manually written by us helps us call our desired SARIMA model with the number of horizons. Then, <code>farima()</code> function is called inside the <code>tsCV()</code> function, which helps us store the cross-validated errors for up to 12 steps ahead. Then, because we get forecasts for each time horizon, we need to take the mean of the squared column using <code>colMeans</code> to obtain MSE.</p>
<p>Although we observed that the MSE and RMSE of ARIMA(1,1,1)(0,1,1) when forecasting 1 step ahead was lower than that of ARIMA(0,1,1)(0,1,1), from the above plot it can be seen that the cross-validated MSEs get lower or better as the number of forecasting steps increases. Both models’ MSE performance follow a very similar pattern, with ARIMA(0,1,1)(0,1,1), picked by lowest BIC, having a lower MSE across all forecasting steps, except for step 1. Therefore, ARIMA(0,1,1)(0,1,1) is the better SARIMA model!</p>
</section>
</section>
<section id="section-code" class="level2">
<h2 class="anchored" data-anchor-id="section-code">Section Code</h2>
<p><strong>Code for this section can be found <a href="https://github.com/TegveerG/Time-Series-Project/blob/main/Time%20Series%20Analysis/ARMA-ARIMA-SARIMA.qmd">here</a></strong></p>


<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-GTD" class="csl-entry" role="doc-biblioentry">
<span>“Codebook Methodology Inclusion Criteria and Variables - UMD.”</span> n.d. <em>Global Terrorism Database</em>. University of Maryland. <a href="https://www.start.umd.edu/gtd/downloads/Codebook.pdf">https://www.start.umd.edu/gtd/downloads/Codebook.pdf</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb107" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "ARMA/ARIMA/SARIMA Models"</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> bibliography.bib</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>After completing the exploratory data analysis (EDA) phase, the next step is to begin building time series models. In order to do so, one must first choose an appropriate model type, such as an ARMA (AutoRegressive Moving Average) model or one of its variations, including ARIMA (AutoRegressive Integrated Moving Average) or SARIMA (Seasonal AutoRegressive Integrated Moving Average).</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>An ARIMA model is generally notated as ARIMA(p,d,q) where p is the order of the AR process, d is the degree of differencing and q is the order of the MA process. The general equation of the model is given as follows:</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>$\phi(B)(1-B)^d x_t = \delta + \theta(B) w_t$, </span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>where $B$ is the backshift operator, $w_t$ is the Gaussian white noise process, $\delta$ is the drift term and $\phi(B)$ and $\theta(B)$ correspond to the AR and MA parts respectively.</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>Lag plots, auto-correlation function (ACF) and partial auto-correlation function (PACF) plots, decomposing the time series, and differencing are all useful techniques that were employed during the EDA phase to help inform the choice of model type and parameters. With a solid understanding of the data and its characteristics, one can begin to develop and refine time series models that can be used for forecasting. </span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Global Terrorism Database ARIMA Modeling</span></span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,include=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flipbookr)</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(astsa) </span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fma)</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSstudio)</span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(padr)</span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb107-45"><a href="#cb107-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-46"><a href="#cb107-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load,include=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a>gtd <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="st">"../Data/gtd.xlsx"</span>)</span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a>sipri_gdp <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="st">"../Data/SIPRI_GDP.xlsx"</span>)</span>
<span id="cb107-50"><a href="#cb107-50" aria-hidden="true" tabindex="-1"></a>sipri_region <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="st">"../Data/SIPRI_Region.xlsx"</span>)</span>
<span id="cb107-51"><a href="#cb107-51" aria-hidden="true" tabindex="-1"></a>dhs <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xls</span>(<span class="st">"../Data/DHS_98_21.xls"</span>)</span>
<span id="cb107-52"><a href="#cb107-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-53"><a href="#cb107-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-54"><a href="#cb107-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r createdate,include=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-55"><a href="#cb107-55" aria-hidden="true" tabindex="-1"></a><span class="co"># if the exact day/month of the event is unknown, this is recorded as “0”</span></span>
<span id="cb107-56"><a href="#cb107-56" aria-hidden="true" tabindex="-1"></a>gtd<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">with</span>(gtd,<span class="fu">paste</span>(iyear,imonth,iday,<span class="at">sep=</span><span class="st">"-"</span>)),<span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb107-57"><a href="#cb107-57" aria-hidden="true" tabindex="-1"></a><span class="co"># results in 891 NAs total, 33 of which correspond to country_txt==USA</span></span>
<span id="cb107-58"><a href="#cb107-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-59"><a href="#cb107-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-60"><a href="#cb107-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filterUS,include=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-61"><a href="#cb107-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter country_txt==USA</span></span>
<span id="cb107-62"><a href="#cb107-62" aria-hidden="true" tabindex="-1"></a>gtd_USA <span class="ot">&lt;-</span> gtd <span class="sc">%&gt;%</span> </span>
<span id="cb107-63"><a href="#cb107-63" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(country_txt<span class="sc">==</span><span class="st">"United States"</span>)</span>
<span id="cb107-64"><a href="#cb107-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-65"><a href="#cb107-65" aria-hidden="true" tabindex="-1"></a><span class="co"># drop 33 observations from a total of 3121 observations (if taking for '70)</span></span>
<span id="cb107-66"><a href="#cb107-66" aria-hidden="true" tabindex="-1"></a>gtd_USA <span class="ot">&lt;-</span> gtd_USA[<span class="fu">complete.cases</span>(gtd_USA<span class="sc">$</span>Date),]</span>
<span id="cb107-67"><a href="#cb107-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-68"><a href="#cb107-68" aria-hidden="true" tabindex="-1"></a><span class="co"># impute missing values for nkill (Total Number of Fatalities: victims and attackers) as 0</span></span>
<span id="cb107-69"><a href="#cb107-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-70"><a href="#cb107-70" aria-hidden="true" tabindex="-1"></a>gtd_USA<span class="sc">$</span>nkill[<span class="fu">is.na</span>(gtd_USA<span class="sc">$</span>nkill)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb107-71"><a href="#cb107-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-72"><a href="#cb107-72" aria-hidden="true" tabindex="-1"></a><span class="co"># select desired columns for analysis</span></span>
<span id="cb107-73"><a href="#cb107-73" aria-hidden="true" tabindex="-1"></a>gtd_USA <span class="ot">&lt;-</span> gtd_USA <span class="sc">%&gt;%</span> </span>
<span id="cb107-74"><a href="#cb107-74" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(Date, provstate, city, </span>
<span id="cb107-75"><a href="#cb107-75" aria-hidden="true" tabindex="-1"></a>                     attacktype1_txt, targtype1_txt,</span>
<span id="cb107-76"><a href="#cb107-76" aria-hidden="true" tabindex="-1"></a>                     gname, nkill, nkillus, weaptype1_txt)</span>
<span id="cb107-77"><a href="#cb107-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-78"><a href="#cb107-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-79"><a href="#cb107-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r monthlyattdeath,include=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-80"><a href="#cb107-80" aria-hidden="true" tabindex="-1"></a><span class="co"># new dataframe for monthly number of attacks 1970-2020</span></span>
<span id="cb107-81"><a href="#cb107-81" aria-hidden="true" tabindex="-1"></a>gtd_monthly_attacks_deaths <span class="ot">&lt;-</span> gtd_USA <span class="sc">%&gt;%</span> </span>
<span id="cb107-82"><a href="#cb107-82" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(<span class="fu">year</span>(Date), <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-83"><a href="#cb107-83" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">summarise</span>(<span class="at">num_attacks =</span> <span class="fu">n</span>(), </span>
<span id="cb107-84"><a href="#cb107-84" aria-hidden="true" tabindex="-1"></a>                            <span class="at">nkill=</span><span class="fu">sum</span>(nkill))</span>
<span id="cb107-85"><a href="#cb107-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-86"><a href="#cb107-86" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gtd_monthly_attacks_deaths)[<span class="dv">1</span>] <span class="ot">=</span><span class="st">"Year"</span></span>
<span id="cb107-87"><a href="#cb107-87" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gtd_monthly_attacks_deaths)[<span class="dv">2</span>] <span class="ot">=</span><span class="st">"Month"</span></span>
<span id="cb107-88"><a href="#cb107-88" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gtd_monthly_attacks_deaths)[<span class="dv">4</span>] <span class="ot">=</span><span class="st">"num_fatal"</span></span>
<span id="cb107-89"><a href="#cb107-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-90"><a href="#cb107-90" aria-hidden="true" tabindex="-1"></a>gtd_monthly_attacks_deaths<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(gtd_monthly_attacks_deaths<span class="sc">$</span>Year, <span class="st">"-"</span>, gtd_monthly_attacks_deaths<span class="sc">$</span>Month, <span class="st">"-01"</span>), <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb107-91"><a href="#cb107-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-92"><a href="#cb107-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill missing dates (0 attacks for those dates)</span></span>
<span id="cb107-93"><a href="#cb107-93" aria-hidden="true" tabindex="-1"></a>gtd_monthly_attacks_deaths <span class="ot">&lt;-</span> gtd_monthly_attacks_deaths <span class="sc">%&gt;%</span> </span>
<span id="cb107-94"><a href="#cb107-94" aria-hidden="true" tabindex="-1"></a>              <span class="fu">complete</span>(<span class="at">Date =</span> <span class="fu">seq.Date</span>(<span class="fu">min</span>(Date), <span class="fu">max</span>(Date), <span class="at">by=</span><span class="st">"month"</span>)) </span>
<span id="cb107-95"><a href="#cb107-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-96"><a href="#cb107-96" aria-hidden="true" tabindex="-1"></a>gtd_monthly_attacks_deaths <span class="ot">&lt;-</span> <span class="fu">subset</span>(gtd_monthly_attacks_deaths, <span class="at">select=</span><span class="sc">-</span><span class="fu">c</span>(Year, Month))</span>
<span id="cb107-97"><a href="#cb107-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-98"><a href="#cb107-98" aria-hidden="true" tabindex="-1"></a><span class="co"># create 1993 months -&gt; returns NA's for num_attacks and num_fatal</span></span>
<span id="cb107-99"><a href="#cb107-99" aria-hidden="true" tabindex="-1"></a>gtd_monthly_attacks_deaths <span class="ot">&lt;-</span> <span class="fu">pad</span>(gtd_monthly_attacks_deaths, <span class="at">by=</span><span class="st">"Date"</span>)</span>
<span id="cb107-100"><a href="#cb107-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-101"><a href="#cb107-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-102"><a href="#cb107-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r interpolateattack, message=FALSE, warning=FALSE, echo=FALSE}</span></span>
<span id="cb107-103"><a href="#cb107-103" aria-hidden="true" tabindex="-1"></a><span class="co"># interpolating 1993 monthly attacks values (as per GTD only 28 attacks took place)</span></span>
<span id="cb107-104"><a href="#cb107-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-105"><a href="#cb107-105" aria-hidden="true" tabindex="-1"></a><span class="co"># fill in NAs with 0 for all years except 1993</span></span>
<span id="cb107-106"><a href="#cb107-106" aria-hidden="true" tabindex="-1"></a>gtd_monthly_attacks_deaths<span class="sc">$</span>num_attacks <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">year</span>(gtd_monthly_attacks_deaths<span class="sc">$</span>Date) <span class="sc">!=</span> <span class="dv">1993</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(gtd_monthly_attacks_deaths<span class="sc">$</span>num_attacks), <span class="dv">0</span>, gtd_monthly_attacks_deaths<span class="sc">$</span>num_attacks)   </span>
<span id="cb107-107"><a href="#cb107-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-108"><a href="#cb107-108" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1 of interpolation: 58 estimated total attacks in 1993</span></span>
<span id="cb107-109"><a href="#cb107-109" aria-hidden="true" tabindex="-1"></a>attacks_interp <span class="ot">&lt;-</span> <span class="fu">approx</span>(gtd_monthly_attacks_deaths<span class="sc">$</span>num_attacks[<span class="dv">265</span><span class="sc">:</span><span class="dv">276</span>], <span class="at">xout =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)<span class="sc">$</span>y <span class="sc">+</span> <span class="fu">approx</span>(gtd_monthly_attacks_deaths<span class="sc">$</span>num_attacks[<span class="dv">289</span><span class="sc">:</span><span class="dv">300</span>], <span class="at">xout =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)<span class="sc">$</span>y <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb107-110"><a href="#cb107-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-111"><a href="#cb107-111" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2 using zoo library: 54 estimated total attacks in 1993 so we use this</span></span>
<span id="cb107-112"><a href="#cb107-112" aria-hidden="true" tabindex="-1"></a><span class="co"># first create time series object of num_attacks</span></span>
<span id="cb107-113"><a href="#cb107-113" aria-hidden="true" tabindex="-1"></a>monthly_attacks_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(gtd_monthly_attacks_deaths<span class="sc">$</span>num_attacks, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1970</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb107-114"><a href="#cb107-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-115"><a href="#cb107-115" aria-hidden="true" tabindex="-1"></a>ts_attacks_interp <span class="ot">&lt;-</span> <span class="fu">na.approx</span>(monthly_attacks_ts) <span class="co"># approximate year 1993 NAs</span></span>
<span id="cb107-116"><a href="#cb107-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-117"><a href="#cb107-117" aria-hidden="true" tabindex="-1"></a><span class="co"># round and add up to see how many attacks estimated by approx()</span></span>
<span id="cb107-118"><a href="#cb107-118" aria-hidden="true" tabindex="-1"></a><span class="co">#cat("Number of attacks interpolated for 1993: ", sum(round(ts_attacks_interp[277:288],0)))</span></span>
<span id="cb107-119"><a href="#cb107-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-120"><a href="#cb107-120" aria-hidden="true" tabindex="-1"></a><span class="co"># impute use these values in original dataframe</span></span>
<span id="cb107-121"><a href="#cb107-121" aria-hidden="true" tabindex="-1"></a>gtd_monthly_attacks_deaths<span class="sc">$</span>num_attacks[<span class="dv">277</span><span class="sc">:</span><span class="dv">288</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(ts_attacks_interp[<span class="dv">277</span><span class="sc">:</span><span class="dv">288</span>],<span class="dv">0</span>)</span>
<span id="cb107-122"><a href="#cb107-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-123"><a href="#cb107-123" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to time series object with monthly frequency</span></span>
<span id="cb107-124"><a href="#cb107-124" aria-hidden="true" tabindex="-1"></a>monthly_attacks_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(gtd_monthly_attacks_deaths<span class="sc">$</span>num_attacks, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1970</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>) <span class="co"># 51 yrs of data</span></span>
<span id="cb107-125"><a href="#cb107-125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-126"><a href="#cb107-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-127"><a href="#cb107-127" aria-hidden="true" tabindex="-1"></a><span class="fu">### Splitting Series into Train and Test Sets for Model Validation Process</span></span>
<span id="cb107-128"><a href="#cb107-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-129"><a href="#cb107-129" aria-hidden="true" tabindex="-1"></a>After cleaning and aggregating the Global Terrorism Database™ (GTD) <span class="co">[</span><span class="ot">@GTD</span><span class="co">]</span> by month, we shall be splitting the aggregated monthly data set into train and test sets for model validation. I have kept 587 observations for training and the remaining 48 observations for testing or validating. Therefore, I have kept aside 2 years (48 months or 48 observations) for forecasting purposes.</span>
<span id="cb107-130"><a href="#cb107-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-131"><a href="#cb107-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r split, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-132"><a href="#cb107-132" aria-hidden="true" tabindex="-1"></a>train_series<span class="ot">=</span>monthly_attacks_ts[<span class="dv">1</span><span class="sc">:</span><span class="dv">587</span>] <span class="co"># close to 92%</span></span>
<span id="cb107-133"><a href="#cb107-133" aria-hidden="true" tabindex="-1"></a>test_series<span class="ot">=</span>monthly_attacks_ts[<span class="dv">588</span><span class="sc">:</span><span class="dv">612</span>] <span class="co"># keeping 2 years (48 months or 48 observations) to predict/forecast</span></span>
<span id="cb107-134"><a href="#cb107-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-135"><a href="#cb107-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-136"><a href="#cb107-136" aria-hidden="true" tabindex="-1"></a><span class="fu">### ACF and PACF Plots of Monthly Attacks {#ACF}</span></span>
<span id="cb107-137"><a href="#cb107-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-138"><a href="#cb107-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r pacf, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-139"><a href="#cb107-139" aria-hidden="true" tabindex="-1"></a>train_series <span class="sc">%&gt;%</span> </span>
<span id="cb107-140"><a href="#cb107-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtsdisplay</span>(<span class="at">main=</span><span class="st">"ACF and PACF Plots of Monthly Attacks"</span>)</span>
<span id="cb107-141"><a href="#cb107-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-142"><a href="#cb107-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-143"><a href="#cb107-143" aria-hidden="true" tabindex="-1"></a><span class="fu">### ADF Test of Monthly Attacks </span></span>
<span id="cb107-144"><a href="#cb107-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-145"><a href="#cb107-145" aria-hidden="true" tabindex="-1"></a>$H_0$: The time series is non-stationary. In other words, it has some time-dependent structure and does not have constant variance over time.</span>
<span id="cb107-146"><a href="#cb107-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-147"><a href="#cb107-147" aria-hidden="true" tabindex="-1"></a>$H_1$: The time series is stationary.</span>
<span id="cb107-148"><a href="#cb107-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-149"><a href="#cb107-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r adf, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-150"><a href="#cb107-150" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(train_series)</span>
<span id="cb107-151"><a href="#cb107-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-152"><a href="#cb107-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-153"><a href="#cb107-153" aria-hidden="true" tabindex="-1"></a>Because the p-value from the ADF test is less than $\alpha$ = 0.05, we reject the null hypothesis and conclude that the monthly attacks series is stationary. Although the ADF states that the original series is stationary, the ACF plots, which clearly indicate seasonality and trend, are more reliable than the ADF test. Therefore, it is safe to conclude that the series non-stationary as per the <span class="co">[</span><span class="ot">ACF</span><span class="co">](#ACF)</span> section above. </span>
<span id="cb107-154"><a href="#cb107-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-155"><a href="#cb107-155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Log-Transformation of Monthly Attacks and its First and Second Order Differencing</span></span>
<span id="cb107-156"><a href="#cb107-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-157"><a href="#cb107-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logadf, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-158"><a href="#cb107-158" aria-hidden="true" tabindex="-1"></a>lx <span class="ot">=</span> <span class="fu">log</span>(train_series<span class="sc">+</span><span class="dv">1</span>); dlx <span class="ot">=</span> <span class="fu">diff</span>(lx); ddlx <span class="ot">=</span> <span class="fu">diff</span>(dlx, <span class="dv">12</span>) <span class="co"># add 1 to lx to not get NAs</span></span>
<span id="cb107-159"><a href="#cb107-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-160"><a href="#cb107-160" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> train_series</span>
<span id="cb107-161"><a href="#cb107-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-162"><a href="#cb107-162" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(<span class="fu">cbind</span>(x,lx,dlx,ddlx), <span class="at">main=</span><span class="st">""</span>)</span>
<span id="cb107-163"><a href="#cb107-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-164"><a href="#cb107-164" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb107-165"><a href="#cb107-165" aria-hidden="true" tabindex="-1"></a><span class="fu">monthplot</span>(dlx); <span class="fu">monthplot</span>(ddlx)</span>
<span id="cb107-166"><a href="#cb107-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-167"><a href="#cb107-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-168"><a href="#cb107-168" aria-hidden="true" tabindex="-1"></a>Simply taking log of the number of monthly attacks does not make it stationary. First-differencing the log number of monthly attacks does, however, make the series stationary and this series should be employed for building our time series model. Keep in mind that because first-differencing was enough to make the series stationary, we do not need to second-difference it, helping us avoid over differencing the number of monthly attacks.</span>
<span id="cb107-169"><a href="#cb107-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-170"><a href="#cb107-170" aria-hidden="true" tabindex="-1"></a><span class="fu">### ADF Test of Log First-Differenced Monthly Attacks </span></span>
<span id="cb107-171"><a href="#cb107-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-172"><a href="#cb107-172" aria-hidden="true" tabindex="-1"></a>$H_0$: The time series is non-stationary. In other words, it has some time-dependent structure and does not have constant variance over time.</span>
<span id="cb107-173"><a href="#cb107-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-174"><a href="#cb107-174" aria-hidden="true" tabindex="-1"></a>$H_1$: The time series is stationary.</span>
<span id="cb107-175"><a href="#cb107-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-176"><a href="#cb107-176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lfdadf, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-177"><a href="#cb107-177" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(dlx)</span>
<span id="cb107-178"><a href="#cb107-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-179"><a href="#cb107-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-180"><a href="#cb107-180" aria-hidden="true" tabindex="-1"></a>Because the p-value from the ADF test is less than $\alpha$ = 0.05, we reject the null hypothesis and conclude that the log first-differenced monthly attacks series is stationary. Let us now check whether the ACF plots supports this hypothesis.</span>
<span id="cb107-181"><a href="#cb107-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-182"><a href="#cb107-182" aria-hidden="true" tabindex="-1"></a><span class="fu">### ACF and PACF Plots of Log First-Differenced Monthly Attacks {#lACF}</span></span>
<span id="cb107-183"><a href="#cb107-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-184"><a href="#cb107-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lfdpacf, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-185"><a href="#cb107-185" aria-hidden="true" tabindex="-1"></a>dlx <span class="sc">%&gt;%</span> </span>
<span id="cb107-186"><a href="#cb107-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtsdisplay</span>(<span class="at">main=</span><span class="st">"ACF and PACF Plots of Log First-Differenced Monthly Attacks"</span>)</span>
<span id="cb107-187"><a href="#cb107-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-188"><a href="#cb107-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-189"><a href="#cb107-189" aria-hidden="true" tabindex="-1"></a>**p** values obtained from PACF are 0, 1, 2, 3, 4</span>
<span id="cb107-190"><a href="#cb107-190" aria-hidden="true" tabindex="-1"></a>**q** values obtained from ACF are: 0, 1 </span>
<span id="cb107-191"><a href="#cb107-191" aria-hidden="true" tabindex="-1"></a>**d** (Difference): 1</span>
<span id="cb107-192"><a href="#cb107-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-193"><a href="#cb107-193" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting ARIMA(p,d,q) {#best-fit}</span></span>
<span id="cb107-194"><a href="#cb107-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-195"><a href="#cb107-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-196"><a href="#cb107-196" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-197"><a href="#cb107-197" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-198"><a href="#cb107-198" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb107-199"><a href="#cb107-199" aria-hidden="true" tabindex="-1"></a>ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">24</span>),<span class="at">nrow=</span><span class="dv">24</span>) <span class="co"># roughly nrow = 3x4x2</span></span>
<span id="cb107-200"><a href="#cb107-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-201"><a href="#cb107-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-202"><a href="#cb107-202" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)<span class="co"># p=0,1,2,3,4 </span></span>
<span id="cb107-203"><a href="#cb107-203" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb107-204"><a href="#cb107-204" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="co"># q=0,1,2,3 (although we only found q=1 to be significant in ACF, we may want to compare a complex ARIMA model with greater "q" value compared to a simpler ARIMA model)</span></span>
<span id="cb107-205"><a href="#cb107-205" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb107-206"><a href="#cb107-206" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span>)<span class="co"># d=1</span></span>
<span id="cb107-207"><a href="#cb107-207" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb107-208"><a href="#cb107-208" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb107-209"><a href="#cb107-209" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(p<span class="dv">-1</span><span class="sc">+</span>d<span class="sc">+</span>q<span class="dv">-1</span><span class="sc">&lt;=</span><span class="dv">8</span>)</span>
<span id="cb107-210"><a href="#cb107-210" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb107-211"><a href="#cb107-211" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb107-212"><a href="#cb107-212" aria-hidden="true" tabindex="-1"></a>        model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(lx,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>)) </span>
<span id="cb107-213"><a href="#cb107-213" aria-hidden="true" tabindex="-1"></a>        ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb107-214"><a href="#cb107-214" aria-hidden="true" tabindex="-1"></a>        i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb107-215"><a href="#cb107-215" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(i)</span></span>
<span id="cb107-216"><a href="#cb107-216" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb107-217"><a href="#cb107-217" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb107-218"><a href="#cb107-218" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb107-219"><a href="#cb107-219" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb107-220"><a href="#cb107-220" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-221"><a href="#cb107-221" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-222"><a href="#cb107-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-223"><a href="#cb107-223" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb107-224"><a href="#cb107-224" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb107-225"><a href="#cb107-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-226"><a href="#cb107-226" aria-hidden="true" tabindex="-1"></a><span class="co">#temp</span></span>
<span id="cb107-227"><a href="#cb107-227" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> temp[<span class="fu">order</span>(temp<span class="sc">$</span>BIC, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),] </span>
<span id="cb107-228"><a href="#cb107-228" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(temp)</span>
<span id="cb107-229"><a href="#cb107-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-230"><a href="#cb107-230" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of AIC: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-231"><a href="#cb107-231" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AIC),] </span>
<span id="cb107-232"><a href="#cb107-232" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of AICc: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-233"><a href="#cb107-233" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>AICc),]</span>
<span id="cb107-234"><a href="#cb107-234" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of BIC: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-235"><a href="#cb107-235" aria-hidden="true" tabindex="-1"></a>temp[<span class="fu">which.min</span>(temp<span class="sc">$</span>BIC),]</span>
<span id="cb107-236"><a href="#cb107-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-237"><a href="#cb107-237" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model summary and error metrics of ARIMA(0, 1, 1): </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-238"><a href="#cb107-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-239"><a href="#cb107-239" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(lx, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># no drift included </span></span>
<span id="cb107-240"><a href="#cb107-240" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb107-241"><a href="#cb107-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-242"><a href="#cb107-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-243"><a href="#cb107-243" aria-hidden="true" tabindex="-1"></a>The best model with the lowest BIC metric is the ARIMA(0,1,1). This model is a pure moving average model with first-order differencing and a single lagged moving average term. Therefore, the model has no autoregressive terms, i.e., it does not use the past values of the variable to predict its future values. It uses only the difference between the current and previous values of the variable and the error term to make the forecast. Although, according to both AIC and AICc metrics, the ARIMA(2,1,3) model is better, we shall choose our model using the BIC metric because BIC is more stringent than AIC in penalizing the number of parameters used in the model, making it more effective in helping reduce overfitting.</span>
<span id="cb107-244"><a href="#cb107-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-245"><a href="#cb107-245" aria-hidden="true" tabindex="-1"></a>ARIMA(2,1,3) is a time series model that involves taking the first-order difference of the series, using two Autoregressive (AR) terms and three Moving Average (MA) terms. This means that the model uses not only the past two values of the variable, but also the past three errors to make the forecast. The inclusion of the MA terms allows the model to capture the influence of random shocks or noise in the data. However, including too many autoregressive terms may lead to overfitting, which can result in poor forecast performance and we shall explore that in the next few sections</span>
<span id="cb107-246"><a href="#cb107-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-247"><a href="#cb107-247" aria-hidden="true" tabindex="-1"></a>The choice between ARIMA(0,1,1) and ARIMA(2,1,3) depends on the nature of the data and the performance of the models in terms of RMSE or other error metrics. If the data has a clear trend, then including Autoregressive terms may improve the forecast accuracy. On the other hand, if the data is more random, then a simpler model like ARIMA(0,1,1) may be sufficient. There is a clear decreasing trend of monthly terrorist attacks from the 1970s to 2015, with random and/or seasonal fluctuations, but the number of attacks does start increasing sharply after 2015. Therefore, no single pattern is discerned along the entire series and, moreover, we shall be abiding by the principle of parsimony if we select ARIMA(0,1,1) as the best model.</span>
<span id="cb107-248"><a href="#cb107-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-249"><a href="#cb107-249" aria-hidden="true" tabindex="-1"></a>The equation of the ARIMA(0,1,1) model is given by:</span>
<span id="cb107-250"><a href="#cb107-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-251"><a href="#cb107-251" aria-hidden="true" tabindex="-1"></a>$\begin{equation}(1-B)(1-\theta_1B)X_t = \omega_t\end{equation}$, giving us:</span>
<span id="cb107-252"><a href="#cb107-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-253"><a href="#cb107-253" aria-hidden="true" tabindex="-1"></a>$\begin{equation}\left(1-\theta_1B+B-\theta_1B^2\right)X_t = \omega_t\end{equation}$, giving us:</span>
<span id="cb107-254"><a href="#cb107-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-255"><a href="#cb107-255" aria-hidden="true" tabindex="-1"></a>$\begin{equation}\left(1-\theta_1B\right)X_t - B\left(1-\theta_1B\right)X_t = \omega_t\end{equation}$, giving us:</span>
<span id="cb107-256"><a href="#cb107-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-257"><a href="#cb107-257" aria-hidden="true" tabindex="-1"></a>$\begin{equation}X_t - \theta_1X_{t-1} - B\left(X_{t-1}-\theta_1X_{t-2}\right) = \omega_t\end{equation}$, finally substituting the MA(1) values from the model's summary:</span>
<span id="cb107-258"><a href="#cb107-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-259"><a href="#cb107-259" aria-hidden="true" tabindex="-1"></a>$\begin{equation}X_t = -0.8436X_{t-1} + X_{t-1} + 0.8436X_{t-2} + \omega_t\end{equation}$, where $(1-B)$ is the differencing operator, which represents the first-order difference of the series. $X_t$ is the time series, $\theta_1$ is the parameter of the MA component, and $\omega_t$ is the Gaussian white noise process. </span>
<span id="cb107-260"><a href="#cb107-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-261"><a href="#cb107-261" aria-hidden="true" tabindex="-1"></a>Note that $B$ is the backshift operator, which shifts the time series back by one period.</span>
<span id="cb107-262"><a href="#cb107-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-263"><a href="#cb107-263" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Diagnostics of ARIMA(0,1,1) {#ARIMA-Diag}</span></span>
<span id="cb107-264"><a href="#cb107-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-265"><a href="#cb107-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-266"><a href="#cb107-266" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(lx, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb107-267"><a href="#cb107-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-268"><a href="#cb107-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-269"><a href="#cb107-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-270"><a href="#cb107-270" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output[<span class="dv">24</span><span class="sc">:</span><span class="dv">55</span>], model_output[<span class="fu">length</span>(model_output)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb107-271"><a href="#cb107-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-272"><a href="#cb107-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-273"><a href="#cb107-273" aria-hidden="true" tabindex="-1"></a>Standardized Residuals: Essentially stating that if the errors are white noise. The model does look stationary as it captures all the signals and essentially captures the raw white noise.</span>
<span id="cb107-274"><a href="#cb107-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-275"><a href="#cb107-275" aria-hidden="true" tabindex="-1"></a>ACF Of Residuals: Auto-correlation of the residuals. The only **q** value to inspect is 1.</span>
<span id="cb107-276"><a href="#cb107-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-277"><a href="#cb107-277" aria-hidden="true" tabindex="-1"></a>Q-Q Plot: The series follows a normal distribution pretty closely as even the tails seem to be on the normal line.</span>
<span id="cb107-278"><a href="#cb107-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-279"><a href="#cb107-279" aria-hidden="true" tabindex="-1"></a>p values of the Ljung-Box statistic: Ideally, we would like to fail to reject the null hypothesis. That is, we would like to see the p-value of the test be greater than 0.05 because this means the residuals for our time series model are independent, which is often an assumption we make when creating a model. Since all lag values greater than 5 have a p-value greater than 0.05, the residuals have no remaining autocorrelations.</span>
<span id="cb107-280"><a href="#cb107-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-281"><a href="#cb107-281" aria-hidden="true" tabindex="-1"></a>The only MA term in the ARIMA(0,1,1) model is also significant at the $\alpha$=5% level as shown by its p-value = 0. Let's check whether all terms in the ARIMA(2,1,3) model are significant or not.</span>
<span id="cb107-282"><a href="#cb107-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-283"><a href="#cb107-283" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Diagnostics of ARIMA(2,1,3) </span></span>
<span id="cb107-284"><a href="#cb107-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-285"><a href="#cb107-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-286"><a href="#cb107-286" aria-hidden="true" tabindex="-1"></a>model_output2 <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(lx, <span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb107-287"><a href="#cb107-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-288"><a href="#cb107-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-289"><a href="#cb107-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-290"><a href="#cb107-290" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(model_output2[<span class="dv">205</span><span class="sc">:</span><span class="dv">239</span>], model_output2[<span class="fu">length</span>(model_output2)], <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb107-291"><a href="#cb107-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-292"><a href="#cb107-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-293"><a href="#cb107-293" aria-hidden="true" tabindex="-1"></a>Like the ARIMA(0,1,1) output for the summary of residuals, the ARIMA(2,1,3) does as well, if not better. The ACF of residuals for ARIMA(2,1,3), although, has spikes less significant than ARIMA(0,1,1) and the p-values for Ljung-Box test for ARIMA(2,1,3) are higher than those of ARIMA(0,1,1). However, a key difference is that only the MA(1) term in the ARIMA(2,1,3) model is significant at the $\alpha$=5% level as shown by its p-value = 0.0004 and all other terms are not significant. Therefore, a simpler model, ARIMA(0,1,1), would be a better fit to the log of monthly attacks series.</span>
<span id="cb107-294"><a href="#cb107-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-295"><a href="#cb107-295" aria-hidden="true" tabindex="-1"></a>Let's see what model is outputted by <span class="in">`auto.arima()`</span>.</span>
<span id="cb107-296"><a href="#cb107-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-297"><a href="#cb107-297" aria-hidden="true" tabindex="-1"></a><span class="fu">### Checking Model Output of Log Monthly Attacks with auto.arima()</span></span>
<span id="cb107-298"><a href="#cb107-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-299"><a href="#cb107-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-300"><a href="#cb107-300" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">auto.arima</span>(lx, <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-301"><a href="#cb107-301" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model metrics using auto.arima(): </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-302"><a href="#cb107-302" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb107-303"><a href="#cb107-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-304"><a href="#cb107-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-305"><a href="#cb107-305" aria-hidden="true" tabindex="-1"></a>From the above output, <span class="in">`auto.arima()`</span> too outputted an ARIMA(0,1,1) model, which is is the best model returned by the <span class="in">`Arima()`</span> function in terms of <span class="co">[</span><span class="ot">lowest BIC</span><span class="co">](#best-fit)</span>. Some points to keep in mind when using these functions is as follows:</span>
<span id="cb107-306"><a href="#cb107-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-307"><a href="#cb107-307" aria-hidden="true" tabindex="-1"></a>The <span class="in">`auto.arima()`</span> function in R uses a stepwise algorithm to search through the space of possible ARIMA models and select the one with the lowest AIC value. While this approach can be computationally efficient and provide a good starting point for model selection, it does not necessarily always find the best possible model for a given time series.</span>
<span id="cb107-308"><a href="#cb107-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-309"><a href="#cb107-309" aria-hidden="true" tabindex="-1"></a>On the other hand, the <span class="in">`Arima()`</span> function in R allows us to specify the exact order of the ARIMA model and can be used to fit more complex models, such as those with seasonality, exogenous variables, or other constraints. By specifying the exact order of the model, we have more control over the modeling process and can potentially obtain a better fit to the data.</span>
<span id="cb107-310"><a href="#cb107-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-311"><a href="#cb107-311" aria-hidden="true" tabindex="-1"></a>In summary, the <span class="in">`auto.arima()`</span> function can be a useful tool for quickly identifying a potentially good model, but it is not a substitute for careful model selection and customization seen when using the <span class="in">`Arima()`</span> function.</span>
<span id="cb107-312"><a href="#cb107-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-313"><a href="#cb107-313" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forecasting ARIMA(0,1,1) and ARIMA(2,1,3)</span></span>
<span id="cb107-314"><a href="#cb107-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-315"><a href="#cb107-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-316"><a href="#cb107-316" aria-hidden="true" tabindex="-1"></a>arimaModel_1 <span class="ot">&lt;-</span> <span class="fu">arima</span>(lx, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb107-317"><a href="#cb107-317" aria-hidden="true" tabindex="-1"></a>arimaModel_2 <span class="ot">&lt;-</span> <span class="fu">arima</span>(lx, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb107-318"><a href="#cb107-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-319"><a href="#cb107-319" aria-hidden="true" tabindex="-1"></a>forecast1<span class="ot">=</span><span class="fu">predict</span>(arimaModel_1, <span class="fu">length</span>(test_series)) <span class="co"># make forecasts for 2 years ahead as given by length of test_series</span></span>
<span id="cb107-320"><a href="#cb107-320" aria-hidden="true" tabindex="-1"></a>forecast2<span class="ot">=</span><span class="fu">predict</span>(arimaModel_2, <span class="fu">length</span>(test_series))</span>
<span id="cb107-321"><a href="#cb107-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-322"><a href="#cb107-322" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the time series and forecast objects to data frames</span></span>
<span id="cb107-323"><a href="#cb107-323" aria-hidden="true" tabindex="-1"></a>ts_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">time</span>(monthly_attacks_ts), <span class="at">value =</span> <span class="fu">as.numeric</span>(monthly_attacks_ts))</span>
<span id="cb107-324"><a href="#cb107-324" aria-hidden="true" tabindex="-1"></a>train_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">time</span>(monthly_attacks_ts)[<span class="dv">1</span><span class="sc">:</span><span class="dv">587</span>], <span class="at">value =</span> <span class="fu">as.numeric</span>(lx))</span>
<span id="cb107-325"><a href="#cb107-325" aria-hidden="true" tabindex="-1"></a>forecast1_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">time</span>(monthly_attacks_ts)[<span class="dv">588</span><span class="sc">:</span><span class="dv">612</span>], <span class="at">value =</span> forecast1<span class="sc">$</span>pred)</span>
<span id="cb107-326"><a href="#cb107-326" aria-hidden="true" tabindex="-1"></a>forecast2_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">date =</span> <span class="fu">time</span>(monthly_attacks_ts)[<span class="dv">588</span><span class="sc">:</span><span class="dv">612</span>], <span class="at">value =</span> forecast2<span class="sc">$</span>pred)</span>
<span id="cb107-327"><a href="#cb107-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-328"><a href="#cb107-328" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the time series and forecasts</span></span>
<span id="cb107-329"><a href="#cb107-329" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(<span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb107-330"><a href="#cb107-330" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> train_df[<span class="dv">500</span><span class="sc">:</span><span class="dv">588</span>,], <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, </span>
<span id="cb107-331"><a href="#cb107-331" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"Actual Train Values"</span>), <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb107-332"><a href="#cb107-332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> train_df[<span class="dv">500</span><span class="sc">:</span><span class="dv">588</span>,], <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value), </span>
<span id="cb107-333"><a href="#cb107-333" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">16</span>, <span class="at">alpha=</span><span class="fl">0.4</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb107-334"><a href="#cb107-334" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> forecast1_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, </span>
<span id="cb107-335"><a href="#cb107-335" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="st">"ARIMA(0,1,1) Forecast"</span>), <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb107-336"><a href="#cb107-336" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> forecast2_df, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, </span>
<span id="cb107-337"><a href="#cb107-337" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="st">"ARIMA(2,1,3) Forecast"</span>), <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb107-338"><a href="#cb107-338" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> ts_df[<span class="dv">588</span><span class="sc">:</span><span class="dv">612</span>,], <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> <span class="fu">log</span>(value), </span>
<span id="cb107-339"><a href="#cb107-339" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="st">"Actual Forecast Values"</span>), <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb107-340"><a href="#cb107-340" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Log of Number of Monthly Attacks"</span>, <span class="at">title =</span> <span class="st">"Forecasting ARIMA(0,1,1) and ARIMA(2,1,3)"</span>) <span class="sc">+</span></span>
<span id="cb107-341"><a href="#cb107-341" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb107-342"><a href="#cb107-342" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Forecast"</span>, </span>
<span id="cb107-343"><a href="#cb107-343" aria-hidden="true" tabindex="-1"></a>                       <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"ARIMA(0,1,1) Forecast"</span> <span class="ot">=</span> <span class="st">"blue"</span>, </span>
<span id="cb107-344"><a href="#cb107-344" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"ARIMA(2,1,3) Forecast"</span> <span class="ot">=</span> <span class="st">"green"</span>,</span>
<span id="cb107-345"><a href="#cb107-345" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Actual Forecast Values"</span> <span class="ot">=</span> <span class="st">"orange"</span>),</span>
<span id="cb107-346"><a href="#cb107-346" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"ARIMA(0,1,1) Forecast"</span>, </span>
<span id="cb107-347"><a href="#cb107-347" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"ARIMA(2,1,3) Forecast"</span>,</span>
<span id="cb107-348"><a href="#cb107-348" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Actual Forecast Values"</span>)))</span>
<span id="cb107-349"><a href="#cb107-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-350"><a href="#cb107-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-351"><a href="#cb107-351" aria-hidden="true" tabindex="-1"></a>From the above graph, we can note that the forecasted number of attacks remains constant at around 1 for both models on the test set (October 2010 to December 2020). This performance is not what was expected and, hence, it is possible that the models are not able to capture the underlying patterns in the data. This can be due to a variety of reasons, such as insufficient data and the models not being complex enough to capture the variation in the data. It is, however, pragmatic to check whether the <span class="in">`sarima.for()`</span> function's predictions may forecast differently. Let us find out below.</span>
<span id="cb107-352"><a href="#cb107-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-353"><a href="#cb107-353" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forecasting ARIMA(0,1,1) using sarima.for()</span></span>
<span id="cb107-354"><a href="#cb107-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-355"><a href="#cb107-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-356"><a href="#cb107-356" aria-hidden="true" tabindex="-1"></a>log_monthly_attacks <span class="ot">&lt;-</span> <span class="fu">ts</span>(lx, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1970</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>) <span class="co"># Objects of class &lt;numeric&gt; are not supported by autoplot.</span></span>
<span id="cb107-357"><a href="#cb107-357" aria-hidden="true" tabindex="-1"></a><span class="fu">sarima.for</span>(<span class="fu">ts</span>(train_df<span class="sc">$</span>value, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1970</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>), <span class="dv">24</span>, <span class="at">p =</span> <span class="dv">0</span>, <span class="at">d =</span> <span class="dv">1</span>, <span class="at">q =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">"Forecasting ARIMA(0,1,1) using sarima.for()"</span>) </span>
<span id="cb107-358"><a href="#cb107-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-359"><a href="#cb107-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-360"><a href="#cb107-360" aria-hidden="true" tabindex="-1"></a>Like the previous forecast, we can note that <span class="in">`sarima.for()`</span> too does not accurately capture the inherent randomness and/or seasonality in the series and, hence, it outputs a highly linear, downward trending forecast. As per its 95% confidence bound, the number of attacks will fluctuate anywhere between 3 to 12 attacks every month from 2019 to end of 2020  (keep in mind that the plot is log of monthly attacks). </span>
<span id="cb107-361"><a href="#cb107-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-362"><a href="#cb107-362" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing ARIMA(0,1,1) with Benchmarks</span></span>
<span id="cb107-363"><a href="#cb107-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-364"><a href="#cb107-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-365"><a href="#cb107-365" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(log_monthly_attacks) <span class="sc">+</span></span>
<span id="cb107-366"><a href="#cb107-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>),</span>
<span id="cb107-367"><a href="#cb107-367" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-368"><a href="#cb107-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>),</span>
<span id="cb107-369"><a href="#cb107-369" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-370"><a href="#cb107-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>),</span>
<span id="cb107-371"><a href="#cb107-371" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb107-372"><a href="#cb107-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb107-373"><a href="#cb107-373" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb107-374"><a href="#cb107-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(<span class="fu">Arima</span>(log_monthly_attacks, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="dv">24</span>), </span>
<span id="cb107-375"><a href="#cb107-375" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"ARIMA(0,1,1)"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-376"><a href="#cb107-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>)) <span class="sc">+</span></span>
<span id="cb107-377"><a href="#cb107-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log of Monthly Attacks"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Forecasting ARIMA(0,1,1) and Benchmarks"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb107-378"><a href="#cb107-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-379"><a href="#cb107-379" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ARIMA(0,1,1) model metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-380"><a href="#cb107-380" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(log_monthly_attacks, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb107-381"><a href="#cb107-381" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb107-382"><a href="#cb107-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-383"><a href="#cb107-383" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Mean metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-384"><a href="#cb107-384" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">meanf</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>) </span>
<span id="cb107-385"><a href="#cb107-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-386"><a href="#cb107-386" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(f1)</span>
<span id="cb107-387"><a href="#cb107-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-388"><a href="#cb107-388" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f1)</span>
<span id="cb107-389"><a href="#cb107-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-390"><a href="#cb107-390" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Snaive metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-391"><a href="#cb107-391" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">snaive</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>) </span>
<span id="cb107-392"><a href="#cb107-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-393"><a href="#cb107-393" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(f2)</span>
<span id="cb107-394"><a href="#cb107-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-395"><a href="#cb107-395" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f2)</span>
<span id="cb107-396"><a href="#cb107-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-397"><a href="#cb107-397" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Random Walk metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-398"><a href="#cb107-398" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">rwf</span>(log_monthly_attacks, <span class="at">h=</span><span class="dv">24</span>) </span>
<span id="cb107-399"><a href="#cb107-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-400"><a href="#cb107-400" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(f3)</span>
<span id="cb107-401"><a href="#cb107-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-402"><a href="#cb107-402" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f3)</span>
<span id="cb107-403"><a href="#cb107-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-404"><a href="#cb107-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-405"><a href="#cb107-405" aria-hidden="true" tabindex="-1"></a>From the above plot, only the Snaive benchmark method's forecasts seem more plausible compared to that of the ARIMA(0,1,1) model. The forecasts produced from the Snaive benchmark have the greatest amount of fluctuations or seasonality in a higher range of number of monthly attacks. However, the metrics paint a different story. The ARIMA(0,1,1) model's training error measures are better than those of all the benchmarks. There are several reasons for this phenomenon:</span>
<span id="cb107-406"><a href="#cb107-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-407"><a href="#cb107-407" aria-hidden="true" tabindex="-1"></a>Model Assumptions: The ARIMA model assumes that the data is stationary, which means that the mean and variance of the data do not change over time. If the data violates this assumption, the ARIMA model may not perform well. In contrast, the Snaive model does not assume stationarity, which may make it more robust to non-stationary data.</span>
<span id="cb107-408"><a href="#cb107-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-409"><a href="#cb107-409" aria-hidden="true" tabindex="-1"></a>Parameter Estimation: The ARIMA model has three parameters (p, d, q) that need to be estimated, whereas the Snaive model has only one parameter (the seasonality). It is possible that the parameter estimation process for the ARIMA model was not optimal, leading to suboptimal forecast performance.</span>
<span id="cb107-410"><a href="#cb107-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-411"><a href="#cb107-411" aria-hidden="true" tabindex="-1"></a>Forecast Horizon: The Snaive model may perform better than the ARIMA model for shorter forecast horizons, while the ARIMA model may perform better for longer forecast horizons. This is because the Snaive model assumes that the future values of the time series will be the same as the past values at the same time of year, which may be a reasonable assumption for short forecast horizons, but not for longer ones.</span>
<span id="cb107-412"><a href="#cb107-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-413"><a href="#cb107-413" aria-hidden="true" tabindex="-1"></a><span class="fu">## Global Terrorism Database SARIMA Modeling</span></span>
<span id="cb107-414"><a href="#cb107-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-415"><a href="#cb107-415" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing Seasonal Components of Monthly Attacks </span></span>
<span id="cb107-416"><a href="#cb107-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-417"><a href="#cb107-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sznlcomp, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-418"><a href="#cb107-418" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize Seasonal Component</span></span>
<span id="cb107-419"><a href="#cb107-419" aria-hidden="true" tabindex="-1"></a>attacks.s<span class="ot">=</span><span class="fu">decompose</span>(monthly_attacks_ts)<span class="sc">$</span>seasonal</span>
<span id="cb107-420"><a href="#cb107-420" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(attacks.s, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">'Seasonal Component of Number of Monthly Terrorist Attacks in the US Over Time'</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">type=</span><span class="st">'c'</span>) </span>
<span id="cb107-421"><a href="#cb107-421" aria-hidden="true" tabindex="-1"></a>Quarters <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>) </span>
<span id="cb107-422"><a href="#cb107-422" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(attacks.s, <span class="at">pch=</span>Quarters, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">font=</span><span class="dv">4</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb107-423"><a href="#cb107-423" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>); <span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">gray</span>(.<span class="dv">7</span>))</span>
<span id="cb107-424"><a href="#cb107-424" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>); <span class="fu">box</span>()</span>
<span id="cb107-425"><a href="#cb107-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-426"><a href="#cb107-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-427"><a href="#cb107-427" aria-hidden="true" tabindex="-1"></a>From the above seasonal component graph of the number of monthly terrorist attacks, we notice there does exist some level of seasonality in the original series. The seasonal component graph illustrates the degree of seasonal variation in the number of terrorist attacks. The magnitude of the seasonal variation is shown on the y-axis of the graph, and it indicates how much the number of terrorist attacks deviates from the average value for each season. The graph shows a repeating pattern in the number of terrorist attacks over time, with clear peaks in the first and second quarters and troughs in the third quarter. This pattern implies that the number of terrorist attacks in the US *might* be influenced by the season of the year. </span>
<span id="cb107-428"><a href="#cb107-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-429"><a href="#cb107-429" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing Seasonally Differenced Monthly Attacks </span></span>
<span id="cb107-430"><a href="#cb107-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-431"><a href="#cb107-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sznldiff, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-432"><a href="#cb107-432" aria-hidden="true" tabindex="-1"></a><span class="co"># Seasonal differenced</span></span>
<span id="cb107-433"><a href="#cb107-433" aria-hidden="true" tabindex="-1"></a>attacks.diff<span class="ot">=</span><span class="fu">diff</span>(monthly_attacks_ts,<span class="dv">12</span>)</span>
<span id="cb107-434"><a href="#cb107-434" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(attacks.diff, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">'Number of Monthly Terrorist Attacks (S. differenced)'</span>,<span class="at">type=</span><span class="st">'c'</span>) <span class="co">#with type='c' I get dashed lines</span></span>
<span id="cb107-435"><a href="#cb107-435" aria-hidden="true" tabindex="-1"></a>Quarters <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>) </span>
<span id="cb107-436"><a href="#cb107-436" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(attacks.diff, <span class="at">pch=</span>Quarters, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">font=</span><span class="dv">4</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb107-437"><a href="#cb107-437" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>); <span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">gray</span>(.<span class="dv">7</span>))</span>
<span id="cb107-438"><a href="#cb107-438" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>); <span class="fu">box</span>()</span>
<span id="cb107-439"><a href="#cb107-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-440"><a href="#cb107-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-441"><a href="#cb107-441" aria-hidden="true" tabindex="-1"></a><span class="fu">### ACF and PACF Plots of Seasonally Differenced Monthly Attacks </span></span>
<span id="cb107-442"><a href="#cb107-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-443"><a href="#cb107-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r pacfsznldiff, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-444"><a href="#cb107-444" aria-hidden="true" tabindex="-1"></a>monthly_attacks_ts <span class="sc">%&gt;%</span> </span>
<span id="cb107-445"><a href="#cb107-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="at">lag=</span><span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb107-446"><a href="#cb107-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtsdisplay</span>(<span class="at">main=</span><span class="st">"ACF and PACF Plots of First Seasonal Differenced Monthly Attacks"</span>)</span>
<span id="cb107-447"><a href="#cb107-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-448"><a href="#cb107-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-449"><a href="#cb107-449" aria-hidden="true" tabindex="-1"></a>After first ordinary differencing the original series @ACF, we saw a lot of seasonal correlation left, suggesting that first order differencing did not help in transforming the raw data into a stationary series. This differenced series cannot be used for building a robust SARIMA model. Therefore, a seasonal differencing on the original monthly attacks was performed above and we can still notice some correlation left, but lesser compared to when the raw series was differenced with first order. Therefore, it could be that D=1 and d=0. Let’s keep this as one option and let's proceed with performing both seasonal differencing and first-order differencing the raw monthly attacks series.</span>
<span id="cb107-450"><a href="#cb107-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-451"><a href="#cb107-451" aria-hidden="true" tabindex="-1"></a><span class="fu">### ACF and PACF Plots of Seasonally and First Order Differenced Monthly Attacks </span></span>
<span id="cb107-452"><a href="#cb107-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-453"><a href="#cb107-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r pacfsznlfodiff, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-454"><a href="#cb107-454" aria-hidden="true" tabindex="-1"></a>monthly_attacks_ts <span class="sc">%&gt;%</span> </span>
<span id="cb107-455"><a href="#cb107-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="at">lag=</span><span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb107-456"><a href="#cb107-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>() <span class="sc">%&gt;%</span></span>
<span id="cb107-457"><a href="#cb107-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtsdisplay</span>(<span class="at">main=</span><span class="st">"ACF and PACF Plots of Seasonally and First Order Differenced Monthly Attacks"</span>)</span>
<span id="cb107-458"><a href="#cb107-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-459"><a href="#cb107-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-460"><a href="#cb107-460" aria-hidden="true" tabindex="-1"></a>After both seasonal differencing and ordinary differencing together the raw data, the ACF and PACF plots seem to portray the least correlation than the individual differencing methods. Next, we shall difference and select the relevant p,d,q,P,D,Q values from the original monthly attacks series for our SARIMA model. </span>
<span id="cb107-461"><a href="#cb107-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-462"><a href="#cb107-462" aria-hidden="true" tabindex="-1"></a>From the seasonal differencing and ordinary differencing (together) ACF and PACF plots, the following combinations for p,d,q,P,D,Q are:</span>
<span id="cb107-463"><a href="#cb107-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-464"><a href="#cb107-464" aria-hidden="true" tabindex="-1"></a>q values obtained from ACF = 0,1,2,3,4</span>
<span id="cb107-465"><a href="#cb107-465" aria-hidden="true" tabindex="-1"></a>Q values obtained from ACF = 1</span>
<span id="cb107-466"><a href="#cb107-466" aria-hidden="true" tabindex="-1"></a>p values obtained from PACF = 0,1,2,3,4</span>
<span id="cb107-467"><a href="#cb107-467" aria-hidden="true" tabindex="-1"></a>P values obtained from PACF = 1,2</span>
<span id="cb107-468"><a href="#cb107-468" aria-hidden="true" tabindex="-1"></a>d (Difference) = 1</span>
<span id="cb107-469"><a href="#cb107-469" aria-hidden="true" tabindex="-1"></a>D (Seasonal Difference) = 1</span>
<span id="cb107-470"><a href="#cb107-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-471"><a href="#cb107-471" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting ARIMA(p,d,q)(P,D,Q)</span></span>
<span id="cb107-472"><a href="#cb107-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-473"><a href="#cb107-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fitsarima, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-474"><a href="#cb107-474" aria-hidden="true" tabindex="-1"></a><span class="do">######################## Check for different combinations ########</span></span>
<span id="cb107-475"><a href="#cb107-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-476"><a href="#cb107-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-477"><a href="#cb107-477" aria-hidden="true" tabindex="-1"></a><span class="co">#write a funtion</span></span>
<span id="cb107-478"><a href="#cb107-478" aria-hidden="true" tabindex="-1"></a>SARIMA.c<span class="ot">=</span><span class="cf">function</span>(p1,p2,q1,q2,P1,P2,Q1,Q2,data){</span>
<span id="cb107-479"><a href="#cb107-479" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-480"><a href="#cb107-480" aria-hidden="true" tabindex="-1"></a>  <span class="co">#K=(p2+1)*(q2+1)*(P2+1)*(Q2+1)</span></span>
<span id="cb107-481"><a href="#cb107-481" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-482"><a href="#cb107-482" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb107-483"><a href="#cb107-483" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-484"><a href="#cb107-484" aria-hidden="true" tabindex="-1"></a>  D<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-485"><a href="#cb107-485" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb107-486"><a href="#cb107-486" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-487"><a href="#cb107-487" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-488"><a href="#cb107-488" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb107-489"><a href="#cb107-489" aria-hidden="true" tabindex="-1"></a>  ls<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">29</span>),<span class="at">nrow=</span><span class="dv">29</span>)</span>
<span id="cb107-490"><a href="#cb107-490" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-491"><a href="#cb107-491" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-492"><a href="#cb107-492" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> p1<span class="sc">:</span>p2)</span>
<span id="cb107-493"><a href="#cb107-493" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb107-494"><a href="#cb107-494" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(q <span class="cf">in</span> q1<span class="sc">:</span>q2)</span>
<span id="cb107-495"><a href="#cb107-495" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb107-496"><a href="#cb107-496" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(P <span class="cf">in</span> P1<span class="sc">:</span>P2)</span>
<span id="cb107-497"><a href="#cb107-497" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb107-498"><a href="#cb107-498" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(Q <span class="cf">in</span> Q1<span class="sc">:</span>Q2)</span>
<span id="cb107-499"><a href="#cb107-499" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb107-500"><a href="#cb107-500" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span>(p<span class="sc">+</span>d<span class="sc">+</span>q<span class="sc">+</span>P<span class="sc">+</span>D<span class="sc">+</span>Q<span class="sc">&lt;=</span><span class="dv">9</span>) <span class="co"># parsimonious principle</span></span>
<span id="cb107-501"><a href="#cb107-501" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb107-502"><a href="#cb107-502" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb107-503"><a href="#cb107-503" aria-hidden="true" tabindex="-1"></a>            model<span class="ot">&lt;-</span> <span class="fu">Arima</span>(data,<span class="at">order=</span><span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>))</span>
<span id="cb107-504"><a href="#cb107-504" aria-hidden="true" tabindex="-1"></a>            ls[i,]<span class="ot">=</span> <span class="fu">c</span>(p<span class="dv">-1</span>,d,q<span class="dv">-1</span>,P<span class="dv">-1</span>,D,Q<span class="dv">-1</span>,model<span class="sc">$</span>aic,model<span class="sc">$</span>bic,model<span class="sc">$</span>aicc)</span>
<span id="cb107-505"><a href="#cb107-505" aria-hidden="true" tabindex="-1"></a>            i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb107-506"><a href="#cb107-506" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(i)</span></span>
<span id="cb107-507"><a href="#cb107-507" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb107-508"><a href="#cb107-508" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb107-509"><a href="#cb107-509" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb107-510"><a href="#cb107-510" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-511"><a href="#cb107-511" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb107-512"><a href="#cb107-512" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb107-513"><a href="#cb107-513" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-514"><a href="#cb107-514" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-515"><a href="#cb107-515" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-516"><a href="#cb107-516" aria-hidden="true" tabindex="-1"></a>  temp<span class="ot">=</span> <span class="fu">as.data.frame</span>(ls)</span>
<span id="cb107-517"><a href="#cb107-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(temp)<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"d"</span>,<span class="st">"q"</span>,<span class="st">"P"</span>,<span class="st">"D"</span>,<span class="st">"Q"</span>,<span class="st">"AIC"</span>,<span class="st">"BIC"</span>,<span class="st">"AICc"</span>)</span>
<span id="cb107-518"><a href="#cb107-518" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-519"><a href="#cb107-519" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb107-520"><a href="#cb107-520" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-521"><a href="#cb107-521" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-522"><a href="#cb107-522" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-523"><a href="#cb107-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-524"><a href="#cb107-524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-525"><a href="#cb107-525" aria-hidden="true" tabindex="-1"></a><span class="co"># q=0,1,2,3,4; Q=1 and PACF plot: p=0,1,2,3,4; P=1,2; D=1 and d=1</span></span>
<span id="cb107-526"><a href="#cb107-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-527"><a href="#cb107-527" aria-hidden="true" tabindex="-1"></a>output<span class="ot">=</span><span class="fu">SARIMA.c</span>(<span class="at">p1=</span><span class="dv">1</span>,<span class="at">p2=</span><span class="dv">5</span>,<span class="at">q1=</span><span class="dv">1</span>,<span class="at">q2=</span><span class="dv">5</span>,<span class="at">P1=</span><span class="dv">1</span>,<span class="at">P2=</span><span class="dv">3</span>,<span class="at">Q1=</span><span class="dv">1</span>,<span class="at">Q2=</span><span class="dv">2</span>,<span class="at">data=</span>monthly_attacks_ts)</span>
<span id="cb107-528"><a href="#cb107-528" aria-hidden="true" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb107-529"><a href="#cb107-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-530"><a href="#cb107-530" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span>
<span id="cb107-531"><a href="#cb107-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-532"><a href="#cb107-532" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of AIC: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-533"><a href="#cb107-533" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AIC),] </span>
<span id="cb107-534"><a href="#cb107-534" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of AICc: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-535"><a href="#cb107-535" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>AICc),]</span>
<span id="cb107-536"><a href="#cb107-536" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st"> Best Model in terms of BIC: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-537"><a href="#cb107-537" aria-hidden="true" tabindex="-1"></a>output[<span class="fu">which.min</span>(output<span class="sc">$</span>BIC),]</span>
<span id="cb107-538"><a href="#cb107-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-539"><a href="#cb107-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-540"><a href="#cb107-540" aria-hidden="true" tabindex="-1"></a>The best model with the lowest BIC metric is the SARIMA(0,1,1,0,1,1) model. Although, according to both AIC and AICc metrics, the SARIMA(1,1,1,0,1,1) is better, we shall choose our model using the BIC metric because BIC is more stringent than AIC in penalizing the number of parameters used in the model, making it more effective in helping reduce overfitting. The equation of the SARIMA(0,1,1,0,1,1) model is given by:</span>
<span id="cb107-541"><a href="#cb107-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-542"><a href="#cb107-542" aria-hidden="true" tabindex="-1"></a>$\begin{equation}(1-B)(1-B^1)y_t = \delta + (1+\phi_1B)(1-\theta_1B-\theta_2B^2)w_t\end{equation}$, where $(1-B)$ and $(1-B^1)$ are the differencing operators, which represent the first-order difference of the series. $y_t$ is the time series, $\delta$ is the drift term, $\phi_1$ and $\theta_1$, $\theta_2$ are the parameters of the AR and MA parts, respectively, and $w_t$ is the Gaussian white noise process.</span>
<span id="cb107-543"><a href="#cb107-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-544"><a href="#cb107-544" aria-hidden="true" tabindex="-1"></a>Note that $B$ is the backshift operator, which shifts the time series back by one period.</span>
<span id="cb107-545"><a href="#cb107-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-546"><a href="#cb107-546" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Diagnostics of ARIMA(0,1,1)(0,1,1)</span></span>
<span id="cb107-547"><a href="#cb107-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-548"><a href="#cb107-548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-549"><a href="#cb107-549" aria-hidden="true" tabindex="-1"></a>model_output <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">sarima</span>(monthly_attacks_ts, <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>))</span>
<span id="cb107-550"><a href="#cb107-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-551"><a href="#cb107-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-552"><a href="#cb107-552" aria-hidden="true" tabindex="-1"></a>Standardized Residuals: Essentially stating if the errors are white noise. The model does look stationary as it captures all the signals and essentially captures the raw white noise.</span>
<span id="cb107-553"><a href="#cb107-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-554"><a href="#cb107-554" aria-hidden="true" tabindex="-1"></a>ACF Of Residuals: However, looking at the ACF of the Residuals gives us a definitive answer to whether the model is stationary. Because some spikes are not within the significance limits, the model is not being able to capture all the signal in the data. In fact, the <span class="co">[</span><span class="ot">ARIMA(1,1,2) model's diagnostics</span><span class="co">](#ARIMA-Diag)</span> are better than that of ARIMA(0,1,1)(0,1,1) above.</span>
<span id="cb107-555"><a href="#cb107-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-556"><a href="#cb107-556" aria-hidden="true" tabindex="-1"></a>Q-Q Plot: The series weakly follows a normal distribution as the tails waver away significantly from the normal line.</span>
<span id="cb107-557"><a href="#cb107-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-558"><a href="#cb107-558" aria-hidden="true" tabindex="-1"></a>p values of the Ljung-Box statistic: Ideally, we would like to fail to reject the null hypothesis. That is, we would like to see the p-value of the test be greater than 0.05 because this means the residuals for our time series model are independent, which is often an assumption we make when creating a model. Since all lag values greater than 5 have a p-value less than 0.05, residuals have remaining autocorrelations.</span>
<span id="cb107-559"><a href="#cb107-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-560"><a href="#cb107-560" aria-hidden="true" tabindex="-1"></a><span class="fu">### Forecast for the next 3 years using ARIMA(0,1,1)(0,1,1)</span></span>
<span id="cb107-561"><a href="#cb107-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-562"><a href="#cb107-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-563"><a href="#cb107-563" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb107-564"><a href="#cb107-564" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb107-565"><a href="#cb107-565" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">36</span>) <span class="sc">%&gt;%</span> <span class="fu">autoplot</span>() <span class="co">#next 3 years</span></span>
<span id="cb107-566"><a href="#cb107-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-567"><a href="#cb107-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-568"><a href="#cb107-568" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing ARIMA(0,1,1)(0,1,1) with benchmarks</span></span>
<span id="cb107-569"><a href="#cb107-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-570"><a href="#cb107-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-571"><a href="#cb107-571" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-572"><a href="#cb107-572" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb107-573"><a href="#cb107-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-574"><a href="#cb107-574" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(monthly_attacks_ts) <span class="sc">+</span></span>
<span id="cb107-575"><a href="#cb107-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">meanf</span>(monthly_attacks_ts, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb107-576"><a href="#cb107-576" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Mean"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-577"><a href="#cb107-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">naive</span>(monthly_attacks_ts, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb107-578"><a href="#cb107-578" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Naïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-579"><a href="#cb107-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">snaive</span>(monthly_attacks_ts, <span class="at">h=</span><span class="dv">36</span>),</span>
<span id="cb107-580"><a href="#cb107-580" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"SNaïve"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb107-581"><a href="#cb107-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">rwf</span>(monthly_attacks_ts, <span class="at">h=</span><span class="dv">36</span>, <span class="at">drift=</span><span class="cn">TRUE</span>),</span>
<span id="cb107-582"><a href="#cb107-582" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">PI=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb107-583"><a href="#cb107-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(<span class="fu">forecast</span>(fit,<span class="dv">36</span>), </span>
<span id="cb107-584"><a href="#cb107-584" aria-hidden="true" tabindex="-1"></a>            <span class="at">series=</span><span class="st">"fit"</span>,<span class="at">PI=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb107-585"><a href="#cb107-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Forecast"</span>))</span>
<span id="cb107-586"><a href="#cb107-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-587"><a href="#cb107-587" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best model metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-588"><a href="#cb107-588" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb107-589"><a href="#cb107-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-590"><a href="#cb107-590" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Snaive metrics: </span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb107-591"><a href="#cb107-591" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">snaive</span>(monthly_attacks_ts, <span class="at">h=</span><span class="dv">36</span>) </span>
<span id="cb107-592"><a href="#cb107-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-593"><a href="#cb107-593" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(f2)</span>
<span id="cb107-594"><a href="#cb107-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-595"><a href="#cb107-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-596"><a href="#cb107-596" aria-hidden="true" tabindex="-1"></a><span class="fu">### Seasonal Cross Validation of ARIMA(0,1,1)(0,1,1) and ARIMA(1,1,1)(0,1,1) using 1 step ahead forecasts </span></span>
<span id="cb107-597"><a href="#cb107-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-598"><a href="#cb107-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-599"><a href="#cb107-599" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">75</span> <span class="co"># minimum data length for fitting a model </span></span>
<span id="cb107-600"><a href="#cb107-600" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(monthly_attacks_ts)</span>
<span id="cb107-601"><a href="#cb107-601" aria-hidden="true" tabindex="-1"></a><span class="co">#n-k # rest of the observations</span></span>
<span id="cb107-602"><a href="#cb107-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-603"><a href="#cb107-603" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">133</span>)</span>
<span id="cb107-604"><a href="#cb107-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-605"><a href="#cb107-605" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">h=</span>h)}</span>
<span id="cb107-606"><a href="#cb107-606" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(monthly_attacks_ts, farima1, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb107-607"><a href="#cb107-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-608"><a href="#cb107-608" aria-hidden="true" tabindex="-1"></a>MAE1 <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb107-609"><a href="#cb107-609" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MAE for ARIMA(0,1,1)(0,1,1) is: "</span>, MAE1)</span>
<span id="cb107-610"><a href="#cb107-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-611"><a href="#cb107-611" aria-hidden="true" tabindex="-1"></a>RMSE1<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">mean</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="co">#one-step time series cross-validation</span></span>
<span id="cb107-612"><a href="#cb107-612" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RMSE for ARIMA(0,1,1)(0,1,1) is: "</span>, RMSE1)</span>
<span id="cb107-613"><a href="#cb107-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-614"><a href="#cb107-614" aria-hidden="true" tabindex="-1"></a>farima2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">h=</span>h)}</span>
<span id="cb107-615"><a href="#cb107-615" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(monthly_attacks_ts, farima2, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb107-616"><a href="#cb107-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-617"><a href="#cb107-617" aria-hidden="true" tabindex="-1"></a>MAE2 <span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">mean</span>(e,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb107-618"><a href="#cb107-618" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">MAE for ARIMA(1,1,1)(0,1,1) is: "</span>, MAE2)</span>
<span id="cb107-619"><a href="#cb107-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-620"><a href="#cb107-620" aria-hidden="true" tabindex="-1"></a>RMSE2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">mean</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="co">#one-step time series cross-validation</span></span>
<span id="cb107-621"><a href="#cb107-621" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">RMSE for ARIMA(1,1,1)(0,1,1) is: "</span>, RMSE2)</span>
<span id="cb107-622"><a href="#cb107-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-623"><a href="#cb107-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-624"><a href="#cb107-624" aria-hidden="true" tabindex="-1"></a>Both MAE and RMSE metrics agree that ARIMA(1,1,1)(0,1,1) is the best model by a slight margin. However, the BIC metric does not agree with this result as it outputted ARIMA(0,1,1)(0,1,1) as the model with lowest BIC. AIC and AICc metrics, however, do agree with the MAE and RMSE metrics generated from Seasonal Cross Validation using 1 step ahead forecasts. Let's see whether this is the case when forecasting 12 steps ahead.</span>
<span id="cb107-625"><a href="#cb107-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-626"><a href="#cb107-626" aria-hidden="true" tabindex="-1"></a><span class="fu">### Seasonal Cross Validation of ARIMA(0,1,1)(0,1,1) and ARIMA(1,1,1)(0,1,1) using 12 steps (seasonal period) ahead forecasts</span></span>
<span id="cb107-627"><a href="#cb107-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-628"><a href="#cb107-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb107-629"><a href="#cb107-629" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">75</span> <span class="co"># minimum data length for fitting a model </span></span>
<span id="cb107-630"><a href="#cb107-630" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(monthly_attacks_ts)</span>
<span id="cb107-631"><a href="#cb107-631" aria-hidden="true" tabindex="-1"></a>n<span class="sc">-</span>k <span class="co"># rest of the observations</span></span>
<span id="cb107-632"><a href="#cb107-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-633"><a href="#cb107-633" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">133</span>)</span>
<span id="cb107-634"><a href="#cb107-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-635"><a href="#cb107-635" aria-hidden="true" tabindex="-1"></a>farima1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">h=</span>h)}</span>
<span id="cb107-636"><a href="#cb107-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-637"><a href="#cb107-637" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb107-638"><a href="#cb107-638" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(monthly_attacks_ts, <span class="at">forecastfunction =</span> farima1, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb107-639"><a href="#cb107-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-640"><a href="#cb107-640" aria-hidden="true" tabindex="-1"></a>mse1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-641"><a href="#cb107-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-642"><a href="#cb107-642" aria-hidden="true" tabindex="-1"></a>farima2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, h){<span class="fu">forecast</span>(<span class="fu">Arima</span>(monthly_attacks_ts, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">seasonal=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)), <span class="at">h=</span>h)}</span>
<span id="cb107-643"><a href="#cb107-643" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cross-validated errors for up to 12 steps ahead</span></span>
<span id="cb107-644"><a href="#cb107-644" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tsCV</span>(monthly_attacks_ts, <span class="at">forecastfunction =</span> farima2, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb107-645"><a href="#cb107-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-646"><a href="#cb107-646" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the MSE values and remove missing values</span></span>
<span id="cb107-647"><a href="#cb107-647" aria-hidden="true" tabindex="-1"></a>mse2 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(e<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-648"><a href="#cb107-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-649"><a href="#cb107-649" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the MSE values against the forecast horizon</span></span>
<span id="cb107-650"><a href="#cb107-650" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">MSE1 =</span> mse1, <span class="at">MSE2 =</span> mse2) <span class="sc">%&gt;%</span></span>
<span id="cb107-651"><a href="#cb107-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>MSE1,<span class="at">x=</span> h)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>MSE2,<span class="at">x=</span> h)) <span class="sc">+</span></span>
<span id="cb107-652"><a href="#cb107-652" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>MSE1,<span class="at">x=</span> h,<span class="at">colour=</span><span class="st">"MSE for ARIMA(0,1,1)(0,1,1)"</span>)) <span class="sc">+</span> </span>
<span id="cb107-653"><a href="#cb107-653" aria-hidden="true" tabindex="-1"></a>           <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>MSE2,<span class="at">x=</span> h,<span class="at">colour=</span><span class="st">"MSE for ARIMA(1,1,1)(0,1,1)"</span>))<span class="sc">+</span></span>
<span id="cb107-654"><a href="#cb107-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb107-655"><a href="#cb107-655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb107-656"><a href="#cb107-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-657"><a href="#cb107-657" aria-hidden="true" tabindex="-1"></a>This plot gives cross-validation statistics up to horizon 12. The procedure for seasonal cross validation using 12 steps ahead is very similar to seasonal cross validation using 1 step ahead. We need to change the "h" parameter to the desired the number of time horizons we want to forecast for. The <span class="in">`farima()`</span> function manually written by us helps us call our desired SARIMA model with the number of horizons. Then, <span class="in">`farima()`</span> function is called inside the <span class="in">`tsCV()`</span> function, which helps us store the cross-validated errors for up to 12 steps ahead. Then, because we get forecasts for each time horizon, we need to take the mean of the squared column using <span class="in">`colMeans`</span> to obtain MSE. </span>
<span id="cb107-658"><a href="#cb107-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-659"><a href="#cb107-659" aria-hidden="true" tabindex="-1"></a>Although we observed that the MSE and RMSE of ARIMA(1,1,1)(0,1,1) when forecasting 1 step ahead was lower than that of ARIMA(0,1,1)(0,1,1), from the above plot it can be seen that the cross-validated MSEs get lower or better as the number of forecasting steps increases. Both models' MSE performance follow a very similar pattern, with ARIMA(0,1,1)(0,1,1), picked by lowest BIC, having a lower MSE across all forecasting steps, except for step 1. Therefore, ARIMA(0,1,1)(0,1,1) is the better SARIMA model!</span>
<span id="cb107-660"><a href="#cb107-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-661"><a href="#cb107-661" aria-hidden="true" tabindex="-1"></a><span class="fu">## Section Code</span></span>
<span id="cb107-662"><a href="#cb107-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-663"><a href="#cb107-663" aria-hidden="true" tabindex="-1"></a>**Code for this section can be found [here](https://github.com/TegveerG/Time-Series-Project/blob/main/Time%20Series%20Analysis/ARMA-ARIMA-SARIMA.qmd)**</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>