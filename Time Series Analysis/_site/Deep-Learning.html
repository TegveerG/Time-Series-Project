<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ANLY560 Time Series Project - Tegveer Ghura - Deep Learning for Time Series</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.20.0.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Deep Learning for Time Series</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ANLY560 Time Series Project - Tegveer Ghura</a> 
        <div class="sidebar-tools-main">
    <a href="https://www.linkedin.com/in/tegveerg/" title="" class="sidebar-tool px-1"><i class="bi bi-linkedin"></i></a>
    <a href="" title="" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-github"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/TegveerG/Time-Series-Project">
          Source Code
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">About Tegveer</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data-Sources.html" class="sidebar-item-text sidebar-link">Data Sources</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data-Visualization.html" class="sidebar-item-text sidebar-link">Data Visualization</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Exploratory-Data-Analysis.html" class="sidebar-item-text sidebar-link">Exploratory Data Analysis</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ARMA-ARIMA-SARIMA.html" class="sidebar-item-text sidebar-link">ARMA/ARIMA/SARIMA Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ARIMAX-SARIMAX-VAR.html" class="sidebar-item-text sidebar-link">ARIMAX/SARIMAX/VAR Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Financial-Models.html" class="sidebar-item-text sidebar-link">Financial Time Series Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Deep-Learning.html" class="sidebar-item-text sidebar-link active">Deep Learning for TS</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Conclusion.html" class="sidebar-item-text sidebar-link">Conclusion</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#overall-training-parameter-methodology" id="toc-overall-training-parameter-methodology" class="nav-link" data-scroll-target="#overall-training-parameter-methodology">Overall Training Parameter Methodology</a></li>
  <li><a href="#read-in-data-and-normalize" id="toc-read-in-data-and-normalize" class="nav-link" data-scroll-target="#read-in-data-and-normalize">Read in Data and Normalize</a></li>
  <li><a href="#training-and-evaluating-a-simple-rnn" id="toc-training-and-evaluating-a-simple-rnn" class="nav-link" data-scroll-target="#training-and-evaluating-a-simple-rnn">Training and Evaluating a Simple RNN</a>
  <ul class="collapse">
  <li><a href="#model-and-training-parameters" id="toc-model-and-training-parameters" class="nav-link" data-scroll-target="#model-and-training-parameters">Model and Training Parameters</a></li>
  <li><a href="#create-simple-rnn-model" id="toc-create-simple-rnn-model" class="nav-link" data-scroll-target="#create-simple-rnn-model">Create Simple RNN Model</a></li>
  <li><a href="#train-model-and-visualize-performance" id="toc-train-model-and-visualize-performance" class="nav-link" data-scroll-target="#train-model-and-visualize-performance">Train Model and Visualize Performance</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  </ul></li>
  <li><a href="#training-and-evaluating-a-simple-rnn-with-l2-regularization" id="toc-training-and-evaluating-a-simple-rnn-with-l2-regularization" class="nav-link" data-scroll-target="#training-and-evaluating-a-simple-rnn-with-l2-regularization">Training and Evaluating a Simple RNN with L2 Regularization</a>
  <ul class="collapse">
  <li><a href="#model-and-training-parameters-1" id="toc-model-and-training-parameters-1" class="nav-link" data-scroll-target="#model-and-training-parameters-1">Model and Training Parameters</a></li>
  <li><a href="#create-simple-rnn-model-with-l2-regularization" id="toc-create-simple-rnn-model-with-l2-regularization" class="nav-link" data-scroll-target="#create-simple-rnn-model-with-l2-regularization">Create Simple RNN Model With L2 Regularization</a></li>
  <li><a href="#train-model-and-visualize-performance-1" id="toc-train-model-and-visualize-performance-1" class="nav-link" data-scroll-target="#train-model-and-visualize-performance-1">Train Model and Visualize Performance</a></li>
  <li><a href="#discussion-1" id="toc-discussion-1" class="nav-link" data-scroll-target="#discussion-1">Discussion</a></li>
  </ul></li>
  <li><a href="#training-and-evaluating-a-gru-with-l2-regularization" id="toc-training-and-evaluating-a-gru-with-l2-regularization" class="nav-link" data-scroll-target="#training-and-evaluating-a-gru-with-l2-regularization">Training and Evaluating a GRU with L2 Regularization</a>
  <ul class="collapse">
  <li><a href="#model-and-training-parameters-2" id="toc-model-and-training-parameters-2" class="nav-link" data-scroll-target="#model-and-training-parameters-2">Model and Training Parameters</a></li>
  <li><a href="#create-gru-model-with-l2-regularization" id="toc-create-gru-model-with-l2-regularization" class="nav-link" data-scroll-target="#create-gru-model-with-l2-regularization">Create GRU Model With L2 Regularization</a></li>
  <li><a href="#train-model-and-visualize-performance-2" id="toc-train-model-and-visualize-performance-2" class="nav-link" data-scroll-target="#train-model-and-visualize-performance-2">Train Model and Visualize Performance</a></li>
  <li><a href="#discussion-2" id="toc-discussion-2" class="nav-link" data-scroll-target="#discussion-2">Discussion</a></li>
  </ul></li>
  <li><a href="#training-and-evaluating-a-bidirectional-gru" id="toc-training-and-evaluating-a-bidirectional-gru" class="nav-link" data-scroll-target="#training-and-evaluating-a-bidirectional-gru">Training and Evaluating a Bidirectional GRU</a>
  <ul class="collapse">
  <li><a href="#model-and-training-parameters-3" id="toc-model-and-training-parameters-3" class="nav-link" data-scroll-target="#model-and-training-parameters-3">Model and Training Parameters</a></li>
  <li><a href="#create-bidirectional-gru" id="toc-create-bidirectional-gru" class="nav-link" data-scroll-target="#create-bidirectional-gru">Create Bidirectional GRU</a></li>
  <li><a href="#train-model-and-visualize-performance-3" id="toc-train-model-and-visualize-performance-3" class="nav-link" data-scroll-target="#train-model-and-visualize-performance-3">Train Model and Visualize Performance</a></li>
  <li><a href="#discussion-3" id="toc-discussion-3" class="nav-link" data-scroll-target="#discussion-3">Discussion</a></li>
  </ul></li>
  <li><a href="#training-and-evaluating-a-stacked-bidirectional-gru-with-l2-regularization" id="toc-training-and-evaluating-a-stacked-bidirectional-gru-with-l2-regularization" class="nav-link" data-scroll-target="#training-and-evaluating-a-stacked-bidirectional-gru-with-l2-regularization">Training and Evaluating a Stacked Bidirectional GRU with L2 Regularization</a>
  <ul class="collapse">
  <li><a href="#model-and-training-parameters-4" id="toc-model-and-training-parameters-4" class="nav-link" data-scroll-target="#model-and-training-parameters-4">Model and Training Parameters</a></li>
  <li><a href="#create-stacked-bidirectional-gru-with-l2-regularization" id="toc-create-stacked-bidirectional-gru-with-l2-regularization" class="nav-link" data-scroll-target="#create-stacked-bidirectional-gru-with-l2-regularization">Create Stacked Bidirectional GRU with L2 Regularization</a></li>
  <li><a href="#train-model-and-visualize-performance-4" id="toc-train-model-and-visualize-performance-4" class="nav-link" data-scroll-target="#train-model-and-visualize-performance-4">Train Model and Visualize Performance</a></li>
  <li><a href="#discussion-4" id="toc-discussion-4" class="nav-link" data-scroll-target="#discussion-4">Discussion</a></li>
  </ul></li>
  <li><a href="#training-and-evaluating-a-bidirectional-lstm" id="toc-training-and-evaluating-a-bidirectional-lstm" class="nav-link" data-scroll-target="#training-and-evaluating-a-bidirectional-lstm">Training and Evaluating a Bidirectional LSTM</a>
  <ul class="collapse">
  <li><a href="#model-and-training-parameters-5" id="toc-model-and-training-parameters-5" class="nav-link" data-scroll-target="#model-and-training-parameters-5">Model and Training Parameters</a></li>
  <li><a href="#create-bidirectional-lstm" id="toc-create-bidirectional-lstm" class="nav-link" data-scroll-target="#create-bidirectional-lstm">Create Bidirectional LSTM</a></li>
  <li><a href="#train-model-and-visualize-performance-5" id="toc-train-model-and-visualize-performance-5" class="nav-link" data-scroll-target="#train-model-and-visualize-performance-5">Train Model and Visualize Performance</a></li>
  <li><a href="#discussion-5" id="toc-discussion-5" class="nav-link" data-scroll-target="#discussion-5">Discussion</a></li>
  </ul></li>
  <li><a href="#training-and-evaluating-a-bidirectional-lstm-with-l2-regularization" id="toc-training-and-evaluating-a-bidirectional-lstm-with-l2-regularization" class="nav-link" data-scroll-target="#training-and-evaluating-a-bidirectional-lstm-with-l2-regularization">Training and Evaluating a Bidirectional LSTM with L2 Regularization</a>
  <ul class="collapse">
  <li><a href="#model-and-training-parameters-6" id="toc-model-and-training-parameters-6" class="nav-link" data-scroll-target="#model-and-training-parameters-6">Model and Training Parameters</a></li>
  <li><a href="#create-bidirectional-lstm-with-l2-regularization" id="toc-create-bidirectional-lstm-with-l2-regularization" class="nav-link" data-scroll-target="#create-bidirectional-lstm-with-l2-regularization">Create Bidirectional LSTM with L2 Regularization</a></li>
  <li><a href="#train-model-and-visualize-performance-6" id="toc-train-model-and-visualize-performance-6" class="nav-link" data-scroll-target="#train-model-and-visualize-performance-6">Train Model and Visualize Performance</a></li>
  <li><a href="#discussion-6" id="toc-discussion-6" class="nav-link" data-scroll-target="#discussion-6">Discussion</a></li>
  </ul></li>
  <li><a href="#final-results-table" id="toc-final-results-table" class="nav-link" data-scroll-target="#final-results-table">Final Results Table</a></li>
  <li><a href="#how-far-into-the-future-can-we-predict" id="toc-how-far-into-the-future-can-we-predict" class="nav-link" data-scroll-target="#how-far-into-the-future-can-we-predict">How Far Into The Future Can We Predict?</a>
  <ul class="collapse">
  <li><a href="#simple-rnn-with-l2-regularization" id="toc-simple-rnn-with-l2-regularization" class="nav-link" data-scroll-target="#simple-rnn-with-l2-regularization">Simple RNN with L2 Regularization</a></li>
  <li><a href="#gru-with-l2-regularization" id="toc-gru-with-l2-regularization" class="nav-link" data-scroll-target="#gru-with-l2-regularization">GRU with L2 Regularization</a></li>
  <li><a href="#bidirectional-lstm-no-regularization" id="toc-bidirectional-lstm-no-regularization" class="nav-link" data-scroll-target="#bidirectional-lstm-no-regularization">Bidirectional LSTM (no regularization)</a></li>
  <li><a href="#discussion-7" id="toc-discussion-7" class="nav-link" data-scroll-target="#discussion-7">Discussion</a></li>
  </ul></li>
  <li><a href="#comparison-with-arima-and-sarima" id="toc-comparison-with-arima-and-sarima" class="nav-link" data-scroll-target="#comparison-with-arima-and-sarima">Comparison with ARIMA and SARIMA</a>
  <ul class="collapse">
  <li><a href="#section-code" id="toc-section-code" class="nav-link" data-scroll-target="#section-code">Section Code</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Deep Learning for Time Series</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="summary" class="level1">
<h1>Summary</h1>
<p>After fitting several time-series models to both monthly as well as yearly aggregated terrorist attacks data and financial data in the previous sections, we will now focus on the efficacy of Deep Learning models in helping us predict the monthly number of terrorist attacks, the same univariate time-series data employed in the <a href="https://tegveerg.georgetown.domains/Time-Series-Project/ARMA-ARIMA-SARIMA.html">ARMA/ARIMA/SARIMA section</a>. We shall employ popular Recurrent Neural Networks (RNNs), including a Dense RNN, a Gated Recurrent Unit (GRU), and a Long Short-Term Memory Network (LSTM), with and without L2 regularization, a method to curb overfitting by forcing the weights of the parameters to decay towards zero, to predict the number number of terrorist attacks per month in the future. Doing so will help us compare not only the performance of the three RNNs, but also the performance of the three RNNs to that of the traditional univariate time-series models, ARIMA and SARIMA. Lastly, we shall discuss the effect of regularization on the results of our RNNs, assess how far into the future the RNNs can accurately predict the future, and compare the results of the trained deep learning models to the traditional single-variable time-series ARMA/ARIMA models.</p>
<p>To train these models, we use Python’s <em>Keras</em> library, a wrapper for <em>Tensorflow</em> and take inspiration from Francois Chollet’s Deep Learning in Python, Second Edition, Book <span class="citation" data-cites="chollet2021deep">(<a href="#ref-chollet2021deep" role="doc-biblioref">Chollet 2021</a>)</span>. Visualizations of the architecture of a simple RNN and LSTM are shown below:</p>
<p><img src="RNN_Chollet.png" class="img-fluid"></p>
<center>
<em>A simple RNN, unrolled over time</em>
</center>
<p><br>
&nbsp;</p>
<p><img src="LSTM_Chollet.png" class="img-fluid"></p>
<center>
<em>Anatomy of an LSTM</em>
</center>
<p><br>
&nbsp;</p>
</section>
<section id="overall-training-parameter-methodology" class="level1">
<h1>Overall Training Parameter Methodology</h1>
<p>These are the parameters that are used to define and train the models:</p>
<ol type="1">
<li><p><code>recurrent_hidden_units</code>: This is the number of recurrent hidden units in the Simple RNN layer of the model. The more hidden units, the more complex the model can be and the more features it can potentially learn. However, increasing the number of hidden units also increases the number of parameters in the model and can lead to overfitting.</p></li>
<li><p><code>epochs</code>: This is the number of times the model is trained on the entire training dataset. Each epoch consists of one forward pass and one backward pass through the model. The default value of 100 epochs is used for all models.</p></li>
<li><p><code>f_batch</code>: This is the fraction of the training dataset that is used for each batch during training. Batches are used to update the model parameters more frequently and efficiently than training on the entire dataset at once. The value of f_batch is multiplied by the total number of samples in the training dataset to determine the batch size and we shall be using a default value of 20% or 0.2.</p></li>
<li><p><code>optimizer</code>: This is the optimization algorithm used to update the model parameters during training. The RMSprop optimizer is a popular choice for deep learning tasks that involve recurrent neural networks. Other state-of-the-art optimizers include Adam and Nadam. RMSprop is used for all models.</p></li>
<li><p><code>validation_split</code>: This is the fraction of the training dataset that is used for validation during training. The validation dataset is used to monitor the performance of the model during training and to prevent overfitting. A value of 0.2 for validation_split means that 20% of the training data will be held out for validation, and the remaining 80% will be used for training.</p></li>
<li><p><code>activation</code>: This is the activation function used for the recurrent hidden units in the model. The vanishing gradient problem is the primary problem in RNNs. To ensure the gradients stay in the linear region of the activation function, we need a function whose second derivative can sustain for a long range before going to zero. <code>tanh</code>, as a result, satisfies these properties better than <code>ReLU</code> activation does. The Rectified Linear Unit (ReLU) activation function is unbounded on the positive side, meaning that its output can take any positive value. The hyperbolic tangent (tanh) activation function, however, is bounded both on the positive and negative sides. Note: Only for the Bidirectional LSTM model, we use <code>ReLU</code> activation for the recurrent hidden units.</p></li>
</ol>
</section>
<section id="read-in-data-and-normalize" class="level1">
<h1>Read in Data and Normalize</h1>
<p>When working with Deep Learning models, it is advisable to scale our features to a range of values, for example 0-1 range <span class="citation" data-cites="chollet2021deep">(<a href="#ref-chollet2021deep" role="doc-biblioref">Chollet 2021</a>)</span>. Even though our exercise focuses on univariate data, it is still imperative to normalize the monthly count of terrorist attacks. In general, it isn’t safe to feed into a neural network data that takes relatively large values or data that is heterogeneous. Doing so can trigger large gradient updates that will prevent the network from converging. To make learning easier for our network, the the univariate monthly number of attacks data should take small values. Typically, most values should be in the 0–1 range.</p>
<p>Essentially, advantages of normalizing the features include:</p>
<ol type="1">
<li><p>Prevents issues with vanishing or exploding gradients: When the input features to a neural network have very different scales, it can cause issues with the gradients during backpropagation. If some features have very large values and others have very small values, the gradients for the small features can become very small, or even zero, which can slow down or prevent the convergence of the optimization process.</p></li>
<li><p>Helps to optimize the model more efficiently: When the input features are normalized, it can help to improve the optimization process by ensuring that the gradients are more consistent across all of the features. This can help to prevent the optimization process from getting stuck in local minima and can lead to faster convergence.</p></li>
<li><p>Improves generalization: Normalizing the features can help to improve the generalization performance of the neural network by reducing the effects of outliers or extreme values in the input features. By scaling the features to a similar range, the neural network is less likely to overfit to extreme values in the training set and is more likely to generalize well to unseen data.</p></li>
</ol>
<div class="cell" data-execution_count="2">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in data and convert to numpy array</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">"univariate_train.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">"univariate_test.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> np.array(train.astype(<span class="st">'float32'</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> np.array(test.astype(<span class="st">'float32'</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize values</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> scaler.fit_transform(train_data).flatten()</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> scaler.fit_transform(test_data).flatten()</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Train Data Shape: "</span>, train_data.shape)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test Data Shape: "</span>, test_data.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Train Data Shape:  (587,)
Test Data Shape:  (25,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PREPARE THE INPUT X AND TARGET Y</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"testX shape:"</span>, testX.shape, <span class="st">"testY shape:"</span>, testY.shape)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"trainX shape:"</span>, trainX.shape, <span class="st">"trainY shape:"</span>, trainY.shape)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(trainX))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>testX shape: (2, 9, 1) testY shape: (2,)
trainX shape: (58, 9, 1) trainY shape: (58,)
&lt;class 'numpy.ndarray'&gt;</code></pre>
</div>
</div>
</section>
<section id="training-and-evaluating-a-simple-rnn" class="level1">
<h1>Training and Evaluating a Simple RNN</h1>
<p>A recurrent neural network (RNN) processes sequences by iterating through the sequence elements and maintaining a state that contains information relative to what it has seen so far. In effect, an RNN is a type of neural network that has an internal loop. The state of the RNN is reset between processing two different, independent sequences (such as two samples in a batch), so we still consider one sequence to be a single data point: a single input to the network. What changes is that this data point is no longer processed in a single step; rather, the network internally loops over sequence elements. In summary, an RNN is a for loop that reuses quantities computed during the previous iteration of the loop, nothing more. <span class="citation" data-cites="chollet2021deep">(<a href="#ref-chollet2021deep" role="doc-biblioref">Chollet 2021</a>)</span></p>
<section id="model-and-training-parameters" class="level2">
<h2 class="anchored" data-anchor-id="model-and-training-parameters">Model and Training Parameters</h2>
<p>The input to the model is a 3D tensor with shape (batch_size, timesteps, input_dim). The output of the RNN layer is fed into a Dense layer with a single output unit, which is used to generate a scalar output.</p>
<div class="cell" data-execution_count="5">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-simple-rnn-model" class="level2">
<h2 class="anchored" data-anchor-id="create-simple-rnn-model">Create Simple RNN Model</h2>
<div class="cell" data-execution_count="6">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>model.add(SimpleRNN(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Metal device set to: Apple M1 Pro</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:48:08.896038: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:305] Could not identify NUMA node of platform GPU ID 0, defaulting to 0. Your kernel may not have been built with NUMA support.
2023-05-10 18:48:08.896475: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:271] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 0 MB memory) -&gt; physical PluggableDevice (device: 0, name: METAL, pci bus id: &lt;undefined&gt;)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> simple_rnn (SimpleRNN)      (None, 3)                 15        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense (Dense)               (None, 1)                 4         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 19</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 19</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="train-model-and-visualize-performance" class="level2">
<h2 class="anchored" data-anchor-id="train-model-and-visualize-performance">Train Model and Visualize Performance</h2>
<div class="cell" data-execution_count="7">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:48:09.942863: W tensorflow/core/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:48:10.323341: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:48:12.888176: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Visualize Fitting History</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Visualize Parity Plot (Unnormalized Data)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Visualize Predictions (Unnormalized Data)</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-execution_count="8">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 0s 26ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 24ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00645 RMSE = 0.08030
Test MSE = 0.12927 RMSE = 0.35955</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="29bc0d75-31f7-41da-b30e-7f8d564c525e" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("29bc0d75-31f7-41da-b30e-7f8d564c525e")) {                    Plotly.newPlot(                        "29bc0d75-31f7-41da-b30e-7f8d564c525e",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[0.07263462245464325,0.062016330659389496,0.05682498589158058,0.051882628351449966,0.04995761811733246,0.04799173027276993,0.04552900791168213,0.04361193999648094,0.04165535420179367,0.04007318243384361,0.03847019746899605,0.037025462836027145,0.035913098603487015,0.034934744238853455,0.0339868888258934,0.03279578313231468,0.032069552689790726,0.03127305209636688,0.03019394539296627,0.02939797006547451,0.028557617217302322,0.028043104335665703,0.02750496007502079,0.026882337406277657,0.026297667995095253,0.025788497179746628,0.025337839499115944,0.02467881143093109,0.024128524586558342,0.023628169670701027,0.023076964542269707,0.022572634741663933,0.022016538307070732,0.021629180759191513,0.021139871329069138,0.02088908478617668,0.020478319376707077,0.020130928605794907,0.019833512604236603,0.019361242651939392,0.0189983993768692,0.018649674952030182,0.01843293569982052,0.017886869609355927,0.01756724901497364,0.017136787995696068,0.017004461959004402,0.016811564564704895,0.01669301837682724,0.01633116416633129,0.016102487221360207,0.015883732587099075,0.015606706961989403,0.01537251379340887,0.015114177949726582,0.014839735813438892,0.014683985151350498,0.014355934225022793,0.014073526486754417,0.013727468438446522,0.013638137839734554,0.013517970219254494,0.013486197218298912,0.013219095766544342,0.013010147027671337,0.012802666053175926,0.012607895769178867,0.012440674006938934,0.012195643037557602,0.01192646287381649,0.011795362457633018,0.011661241762340069,0.011449962854385376,0.011276897974312305,0.011078441515564919,0.010949770919978619,0.010761285200715065,0.010588107630610466,0.010445211082696915,0.010228217579424381,0.0101012596860528,0.009940429590642452,0.009742612950503826,0.0095833046361804,0.009464064612984657,0.00928318127989769,0.009127356112003326,0.00901380181312561,0.008847319521009922,0.008681601844727993,0.008542393334209919,0.008396349847316742,0.008179672062397003,0.007995775900781155,0.007895315997302532,0.0077515048906207085,0.007660761941224337,0.0075282747857272625,0.007407366763800383,0.0072869956493377686],"yaxis":"y","type":"scatter"},{"mode":"lines","name":"Training","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.012459572404623032,0.010447158478200436,0.008602366782724857,0.008020217530429363,0.007535131182521582,0.007050300482660532,0.006768465042114258,0.006589293945580721,0.006529154255986214,0.006601835135370493,0.006691675633192062,0.006635475903749466,0.006656526122242212,0.006600840482860804,0.006817915942519903,0.006715050432831049,0.0069661736488342285,0.007139062508940697,0.007180739194154739,0.007679735776036978,0.007663882803171873,0.0073504094034433365,0.007333636749535799,0.007229721173644066,0.007004121784120798,0.007152302656322718,0.007261256221681833,0.007226692046970129,0.006870164070278406,0.006471980828791857,0.006429955363273621,0.006823804695159197,0.006666064262390137,0.006994759198278189,0.0068010916002094746,0.006602409761399031,0.006389223039150238,0.0061098127625882626,0.00613509863615036,0.006346666719764471,0.006523007061332464,0.006269523873925209,0.006359955761581659,0.006530325394123793,0.006761092692613602,0.0065216305665671825,0.0063328524120152,0.006533531937748194,0.006781173404306173,0.006522346753627062,0.006150929722934961,0.006310252007097006,0.006194351240992546,0.005819214973598719,0.00581391854211688,0.0057050324976444244,0.0053985510021448135,0.005303106736391783,0.005583222955465317,0.005537493620067835,0.005526429507881403,0.00551374489441514,0.005492068361490965,0.0054906508885324,0.0054588173516094685,0.005241388455033302,0.0050958204083144665,0.004918176215142012,0.005170885473489761,0.005175274331122637,0.004998767748475075,0.005197441671043634,0.005001502577215433,0.0051439194940030575,0.005195089615881443,0.005049304571002722,0.0048686545342206955,0.004672580864280462,0.00453361589461565,0.004468320403248072,0.0044881501235067844,0.004315817262977362,0.004178470466285944,0.0040427446365356445,0.004009061027318239,0.003942845854908228,0.003841284429654479,0.0039040681440383196,0.003927850164473057,0.0038867853581905365,0.0038949381560087204,0.004150157794356346,0.004291393794119358,0.0041060978546738625,0.004000070970505476,0.004015197046101093,0.00392049690708518,0.0038818896282464266,0.0037705302238464355,0.003587238257750869],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Training Epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training Loss (Red) vs Validation Loss (Blue)"},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('29bc0d75-31f7-41da-b30e-7f8d564c525e');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-execution_count="9">
<div class="cell-output cell-output-display">

<div>                            <div id="94baadca-edd2-4237-81e9-e7349bc7f570" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("94baadca-edd2-4237-81e9-e7349bc7f570")) {                    Plotly.newPlot(                        "94baadca-edd2-4237-81e9-e7349bc7f570",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"xaxis":"x","y":[-0.3256431818008423,0.046816229820251465,2.0474658012390137,2.1394238471984863,2.334993839263916,1.3592288494110107,0.6960784196853638,2.7143187522888184,1.5930812358856201,2.4878416061401367,2.495758295059204,2.166386127471924,1.7353968620300293,1.9991613626480103,2.605684518814087,2.2957043647766113,2.260169267654419,1.354880690574646,2.141883373260498,2.333441734313965,2.510425090789795,2.2037105560302734,2.0332202911376953,1.905735969543457,2.3736846446990967,2.3770883083343506,2.4076457023620605,2.146167278289795,2.411975145339966,1.6393277645111084,2.5994653701782227,2.2044076919555664,2.411390542984009,2.156742572784424,2.6049797534942627,2.565066337585449,2.2261157035827637,2.412250518798828,2.3922972679138184,2.2685980796813965,2.1868271827697754,2.217400550842285,2.292713165283203,2.41144061088562,2.232349157333374,2.236586570739746,2.3008041381835938,2.285738229751587,2.1659111976623535,2.3310461044311523,2.224884510040283,1.8658219575881958,2.380500316619873,2.281587600708008,2.448580026626587,1.7972298860549927,2.3736660480499268,2.203416347503662],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[2.0,10.0],"y":[2.8140459060668945,1.9052327871322632],"type":"scatter"},{"mode":"lines","x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"y":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('94baadca-edd2-4237-81e9-e7349bc7f570');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<p><img src="Deep-Learning_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<div class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<p>The train RMSE (Root Mean Squared Error) outputted by the Simple RNN model is 0.08 and test RMSE is 0.36</p>
</div>
</div>
<p>The parity plot provides further evidence of the model’s accuracy and suggests that the model’s performance is better for smaller Y values, as the deviation from the line increases for larger Y values. This is likely due to the fact that the model is trained on a larger number of smaller Y values (the data contains a lot of 0 values), and thus is better at predicting smaller Y values. The <em>Visualize Predictions</em> plot shows that the model is able to predict the general trend of the data, and is able to predict the peaks and valleys of the data. The model does, to an extent, capture the seasonality of the data but not completely, implying overfitting! Let’s see if we can improve the model’s performance by adding L2 regularization.</p>
</section>
</section>
<section id="training-and-evaluating-a-simple-rnn-with-l2-regularization" class="level1">
<h1>Training and Evaluating a Simple RNN with L2 Regularization</h1>
<section id="model-and-training-parameters-1" class="level2">
<h2 class="anchored" data-anchor-id="model-and-training-parameters-1">Model and Training Parameters</h2>
<div class="cell" data-execution_count="13">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-simple-rnn-model-with-l2-regularization" class="level2">
<h2 class="anchored" data-anchor-id="create-simple-rnn-model-with-l2-regularization">Create Simple RNN Model With L2 Regularization</h2>
<div class="cell" data-execution_count="14">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>model.add(SimpleRNN(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> simple_rnn_1 (SimpleRNN)    (None, 3)                 15        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_1 (Dense)             (None, 1)                 4         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 19</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 19</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="train-model-and-visualize-performance-1" class="level2">
<h2 class="anchored" data-anchor-id="train-model-and-visualize-performance-1">Train Model and Visualize Performance</h2>
<div class="cell" data-execution_count="15">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:48:41.518529: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:48:42.180872: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Visualize Fitting History</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Visualize Parity Plot (Unnormalized Data)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Visualize Predictions (Unnormalized Data)</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-execution_count="16">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 0s 21ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 25ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00239 RMSE = 0.04887
Test MSE = 0.05031 RMSE = 0.22430</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="d6537b32-b9e4-4501-b191-1bb0e9a5153b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d6537b32-b9e4-4501-b191-1bb0e9a5153b")) {                    Plotly.newPlot(                        "d6537b32-b9e4-4501-b191-1bb0e9a5153b",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[0.03990870341658592,0.03885868936777115,0.03798636794090271,0.03741908073425293,0.03668670728802681,0.036245740950107574,0.03562667593359947,0.035124365240335464,0.03459346666932106,0.03398119658231735,0.0334601104259491,0.032944776117801666,0.03236323967576027,0.031868092715740204,0.03127403184771538,0.03076167218387127,0.03031674213707447,0.029811814427375793,0.029362764209508896,0.028940578922629356,0.028521068394184113,0.02799428626894951,0.02764994464814663,0.027115093544125557,0.026692315936088562,0.026218460872769356,0.025806328281760216,0.025353696197271347,0.02491750754415989,0.024492861703038216,0.024146445095539093,0.023775827139616013,0.023400962352752686,0.02299315482378006,0.022676333785057068,0.02225329354405403,0.021840225905179977,0.021505938842892647,0.02114979363977909,0.02079358883202076,0.020449215546250343,0.02020845003426075,0.019789651036262512,0.019441815093159676,0.019113793969154358,0.018819397315382957,0.01848285086452961,0.01815236173570156,0.01787903532385826,0.017558155581355095,0.01726890169084072,0.016935300081968307,0.016631552949547768,0.016363145783543587,0.01602507196366787,0.015801990404725075,0.015461133792996407,0.015202810056507587,0.014904078096151352,0.014643245376646519,0.01435448694974184,0.014107832685112953,0.013806515373289585,0.013567958027124405,0.01333779376000166,0.01308746449649334,0.012881296686828136,0.012639121152460575,0.012355240993201733,0.012114121578633785,0.0118716387078166,0.011673616245388985,0.011430270969867706,0.011209007352590561,0.011036605574190617,0.010797684080898762,0.010585143230855465,0.010388689115643501,0.010164307430386543,0.009968077763915062,0.00977039523422718,0.009593530558049679,0.009387255646288395,0.009216460399329662,0.009099673479795456,0.008879230357706547,0.008758174255490303,0.008566120639443398,0.008386991918087006,0.008235492743551731,0.008110237307846546,0.007956585846841335,0.007788828108459711,0.007675008848309517,0.007491658441722393,0.007420773152261972,0.007277622818946838,0.007094203028827906,0.006956365890800953,0.00682881148532033],"yaxis":"y","type":"scatter"},{"mode":"lines","name":"Training","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.032274991273880005,0.03173622116446495,0.03131512925028801,0.03081151656806469,0.030430728569626808,0.030068540945649147,0.029693851247429848,0.02929985709488392,0.028911486268043518,0.02850925177335739,0.028157072141766548,0.027729876339435577,0.027336126193404198,0.026896489784121513,0.02648356556892395,0.026102259755134583,0.02575029619038105,0.02538631111383438,0.0250551700592041,0.024692140519618988,0.02434305101633072,0.023942500352859497,0.02363121695816517,0.023205267265439034,0.022894324734807014,0.022532986477017403,0.022158430889248848,0.021711327135562897,0.0213922169059515,0.02106991969048977,0.020761338993906975,0.020426154136657715,0.020077018067240715,0.019732968881726265,0.01941879652440548,0.01903619058430195,0.018725303933024406,0.01841052621603012,0.018113207072019577,0.01781797595322132,0.01747896708548069,0.017212888225913048,0.01687389798462391,0.016583701595664024,0.016285531222820282,0.01601252518594265,0.015767771750688553,0.015529680997133255,0.015219173394143581,0.014959358610212803,0.014667168259620667,0.014323110692203045,0.01406130287796259,0.013801686465740204,0.013526412658393383,0.013261090964078903,0.013018771074712276,0.012773893773555756,0.01250158529728651,0.012261773459613323,0.012087986804544926,0.011811614967882633,0.011600379832088947,0.011459693312644958,0.011256620287895203,0.011006977409124374,0.010709843598306179,0.010448667220771313,0.010226861573755741,0.010008120909333229,0.009878511540591717,0.009618166834115982,0.009409361518919468,0.009262394160032272,0.009069337509572506,0.008820551447570324,0.008707634173333645,0.008539032191038132,0.008284172974526882,0.008208285085856915,0.008019634522497654,0.007792289834469557,0.007687377277761698,0.007625248283147812,0.007346680853515863,0.007217738777399063,0.007133118808269501,0.006903193425387144,0.006726032588630915,0.0066340272314846516,0.006550278980284929,0.006354793440550566,0.006127267610281706,0.0060534048825502396,0.005998851731419563,0.005924208089709282,0.005665853153914213,0.0054939561523497105,0.005442166700959206,0.005279771517962217],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Training Epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training Loss (Red) vs Validation Loss (Blue)"},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d6537b32-b9e4-4501-b191-1bb0e9a5153b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-execution_count="17">
<div class="cell-output cell-output-display">

<div>                            <div id="7e73020a-126e-44ef-9036-e6b26b18b8b4" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("7e73020a-126e-44ef-9036-e6b26b18b8b4")) {                    Plotly.newPlot(                        "7e73020a-126e-44ef-9036-e6b26b18b8b4",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"xaxis":"x","y":[4.768779754638672,4.901568412780762,2.022758722305298,2.058410882949829,1.99383544921875,3.6238765716552734,4.109036445617676,1.8537406921386719,2.309516191482544,2.006124258041382,2.167872667312622,2.3640284538269043,2.2829501628875732,2.1679959297180176,2.1538851261138916,1.8842051029205322,1.9230601787567139,2.5196375846862793,2.207796335220337,1.6808480024337769,1.798601746559143,1.5866719484329224,1.9885401725769043,2.2105965614318848,1.6508238315582275,1.6802468299865723,1.771265983581543,2.0273385047912598,1.7108359336853027,2.8087406158447266,1.8714797496795654,1.9815161228179932,1.613946795463562,1.9125943183898926,1.5863772630691528,1.9475188255310059,1.7069517374038696,1.6868176460266113,2.043097734451294,1.8203723430633545,1.7888414859771729,1.7942531108856201,1.5702102184295654,1.604043960571289,1.676668405532837,2.0055577754974365,1.574371576309204,1.6990294456481934,1.7884880304336548,1.5797690153121948,1.7245755195617676,2.3001418113708496,1.581477165222168,1.9492979049682617,1.6809337139129639,2.7610814571380615,2.0512869358062744,2.0527641773223877],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[2.0,10.0],"y":[1.792739748954773,4.928882598876953],"type":"scatter"},{"mode":"lines","x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"y":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('7e73020a-126e-44ef-9036-e6b26b18b8b4');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell" data-execution_count="18">
<div class="cell-output cell-output-display">
<p><img src="Deep-Learning_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="discussion-1" class="level2">
<h2 class="anchored" data-anchor-id="discussion-1">Discussion</h2>
<div class="cell" data-execution_count="19">
<div class="cell-output cell-output-display">
<p>With L2 Regularization (lambda = 0.01) added to the Simple RNN model, the Train RMSE remained constant at 0.08 but test RMSE decreased from 0.36 to 0.22.</p>
</div>
</div>
<p>I experimented with the number of epochs, trying 50 first, before arriving at 100. It seems that the regularization penalty was too strong relative to the capacity of the model, resulting in a higher RMSE when using the same number of epochs as before. However, when the number of epochs is reduced, the model had less time to overfit to the training data, and the regularization penalty was able to help the model generalize better.</p>
</section>
</section>
<section id="training-and-evaluating-a-gru-with-l2-regularization" class="level1">
<h1>Training and Evaluating a GRU with L2 Regularization</h1>
<p>The GRU is very similar to LSTM—you can think of it as a slightly simpler, streamlined version of the LSTM architecture. It was introduced in 2014 by Cho et al.&nbsp;and have gained popularity in the last few years. GRU’s have become popular alternatives to LSTMs because they combine the forget and input gates into a single “update gate.” Therefore, it uses gating mechanisms to selectively update and reset the hidden state, allowing it to learn long-term dependencies more effectively. <span class="citation" data-cites="chollet2021deep">(<a href="#ref-chollet2021deep" role="doc-biblioref">Chollet 2021</a>)</span></p>
<section id="model-and-training-parameters-2" class="level2">
<h2 class="anchored" data-anchor-id="model-and-training-parameters-2">Model and Training Parameters</h2>
<div class="cell" data-execution_count="21">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-gru-model-with-l2-regularization" class="level2">
<h2 class="anchored" data-anchor-id="create-gru-model-with-l2-regularization">Create GRU Model With L2 Regularization</h2>
<div class="cell" data-execution_count="22">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>model.add(GRU(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_2"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> gru (GRU)                   (None, 3)                 54        </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_2 (Dense)             (None, 1)                 4         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 58</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 58</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="train-model-and-visualize-performance-2" class="level2">
<h2 class="anchored" data-anchor-id="train-model-and-visualize-performance-2">Train Model and Visualize Performance</h2>
<div class="cell" data-execution_count="23">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:10.399327: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:49:10.519176: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:11.176897: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:13.188908: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:49:13.230694: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Visualize Fitting History</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Visualize Parity Plot (Unnormalized Data)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Visualize Predictions (Unnormalized Data)</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-execution_count="24">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 0s 32ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 35ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00183 RMSE = 0.04273
Test MSE = 0.03326 RMSE = 0.18238</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="6fc5b60d-0fb2-4443-9700-b6be1ba35a5b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6fc5b60d-0fb2-4443-9700-b6be1ba35a5b")) {                    Plotly.newPlot(                        "6fc5b60d-0fb2-4443-9700-b6be1ba35a5b",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[0.03432882949709892,0.032967809587717056,0.03204403072595596,0.031222762539982796,0.030639488250017166,0.0298669021576643,0.029144693166017532,0.028552943840622902,0.02794828452169895,0.027292683720588684,0.02665877901017666,0.02612777054309845,0.025569073855876923,0.025096789002418518,0.024439819157123566,0.023876328021287918,0.023340478539466858,0.022832905873656273,0.022364191710948944,0.021790828555822372,0.02127568982541561,0.020755594596266747,0.02029997482895851,0.019759157672524452,0.019299186766147614,0.01891867257654667,0.018403850495815277,0.017990510910749435,0.017549557611346245,0.017124811187386513,0.01668950729072094,0.016270823776721954,0.01584629714488983,0.015484095551073551,0.015089001506567001,0.01466073002666235,0.01430098433047533,0.013928264379501343,0.013591229915618896,0.013244898058474064,0.012874208390712738,0.012570509687066078,0.012275396846234798,0.011916455812752247,0.011652790941298008,0.011297819204628468,0.011026226915419102,0.01072782278060913,0.010396189987659454,0.010125312022864819,0.009896252304315567,0.009603881277143955,0.009338484145700932,0.009085980243980885,0.008815089240670204,0.008597681298851967,0.008314646780490875,0.008068692870438099,0.007905672304332256,0.007691231556236744,0.007496690843254328,0.007253594230860472,0.007052185945212841,0.006828514859080315,0.006655126344412565,0.006459116470068693,0.006330701522529125,0.006107622291892767,0.005978529807180166,0.005790888797491789,0.0056952801533043385,0.00551114697009325,0.0053611574694514275,0.005249411333352327,0.005091570783406496,0.0049840835854411125,0.004859452601522207,0.004719848744571209,0.004635243210941553,0.004522586241364479,0.00440564239397645,0.004308431874960661,0.004228335339576006,0.0041499934159219265,0.004031873773783445,0.003914033994078636,0.0038954485207796097,0.0037715076468884945,0.0037492408882826567,0.0036280520725995302,0.0035696947015821934,0.003537139156833291,0.003423346672207117,0.0033515847753733397,0.003295545931905508,0.0032419220078736544,0.0032156084198504686,0.0031424195040017366,0.0030874162912368774,0.003073795698583126],"yaxis":"y","type":"scatter"},{"mode":"lines","name":"Training","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.02934860996901989,0.028475366532802582,0.02785801701247692,0.02738293446600437,0.026557236909866333,0.025959884747862816,0.025473618879914284,0.02488216944038868,0.024487381801009178,0.023748653009533882,0.023233136162161827,0.02270926721394062,0.022335926070809364,0.021826637908816338,0.0211798045784235,0.020787226036190987,0.020445844158530235,0.020080698654055595,0.01950651966035366,0.01884484477341175,0.018302112817764282,0.01785905845463276,0.017433861270546913,0.017086511477828026,0.016614513471722603,0.016206277534365654,0.01577049493789673,0.015443273819983006,0.015095625072717667,0.014658755622804165,0.014291512779891491,0.013907834887504578,0.01362483948469162,0.013253439217805862,0.012803032994270325,0.012502224184572697,0.012153645046055317,0.011836670339107513,0.011516883037984371,0.011199609376490116,0.010891485959291458,0.010596826672554016,0.010318468324840069,0.01003972440958023,0.009756733663380146,0.009524844586849213,0.009208997711539268,0.008917335420846939,0.008660971187055111,0.008404729887843132,0.008170053362846375,0.007912986911833286,0.007748602423816919,0.007481056731194258,0.007295223418623209,0.007022195030003786,0.006797345820814371,0.006591747980564833,0.006387070287019014,0.006188573781400919,0.005991728976368904,0.005815667565912008,0.005633990745991468,0.005445701535791159,0.005276304204016924,0.005114835221320391,0.004947920795530081,0.004851053934544325,0.00464070588350296,0.0045046634040772915,0.00438266946002841,0.004280071705579758,0.00419057160615921,0.003968095872551203,0.0038544980343431234,0.00375129166059196,0.0036282443907111883,0.003554431488737464,0.0034174772445112467,0.0033454494550824165,0.0032919354271143675,0.003285524668172002,0.003213779767975211,0.0031146863475441933,0.002899783430621028,0.0028197329957038164,0.0027305230032652617,0.0026570677291601896,0.0025948851834982634,0.0026468606665730476,0.0025965983513742685,0.0024217322934418917,0.00242255674675107,0.0023462099488824606,0.0022374093532562256,0.0021951247472316027,0.002214731415733695,0.002080232137814164,0.002030008239671588,0.0019932498689740896],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Training Epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training Loss (Red) vs Validation Loss (Blue)"},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('6fc5b60d-0fb2-4443-9700-b6be1ba35a5b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-execution_count="25">
<div class="cell-output cell-output-display">

<div>                            <div id="f95672cd-49a0-41de-8f17-3b7940dc7fb2" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f95672cd-49a0-41de-8f17-3b7940dc7fb2")) {                    Plotly.newPlot(                        "f95672cd-49a0-41de-8f17-3b7940dc7fb2",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"xaxis":"x","y":[5.122766971588135,4.5109543800354,2.0896573066711426,2.0919582843780518,2.077561378479004,2.926757335662842,3.3277459144592285,2.450343608856201,2.506075382232666,2.150216579437256,2.036411762237549,2.399768829345703,2.169271469116211,2.1417551040649414,2.333141803741455,1.8644214868545532,1.8620775938034058,2.2499141693115234,1.977734923362732,1.6346430778503418,1.8911020755767822,1.5837785005569458,1.8173171281814575,1.9133999347686768,1.703543782234192,1.6456456184387207,1.6753120422363281,1.9138998985290527,1.8849170207977295,2.497506618499756,1.8316240310668945,1.885188102722168,1.7766999006271362,1.747729778289795,1.5196473598480225,1.9819761514663696,1.6214745044708252,1.6752946376800537,2.174619674682617,1.867969274520874,1.6229853630065918,1.5849888324737549,1.4937074184417725,1.5416090488433838,1.6089086532592773,1.8211307525634766,1.4818769693374634,1.5734217166900635,1.6602535247802734,1.4777328968048096,1.6444973945617676,1.9093406200408936,1.4833495616912842,1.894287347793579,1.7560205459594727,2.5769710540771484,2.1519062519073486,1.9797255992889404],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[2.0,10.0],"y":[2.8752708435058594,5.967148303985596],"type":"scatter"},{"mode":"lines","x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"y":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f95672cd-49a0-41de-8f17-3b7940dc7fb2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell" data-execution_count="26">
<div class="cell-output cell-output-display">
<p><img src="Deep-Learning_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="discussion-2" class="level2">
<h2 class="anchored" data-anchor-id="discussion-2">Discussion</h2>
<div class="cell" data-execution_count="27">
<div class="cell-output cell-output-display">
<p>The GRU with L2 Regularization performs better, as observed by its Train RMSE of 0.04 and test RMSE of 0.18, a slight drop from that of the Simple RNN models.</p>
</div>
</div>
<p>Although this is a good sign that a more complex model performs better, the prediction plot remains fairly similar compared to those of the RNN models. Let’s try a Bidirectional GRU model, keeping the same number of epochs (100), to see if we can further improve the model’s performance.</p>
</section>
</section>
<section id="training-and-evaluating-a-bidirectional-gru" class="level1">
<h1>Training and Evaluating a Bidirectional GRU</h1>
<section id="model-and-training-parameters-3" class="level2">
<h2 class="anchored" data-anchor-id="model-and-training-parameters-3">Model and Training Parameters</h2>
<div class="cell" data-execution_count="29">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-bidirectional-gru" class="level2">
<h2 class="anchored" data-anchor-id="create-bidirectional-gru">Create Bidirectional GRU</h2>
<div class="cell" data-execution_count="30">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(GRU(</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="co"># BUILD THE MODEL </span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>model.build(input_shape<span class="op">=</span>(<span class="va">None</span>, trainX.shape[<span class="dv">1</span>], trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_3"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> bidirectional (Bidirectiona  (None, 6)                108       </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> l)                                                              </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_3 (Dense)             (None, 1)                 7         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 115</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 115</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="train-model-and-visualize-performance-3" class="level2">
<h2 class="anchored" data-anchor-id="train-model-and-visualize-performance-3">Train Model and Visualize Performance</h2>
<div class="cell" data-execution_count="31">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:22.931618: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:49:23.128454: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:23.136937: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:23.370995: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:49:23.384101: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:24.014885: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:49:24.070711: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:49:24.077214: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Visualize Fitting History</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Visualize Parity Plot (Unnormalized Data)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Visualize Predictions (Unnormalized Data)</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell" data-execution_count="32">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 1s 59ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 61ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00175 RMSE = 0.04184
Test MSE = 0.04620 RMSE = 0.21494</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="e1b28417-f9bc-4a1e-a594-6e4ec920a687" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e1b28417-f9bc-4a1e-a594-6e4ec920a687")) {                    Plotly.newPlot(                        "e1b28417-f9bc-4a1e-a594-6e4ec920a687",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[0.012985956855118275,0.01066230796277523,0.009724152274429798,0.009442698210477829,0.00909197423607111,0.008939659222960472,0.008588838391005993,0.008231461979448795,0.007912243716418743,0.007640451658517122,0.007348969113081694,0.007065716665238142,0.006963125430047512,0.006588853430002928,0.006347395945340395,0.006133051589131355,0.005792759824544191,0.005664856638759375,0.005542861297726631,0.005196219775825739,0.004941705614328384,0.004812121856957674,0.004548248369246721,0.004487975966185331,0.004269266035407782,0.004051645286381245,0.003926520235836506,0.0038328839000314474,0.0036691834684461355,0.003442526562139392,0.0033841412514448166,0.0033333534374833107,0.003172400174662471,0.003085860051214695,0.0030335071496665478,0.0030177966691553593,0.002859014319255948,0.00287060858681798,0.0026955546345561743,0.0026409057900309563,0.002581333741545677,0.002486248267814517,0.0024070986546576023,0.0023705328349024057,0.0023410471621900797,0.0022905319929122925,0.0022522429935634136,0.002177479909732938,0.0021125138737261295,0.002132217865437269,0.002115679671987891,0.0020113540813326836,0.002026178641244769,0.0019911082927137613,0.0020010212901979685,0.0019654622301459312,0.0019345821347087622,0.00189689127728343,0.0019361533923074603,0.0019202434923499823,0.00201178970746696,0.0019712327048182487,0.0018463172018527985,0.001853499561548233,0.0018810713663697243,0.0018221327336505055,0.001886892132461071,0.001887924037873745,0.001812351169064641,0.0018922621384263039,0.0019343720050528646,0.0018884738674387336,0.0018418721156194806,0.0018831322668120265,0.001897505484521389,0.0018361504189670086,0.0018153085839003325,0.0017964873695746064,0.00179958064109087,0.001839666860178113,0.0018400433473289013,0.0018037490081042051,0.0017766624223440886,0.0018420811975374818,0.0018015041714534163,0.001817074022255838,0.0018054035026580095,0.0018071895465254784,0.001849789870902896,0.0017984338337555528,0.0017907904693856835,0.0017674228874966502,0.001761361607350409,0.001791169517673552,0.0017798683838918805,0.0018292414024472237,0.0018851133063435555,0.0017755216686055064,0.0018030829960480332,0.0017968581523746252],"yaxis":"y","type":"scatter"},{"mode":"lines","name":"Training","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.0009950681123882532,0.002383248880505562,0.0022789377253502607,0.0021710575092583895,0.0023293900303542614,0.0015369378961622715,0.0014444813132286072,0.0014895731583237648,0.0014067781157791615,0.0012912717647850513,0.0012797762174159288,0.001251795212738216,0.0013358336873352528,0.001224480220116675,0.0010189402382820845,0.0010381829924881458,0.0019433270208537579,0.002212997991591692,0.002071423688903451,0.0013399951858446002,0.0011567292967811227,0.0009316510404460132,0.0009304676786996424,0.0008791511063463986,0.0009507275535725057,0.001400962471961975,0.0008436830248683691,0.0012600232148543,0.000935204850975424,0.0013180231908336282,0.0015092716785147786,0.0010759258875623345,0.0011086130980402231,0.0009515004348941147,0.0012344890274107456,0.0010429309913888574,0.0011364261154085398,0.000845529546495527,0.0009155878215096891,0.0010305705945938826,0.0008354058372788131,0.0008571012294851243,0.0008536974783055484,0.0008490726468153298,0.0008600254659540951,0.0008818249334581196,0.000885889632627368,0.0008853631443344057,0.001067304634489119,0.0010540512157604098,0.0009076924179680645,0.0009183890651911497,0.0009610667475499213,0.0009504751651547849,0.0009351051994599402,0.0009477378334850073,0.0009650724823586643,0.001173481228761375,0.0009918032446876168,0.0010631694458425045,0.001012092805467546,0.001020002644509077,0.0010045148665085435,0.0010212432825937867,0.0010277159744873643,0.0010458333417773247,0.0010662934510037303,0.0010329469805583358,0.0010541175724938512,0.001123341848142445,0.0010817745933309197,0.0010410862741991878,0.001064728363417089,0.001075391541235149,0.001069502206519246,0.0010484290542080998,0.0010528964921832085,0.00106174370739609,0.0012012813240289688,0.0013141875388100743,0.001070271828211844,0.001079025212675333,0.001228995737619698,0.0010696351528167725,0.0010839015012606978,0.0011865113629028201,0.0011172295780852437,0.0013126470148563385,0.0011494985083118081,0.0010826688958331943,0.0011049151653423905,0.001114305225200951,0.0010917291510850191,0.0011403713142499328,0.0011227179784327745,0.001128555042669177,0.00110434100497514,0.0011060158722102642,0.0011303062783554196,0.0013358701253309846],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Training Epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training Loss (Red) vs Validation Loss (Blue)"},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e1b28417-f9bc-4a1e-a594-6e4ec920a687');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell" data-execution_count="33">
<div class="cell-output cell-output-display">

<div>                            <div id="f7ee4ebf-b9f0-47f8-a296-670a6c4ce671" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f7ee4ebf-b9f0-47f8-a296-670a6c4ce671")) {                    Plotly.newPlot(                        "f7ee4ebf-b9f0-47f8-a296-670a6c4ce671",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"xaxis":"x","y":[6.261313438415527,4.157313346862793,2.4508121013641357,2.3080060482025146,2.177178382873535,3.049283742904663,3.5979456901550293,3.098750591278076,2.4687814712524414,2.7468905448913574,2.309999942779541,2.5370988845825195,2.297417163848877,2.342052459716797,2.459474802017212,2.1089563369750977,2.0116848945617676,2.4474081993103027,2.125527858734131,2.0952701568603516,2.353334903717041,1.8385422229766846,1.9844551086425781,2.1561341285705566,1.9005029201507568,1.808349609375,1.8473572731018066,2.14853572845459,2.1204113960266113,2.4460020065307617,2.167924404144287,2.1599977016448975,1.9870059490203857,1.8608402013778687,1.8732340335845947,2.097414970397949,1.8667500019073486,2.0957603454589844,2.588393211364746,2.0253443717956543,1.867229700088501,1.8072906732559204,1.8218424320220947,1.7534446716308594,1.7619280815124512,1.9482316970825195,1.7213962078094482,1.7636876106262207,1.8980998992919922,1.7028099298477173,1.7938532829284668,2.1056270599365234,1.6828699111938477,2.120075225830078,2.039498805999756,2.6332550048828125,2.4306416511535645,2.1949539184570312],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[2.0,10.0],"y":[2.785153865814209,5.200254440307617],"type":"scatter"},{"mode":"lines","x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"y":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f7ee4ebf-b9f0-47f8-a296-670a6c4ce671');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell" data-execution_count="34">
<div class="cell-output cell-output-display">
<p><img src="Deep-Learning_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="discussion-3" class="level2">
<h2 class="anchored" data-anchor-id="discussion-3">Discussion</h2>
<div class="cell" data-execution_count="35">
<div class="cell-output cell-output-display">
<p>The Bidirectional GRU with no regularization performs worse than not only the GRU with L2 Regularization but also the Simple RNN models! Its Train RMSE of 0.04 and test RMSE of 0.21 are worse than the previous 3 models tested. This is likely due to the fact that the Bidirectional GRU is a more complex model and thus requires more regularization to prevent overfitting. Let’s introduce regularization again, but this time with a Stacked Bidirectional GRU.</p>
</div>
</div>
</section>
</section>
<section id="training-and-evaluating-a-stacked-bidirectional-gru-with-l2-regularization" class="level1">
<h1>Training and Evaluating a Stacked Bidirectional GRU with L2 Regularization</h1>
<section id="model-and-training-parameters-4" class="level2">
<h2 class="anchored" data-anchor-id="model-and-training-parameters-4">Model and Training Parameters</h2>
<div class="cell" data-execution_count="37">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span> </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>callback <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'loss'</span>, patience<span class="op">=</span><span class="dv">3</span>) <span class="co"># This callback will stop the training when there is no improvement in the loss for three consecutive epochs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-stacked-bidirectional-gru-with-l2-regularization" class="level2">
<h2 class="anchored" data-anchor-id="create-stacked-bidirectional-gru-with-l2-regularization">Create Stacked Bidirectional GRU with L2 Regularization</h2>
<div class="cell" data-execution_count="38">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(GRU(</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units, </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(GRU(</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'relu'</span>)</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="co"># BUILD THE MODEL </span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>model.build(input_shape<span class="op">=</span>(<span class="va">None</span>, trainX.shape[<span class="dv">1</span>], trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:Layer gru_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:Layer gru_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:Layer gru_3 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_4"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> bidirectional_1 (Bidirectio  (None, 9, 6)             108       </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> nal)                                                            </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> bidirectional_2 (Bidirectio  (None, 6)                198       </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> nal)                                                            </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_4 (Dense)             (None, 1)                 7         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 313</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 313</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="train-model-and-visualize-performance-4" class="level2">
<h2 class="anchored" data-anchor-id="train-model-and-visualize-performance-4">Train Model and Visualize Performance</h2>
<div class="cell" data-execution_count="39">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>callbacks<span class="op">=</span>[callback], <span class="co">#early stopping</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:38.809866: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:39.284167: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:49:39.294308: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:40.568910: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:49:40.581766: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:49:42.968524: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:49:43.079910: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:49:43.086392: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Visualize Fitting History</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Visualize Parity Plot (Unnormalized Data)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Visualize Predictions (Unnormalized Data)</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell" data-execution_count="40">
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:5 out of the last 13 calls to &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x2c7a5f1c0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 1s 172ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 172ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00170 RMSE = 0.04124
Test MSE = 0.06636 RMSE = 0.25761</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="d2b0faa9-531e-4e0d-ad82-cfa5f4dbcf12" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d2b0faa9-531e-4e0d-ad82-cfa5f4dbcf12")) {                    Plotly.newPlot(                        "d2b0faa9-531e-4e0d-ad82-cfa5f4dbcf12",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[0.06714349240064621,0.06341788917779922,0.06072525307536125,0.05866311490535736,0.0569487139582634,0.05546019226312637,0.054022565484046936,0.05277848243713379,0.05134870111942291,0.050098687410354614,0.04883832484483719,0.04765922948718071,0.04654725268483162,0.045493341982364655,0.04430794343352318,0.04329586774110794,0.042272794991731644,0.04129214212298393,0.04035866633057594,0.03930218145251274,0.038376275449991226,0.0374453105032444,0.03656100854277611,0.03566223010420799,0.03484485670924187,0.03391607850790024,0.03309167921543121,0.032288189977407455,0.03147648274898529,0.03067733161151409,0.029941821470856667,0.02913067862391472,0.02837851457297802,0.027684783563017845,0.026889948174357414,0.026199910789728165,0.025497332215309143,0.02479921281337738,0.02413288690149784,0.0234718918800354,0.02282167598605156,0.02217489667236805,0.02156180702149868,0.020928293466567993,0.020328830927610397,0.019698796793818474,0.01915205642580986,0.0186169371008873,0.018038034439086914,0.01751757599413395,0.017020445317029953,0.016482919454574585,0.0159513708204031,0.015499654226005077,0.0150309968739748,0.014545212499797344,0.014063642360270023,0.01364758238196373,0.013174802996218204,0.012763096950948238,0.012348844669759274,0.011927084997296333,0.011545384302735329,0.011167707853019238,0.010774138383567333,0.010442400351166725,0.010064803063869476,0.009709963575005531,0.009393051266670227,0.00909765250980854,0.008786523714661598,0.008502810262143612,0.008214435540139675,0.00796017050743103,0.007652862463146448,0.007415649015456438,0.00715679069980979,0.0069353035651147366,0.006757800467312336,0.006540979258716106,0.006276499945670366,0.006079890299588442,0.005907353479415178,0.00573134096339345,0.005547168664634228,0.005369662772864103,0.005198411177843809,0.005150872282683849,0.004987356252968311,0.004753507673740387,0.0046427384950220585,0.004494391847401857,0.004407291766256094,0.004281433764845133,0.004184862598776817,0.004007349722087383,0.003919142764061689,0.0038159084506332874,0.0037043874617666006,0.0036356928758323193],"yaxis":"y","type":"scatter"},{"mode":"lines","name":"Training","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.06050225719809532,0.058193664997816086,0.05664617940783501,0.05576528236269951,0.055050794035196304,0.05318162962794304,0.052239466458559036,0.05042503401637077,0.04961654543876648,0.0483129508793354,0.04687047004699707,0.04565770924091339,0.04454511031508446,0.04382661357522011,0.04276527091860771,0.04152705520391464,0.04048847779631615,0.03958899900317192,0.03893674910068512,0.03794453665614128,0.03686676546931267,0.03609979525208473,0.03508666530251503,0.03423653915524483,0.03364012762904167,0.03294211998581886,0.03187249228358269,0.031219439581036568,0.030380943790078163,0.029421724379062653,0.02868136763572693,0.02796032465994358,0.02740056999027729,0.026354894042015076,0.025960585102438927,0.025089306756854057,0.024364186450839043,0.023732485249638557,0.023114703595638275,0.022574445232748985,0.0217380803078413,0.021045951172709465,0.020610695704817772,0.019864004105329514,0.019495615735650063,0.01880807615816593,0.018250497058033943,0.017656976357102394,0.017279883846640587,0.016803542152047157,0.016449030488729477,0.015590552240610123,0.015369166620075703,0.014992665499448776,0.014217290095984936,0.013836870901286602,0.013407879509031773,0.012940946035087109,0.012637811712920666,0.012282698415219784,0.011624542064964771,0.011200929991900921,0.01106216385960579,0.010438978672027588,0.010044354014098644,0.009892079047858715,0.009431615471839905,0.009074424393475056,0.008998640812933445,0.008495758287608624,0.008221444673836231,0.007835359312593937,0.007536334916949272,0.007361918687820435,0.007077332586050034,0.00692589208483696,0.006742553785443306,0.006627685856074095,0.00636753486469388,0.006082755979150534,0.005754913669079542,0.005627352744340897,0.0053162588737905025,0.00513663562014699,0.004958590026944876,0.004841845016926527,0.004896277561783791,0.004820727277547121,0.004447990097105503,0.004216026980429888,0.0040811398066580296,0.003955031279474497,0.0038441773504018784,0.0037076629232615232,0.0035991917829960585,0.003482579253613949,0.003434662474319339,0.0033878814429044724,0.0031689333263784647,0.003094794461503625],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Training Epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training Loss (Red) vs Validation Loss (Blue)"},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d2b0faa9-531e-4e0d-ad82-cfa5f4dbcf12');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell" data-execution_count="41">
<div class="cell-output cell-output-display">

<div>                            <div id="f1d6e031-a1bc-4be9-a660-3649282faaea" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f1d6e031-a1bc-4be9-a660-3649282faaea")) {                    Plotly.newPlot(                        "f1d6e031-a1bc-4be9-a660-3649282faaea",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"xaxis":"x","y":[5.419820308685303,3.88191294670105,2.1339821815490723,1.9894390106201172,1.9222118854522705,2.445849895477295,2.8864049911499023,2.630265235900879,2.3389296531677246,2.343430519104004,2.0144057273864746,2.1496541500091553,2.0142390727996826,2.0203771591186523,2.1355228424072266,1.8584160804748535,1.764185905456543,2.0442142486572266,1.759376049041748,1.7095750570297241,1.897934913635254,1.580186128616333,1.679583191871643,1.781787395477295,1.6688554286956787,1.6206167936325073,1.5966448783874512,1.7904125452041626,1.887467622756958,2.0524041652679443,1.8407816886901855,1.76154363155365,1.8356362581253052,1.584869146347046,1.5870583057403564,1.883276104927063,1.6266624927520752,1.7164053916931152,1.9909311532974243,1.6877286434173584,1.5942273139953613,1.4792438745498657,1.508251428604126,1.4629238843917847,1.500112771987915,1.6080524921417236,1.4454281330108643,1.4996397495269775,1.5790084600448608,1.4389208555221558,1.5451953411102295,1.6642537117004395,1.438279151916504,1.7572038173675537,1.7397207021713257,2.1181259155273438,2.0911660194396973,1.8592286109924316],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[2.0,10.0],"y":[3.4026520252227783,4.3421478271484375],"type":"scatter"},{"mode":"lines","x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"y":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f1d6e031-a1bc-4be9-a660-3649282faaea');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell" data-execution_count="42">
<div class="cell-output cell-output-display">
<p><img src="Deep-Learning_files/figure-html/cell-43-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="discussion-4" class="level2">
<h2 class="anchored" data-anchor-id="discussion-4">Discussion</h2>
<p>When using the Stacked Bidirectional GRU, it is imperative to add <code>return_sequences=True</code> to stack recurrent layers on top of each other in Keras. All intermediate layers should return their full sequence of outputs (a rank-3 tensor) rather than their output at the last timestep.</p>
<div class="cell" data-execution_count="43">
<div class="cell-output cell-output-display">
<p>The output of this model is the worst out of all models so far, given its train RMSE of 0.04 and test RMSE of 0.26. Therefore, the best GRU model for predicting number of terorrist attacks in the US is the GRU model with L2 Regularization.</p>
</div>
</div>
</section>
</section>
<section id="training-and-evaluating-a-bidirectional-lstm" class="level1">
<h1>Training and Evaluating a Bidirectional LSTM</h1>
<section id="model-and-training-parameters-5" class="level2">
<h2 class="anchored" data-anchor-id="model-and-training-parameters-5">Model and Training Parameters</h2>
<div class="cell" data-execution_count="45">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span> </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>callback <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'loss'</span>, patience<span class="op">=</span><span class="dv">3</span>) <span class="co"># This callback will stop the training when there is no improvement in the loss for three consecutive epochs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-bidirectional-lstm" class="level2">
<h2 class="anchored" data-anchor-id="create-bidirectional-lstm">Create Bidirectional LSTM</h2>
<div class="cell" data-execution_count="46">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(LSTM(</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]),</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="co"># BUILD THE MODEL </span></span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>model.build(input_shape<span class="op">=</span>(<span class="va">None</span>, trainX.shape[<span class="dv">1</span>], trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_5"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> bidirectional_3 (Bidirectio  (None, 6)                120       </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> nal)                                                            </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_5 (Dense)             (None, 1)                 7         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 127</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 127</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="train-model-and-visualize-performance-5" class="level2">
<h2 class="anchored" data-anchor-id="train-model-and-visualize-performance-5">Train Model and Visualize Performance</h2>
<div class="cell" data-execution_count="47">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>callbacks<span class="op">=</span>[callback], <span class="co">#early stopping</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:52:21.678310: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:52:21.872873: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:52:21.883274: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:52:22.880704: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:52:22.895576: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:52:24.561378: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:52:24.622381: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:52:24.629700: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Visualize Fitting History</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Visualize Parity Plot (Unnormalized Data)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Visualize Predictions (Unnormalized Data)</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell" data-execution_count="48">
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:5 out of the last 13 calls to &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x16be91bd0&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 0s 51ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 60ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00162 RMSE = 0.04022
Test MSE = 0.04734 RMSE = 0.21759</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="4050d2d2-afb2-41cc-ba72-61f93d6013a7" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("4050d2d2-afb2-41cc-ba72-61f93d6013a7")) {                    Plotly.newPlot(                        "4050d2d2-afb2-41cc-ba72-61f93d6013a7",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"xaxis":"x","y":[0.004978778772056103,0.004078158643096685,0.003887573257088661,0.003673186060041189,0.0034517503809183836,0.0032890273723751307,0.0030969756189733744,0.002931737806648016,0.002819940447807312,0.002690674504265189,0.0025403874460607767,0.0024241760838776827,0.002413312904536724,0.0022248283494263887,0.0021995168644934893,0.0021039261482656,0.0020617081318050623,0.0020240016747266054,0.001983496593311429,0.0019386770436540246,0.001894198707304895,0.0018787914887070656,0.0018466918263584375,0.0018453949596732855,0.0018759871600195765,0.0018332203617319465,0.0018140176543965936,0.0018113012192770839,0.001788803725503385,0.0018170926487073302,0.0017620642902329564,0.00176924467086792,0.0017587943002581596,0.0018180574988946319,0.0018457944970577955,0.001801429083570838],"yaxis":"y","type":"scatter"},{"mode":"lines","name":"Training","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"y":[0.0016099978238344193,0.0011160492431372404,0.0010605463758111,0.0012168848188593984,0.001073322375304997,0.001208561472594738,0.0014231352834030986,0.0013137402711436152,0.001163012464530766,0.001024678465910256,0.0011892085894942284,0.0012841579737141728,0.0010189602617174387,0.000937008298933506,0.0009964852361008525,0.0011484302813187242,0.0010804679477587342,0.0010898412438109517,0.0009728100267238915,0.001043478725478053,0.001034608925692737,0.001056332723237574,0.001009132363833487,0.001022949581965804,0.0010305760661140084,0.0010417076991871,0.0011361996876075864,0.001049427199177444,0.0010945018148049712,0.00105631398037076,0.0010873281862586737,0.0010672487551346421,0.0011228433577343822,0.0011271234834566712,0.0011065105209127069,0.0010854112915694714],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Training Epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training Loss (Red) vs Validation Loss (Blue)"},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('4050d2d2-afb2-41cc-ba72-61f93d6013a7');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell" data-execution_count="49">
<div class="cell-output cell-output-display">

<div>                            <div id="d48c6bdd-e657-449c-892d-7a253723fc80" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d48c6bdd-e657-449c-892d-7a253723fc80")) {                    Plotly.newPlot(                        "d48c6bdd-e657-449c-892d-7a253723fc80",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"xaxis":"x","y":[5.7136101722717285,4.535101890563965,2.4885430335998535,2.240372657775879,2.1390321254730225,2.847830057144165,3.4052603244781494,3.1024744510650635,2.7243781089782715,2.7275025844573975,2.295151710510254,2.4574906826019287,2.2723019123077393,2.275120735168457,2.462313652038574,2.075793743133545,1.9504168033599854,2.296618938446045,1.8953795433044434,1.8550598621368408,2.117612838745117,1.6923296451568604,1.800775170326233,1.9503400325775146,1.825495958328247,1.7666633129119873,1.7000232934951782,1.9496948719024658,2.122175693511963,2.290083408355713,2.058682441711426,1.9106441736221313,2.0730092525482178,1.6654014587402344,1.7098819017410278,2.112967014312744,1.7885527610778809,1.858290195465088,2.241913318634033,1.8158048391342163,1.7179923057556152,1.5197100639343262,1.581828236579895,1.4986287355422974,1.5444538593292236,1.6821651458740234,1.4893845319747925,1.5701086521148682,1.6602650880813599,1.4861721992492676,1.6339702606201172,1.75040864944458,1.4846651554107666,1.9096801280975342,1.8836638927459717,2.3807172775268555,2.3782925605773926,2.0647377967834473],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[2.0,10.0],"y":[4.0832343101501465,5.53903865814209],"type":"scatter"},{"mode":"lines","x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"y":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d48c6bdd-e657-449c-892d-7a253723fc80');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell" data-execution_count="50">
<div class="cell-output cell-output-display">
<p><img src="Deep-Learning_files/figure-html/cell-51-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="discussion-5" class="level2">
<h2 class="anchored" data-anchor-id="discussion-5">Discussion</h2>
<div class="cell" data-execution_count="51">
<div class="cell-output cell-output-display">
<p>The Bidirectional LSTM with no regularization performs better than the Stacked GRU with L2 regularization, but worse than both the Bidirectional GRU and the GRU with L2 regularization. The train RMSE of this Bidirectional LSTM is 0.04 and test RMSE is 0.22. The LSTM model, which is more complex than the GRU, is likely overfitting the data. The GRU model with L2 regularization is the best model so far. Let’s see if we can improve the performance of the Bidirectional LSTM with L2 regularization by tuning the hyperparameters.</p>
</div>
</div>
</section>
</section>
<section id="training-and-evaluating-a-bidirectional-lstm-with-l2-regularization" class="level1">
<h1>Training and Evaluating a Bidirectional LSTM with L2 Regularization</h1>
<section id="model-and-training-parameters-6" class="level2">
<h2 class="anchored" data-anchor-id="model-and-training-parameters-6">Model and Training Parameters</h2>
<div class="cell" data-execution_count="53">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>callback <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'loss'</span>, patience<span class="op">=</span><span class="dv">3</span>) <span class="co"># This callback will stop the training when there is no improvement in the loss for three consecutive epochs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-bidirectional-lstm-with-l2-regularization" class="level2">
<h2 class="anchored" data-anchor-id="create-bidirectional-lstm-with-l2-regularization">Create Bidirectional LSTM with L2 Regularization</h2>
<div class="cell" data-execution_count="54">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(LSTM(</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]),</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a><span class="co"># BUILD THE MODEL </span></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>model.build(input_shape<span class="op">=</span>(<span class="va">None</span>, trainX.shape[<span class="dv">1</span>], trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_6"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Layer (type)                Output Shape              Param #   </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> bidirectional_4 (Bidirectio  (None, 6)                120       </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> nal)                                                            </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> dense_6 (Dense)             (None, 1)                 7         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================================================</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Total params: 127</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Trainable params: 127</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Non-trainable params: 0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="train-model-and-visualize-performance-6" class="level2">
<h2 class="anchored" data-anchor-id="train-model-and-visualize-performance-6">Train Model and Visualize Performance</h2>
<div class="cell" data-execution_count="55">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>callbacks<span class="op">=</span>[callback], <span class="co">#early stopping</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:52:32.149248: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:52:32.373302: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:52:32.384588: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:52:32.530447: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:52:32.544122: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-05-10 18:52:33.385391: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:52:33.465829: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
2023-05-10 18:52:33.473596: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.</code></pre>
</div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Visualize Fitting History</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Visualize Parity Plot (Unnormalized Data)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Visualize Predictions (Unnormalized Data)</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell" data-execution_count="56">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 1s 50ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 57ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00164 RMSE = 0.04056
Test MSE = 0.05333 RMSE = 0.23093</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="08074bd2-7849-470b-a654-0ec054a9f126" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("08074bd2-7849-470b-a654-0ec054a9f126")) {                    Plotly.newPlot(                        "08074bd2-7849-470b-a654-0ec054a9f126",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[0.0633150115609169,0.060072850435972214,0.057937830686569214,0.05608607828617096,0.05436321347951889,0.05267823114991188,0.051127053797245026,0.04956214502453804,0.048141371458768845,0.046824563294649124,0.04544356092810631,0.04409438744187355,0.04281002655625343,0.041541606187820435,0.040291186422109604,0.03915484994649887,0.03797651454806328,0.03681395575404167,0.03582657501101494,0.03463980555534363,0.033632513135671616,0.032637085765600204,0.03162749111652374,0.030603839084506035,0.029674353078007698,0.028766388073563576,0.027868615463376045,0.026987094432115555,0.02612188830971718,0.025312792509794235,0.024494454264640808,0.023777205497026443,0.022948993369936943,0.02221928909420967,0.021464498713612556,0.020764751359820366,0.020093686878681183,0.019443361088633537,0.01876850053668022,0.018154775723814964,0.017533734440803528,0.016942042857408524,0.01631576381623745,0.015834718942642212,0.015236997976899147,0.014639241620898247,0.014136135578155518,0.013598451390862465,0.0131004573777318,0.012603694573044777,0.012122630141675472,0.011678606271743774,0.011233610101044178,0.010804180055856705,0.010400166735053062,0.009969333186745644,0.009644649922847748,0.009221880696713924,0.00884292833507061,0.008503282442688942,0.008163610473275185,0.00786083098500967,0.007546037435531616,0.007323078345507383,0.007003163453191519,0.006677561439573765,0.006444740574806929,0.006181675009429455,0.00596054270863533,0.005762067623436451,0.00555056007578969,0.005349353421479464,0.005146101117134094,0.004972331691533327,0.004830542020499706,0.004642192739993334,0.0044913566671311855,0.0043802582658827305,0.004251160193234682,0.004088699817657471,0.003965397365391254,0.003847898682579398,0.0037977818865329027,0.003672721330076456,0.003562661586329341,0.003440078115090728,0.003408199641853571,0.0032386365346610546,0.0031536503229290247,0.003095724619925022,0.0030032156500965357,0.0029195034876465797,0.00286220945417881,0.002785592572763562,0.002724782330915332,0.0026674256660044193,0.00259781233035028,0.0025119257625192404,0.002524251351132989,0.002413524314761162],"yaxis":"y","type":"scatter"},{"mode":"lines","name":"Training","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.0582476370036602,0.05599315091967583,0.054657284170389175,0.05269864574074745,0.050913047045469284,0.04929812625050545,0.048208415508270264,0.046745914965867996,0.04529077932238579,0.04406098648905754,0.04277494177222252,0.041562024503946304,0.04040733352303505,0.03952096775174141,0.03851008415222168,0.037214744836091995,0.03597135841846466,0.034899305552244186,0.03389301523566246,0.03288425877690315,0.03203324228525162,0.031105073168873787,0.029942141845822334,0.029148012399673462,0.028141304850578308,0.0273404773324728,0.02653121016919613,0.02569863758981228,0.024773815646767616,0.023985333740711212,0.023280508816242218,0.022527439519762993,0.021771682426333427,0.02101162075996399,0.02031419426202774,0.019653046503663063,0.01902914047241211,0.018357353284955025,0.017697425559163094,0.01709822751581669,0.01651853136718273,0.015920234844088554,0.015358299016952515,0.01475502923130989,0.014211856760084629,0.013690929859876633,0.013170115649700165,0.012689941562712193,0.012191002257168293,0.0117179611697793,0.011265539564192295,0.010829481296241283,0.010382669977843761,0.009976877830922604,0.009561164304614067,0.009244666434824467,0.008784337900578976,0.008422121405601501,0.008069340139627457,0.007744006812572479,0.0074530416168272495,0.0070938910357654095,0.006832543294876814,0.006508448626846075,0.00623737508431077,0.00600338215008378,0.005737971514463425,0.0055231209844350815,0.005318773910403252,0.005157610401511192,0.004887234885245562,0.004694567061960697,0.004571838304400444,0.004472480621188879,0.004191508516669273,0.004031832795590162,0.003890769323334098,0.0037522984202951193,0.0036157735157757998,0.003503059269860387,0.0033725304529070854,0.0033089732751250267,0.003206521039828658,0.003109467914327979,0.0029878949280828238,0.0028686465229839087,0.002775392262265086,0.0026929492596536875,0.0027013886719942093,0.002531633945181966,0.002506954362615943,0.0023889841977506876,0.0023216058034449816,0.002275559352710843,0.002205330180004239,0.002149678533896804,0.0020800484344363213,0.0021295486949384212,0.002012871904298663,0.00200535892508924],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Training Epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training Loss (Red) vs Validation Loss (Blue)"},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('08074bd2-7849-470b-a654-0ec054a9f126');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell" data-execution_count="57">
<div class="cell-output cell-output-display">

<div>                            <div id="e820f199-c1af-4a45-923a-060d4679b127" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e820f199-c1af-4a45-923a-060d4679b127")) {                    Plotly.newPlot(                        "e820f199-c1af-4a45-923a-060d4679b127",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"xaxis":"x","y":[5.945377826690674,4.309244155883789,2.4997448921203613,2.2642202377319336,2.1677331924438477,2.757467746734619,3.265484571456909,3.049391031265259,2.6481423377990723,2.7298271656036377,2.316911220550537,2.438228130340576,2.2817611694335938,2.2901787757873535,2.4413442611694336,2.1314642429351807,2.0240774154663086,2.3048534393310547,1.9738023281097412,1.9681482315063477,2.1867432594299316,1.8204153776168823,1.8988492488861084,2.028467893600464,1.9241963624954224,1.8745388984680176,1.8176223039627075,2.0256943702697754,2.1701626777648926,2.2756619453430176,2.129089832305908,1.9995489120483398,2.1288583278656006,1.785298466682434,1.8414386510849,2.148519515991211,1.9049468040466309,1.9674078226089478,2.2792155742645264,1.9123494625091553,1.840667486190796,1.6781142950057983,1.736181616783142,1.6599358320236206,1.6903603076934814,1.8012580871582031,1.6552467346191406,1.7173372507095337,1.7910555601119995,1.6527061462402344,1.7641953229904175,1.8614894151687622,1.6475681066513062,1.995144009590149,1.973661184310913,2.361515998840332,2.384425401687622,2.122054100036621],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[2.0,10.0],"y":[4.1034979820251465,5.216815948486328],"type":"scatter"},{"mode":"lines","x":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"y":[6.101449489593506,3.7826087474823,1.2318840026855469,1.9275362491607666,2.1594202518463135,2.3913044929504395,2.1594202518463135,3.08695650100708,2.1594202518463135,3.7826087474823,2.6231884956359863,3.318840503692627,1.4637681245803833,3.550724744796753,3.08695650100708,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.9275362491607666,2.6231884956359863,1.4637681245803833,1.4637681245803833,2.1594202518463135,1.9275362491607666,1.2318840026855469,1.6956522464752197,1.2318840026855469,1.9275362491607666,1.9275362491607666,2.855072498321533,1.9275362491607666,1.6956522464752197,1.6956522464752197,1.2318840026855469,3.318840503692627,2.6231884956359863,1.2318840026855469,3.550724744796753,1.4637681245803833,1.4637681245803833,1.0,1.6956522464752197,1.6956522464752197,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.0,1.2318840026855469,1.2318840026855469,1.2318840026855469,1.6956522464752197,1.4637681245803833,1.2318840026855469,2.6231884956359863,3.550724744796753,2.1594202518463135,2.3913044929504395],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e820f199-c1af-4a45-923a-060d4679b127');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell" data-execution_count="58">
<div class="cell-output cell-output-display">
<p><img src="Deep-Learning_files/figure-html/cell-59-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="discussion-6" class="level2">
<h2 class="anchored" data-anchor-id="discussion-6">Discussion</h2>
<div class="cell" data-execution_count="59">
<div class="cell-output cell-output-display">
<p>The Bidirectional LSTM with L2 Regularization outputted a train RMSE of 0.04 and test RMSE is 0.23. It performs worse than Bidirectional LSTM without L2 Regularization and significantly worse than the Simple RNN with L2 Regularization and the GRU with L2 Regularization. Now, we can conclude that the GRU with L2 Regularization is the best performing model. But, will it be the best when predicting the number of attacks for the next 5 years instead of 2 years as seen above? Let’s find out.</p>
</div>
</div>
</section>
</section>
<section id="final-results-table" class="level1">
<h1>Final Results Table</h1>
<div class="cell" data-execution_count="60">
<div class="cell-output cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th>Model</th>
<th>L2 Regularization</th>
<th>Train RMSE</th>
<th>Test RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Simple RNN</td>
<td>No</td>
<td>0.08</td>
<td>0.36</td>
</tr>
<tr class="even">
<td>Simple RNN</td>
<td>Yes</td>
<td>0.05</td>
<td>0.22</td>
</tr>
<tr class="odd">
<td>GRU</td>
<td>Yes</td>
<td>0.04</td>
<td>0.18</td>
</tr>
<tr class="even">
<td>Bidirectional GRU</td>
<td>No</td>
<td>0.04</td>
<td>0.21</td>
</tr>
<tr class="odd">
<td>Stacked Bidirectional GRU</td>
<td>Yes</td>
<td>0.04</td>
<td>0.26</td>
</tr>
<tr class="even">
<td>Bidirectional LSTM</td>
<td>No</td>
<td>0.04</td>
<td>0.22</td>
</tr>
<tr class="odd">
<td>Bidirectional LSTM</td>
<td>Yes</td>
<td>0.04</td>
<td>0.23</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="how-far-into-the-future-can-we-predict" class="level1">
<h1>How Far Into The Future Can We Predict?</h1>
<p>Up until this point, we assessed the models’ prediction power for 2 years. Now, we will assess the models’ prediction power for 5 years. For this exercise, we shall pick the best performing models (from the three unique models - Simple RNN, GRU, and Bidirectional LSTM), which include the following:</p>
<ol type="1">
<li><p>Simple RNN with L2 Regularization</p></li>
<li><p>GRU with L2 Regularization</p></li>
<li><p>Bidirectional LSTM (no regularization)</p></li>
</ol>
<div class="cell" data-execution_count="61">
<div class="cell-output cell-output-stdout">
<pre><code>(552,)
(60,)</code></pre>
</div>
</div>
<section id="simple-rnn-with-l2-regularization" class="level2">
<h2 class="anchored" data-anchor-id="simple-rnn-with-l2-regularization">Simple RNN with L2 Regularization</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Visualize Fitting History</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Visualize Parity Plot (Unnormalized Data)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Visualize Predictions (Unnormalized Data)</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell" data-execution_count="65">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 0s 34ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 41ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00253 RMSE = 0.05026
Test MSE = 0.02898 RMSE = 0.17023</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="8d814896-8f69-47e8-8534-bc45ef95da9b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8d814896-8f69-47e8-8534-bc45ef95da9b")) {                    Plotly.newPlot(                        "8d814896-8f69-47e8-8534-bc45ef95da9b",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[0.0403025858104229,0.039099160581827164,0.03824682533740997,0.03775035962462425,0.03686298057436943,0.0362793430685997,0.03588130697607994,0.035203028470277786,0.03481163829565048,0.034259095788002014,0.033737387508153915,0.03330448642373085,0.03286118805408478,0.032354936003685,0.03202107176184654,0.03153986111283302,0.031098289415240288,0.030643712729215622,0.030265910550951958,0.02979295141994953,0.02938173897564411,0.028973527252674103,0.028623104095458984,0.02817850187420845,0.027800852432847023,0.02738991379737854,0.02706924080848694,0.02665024995803833,0.02627968043088913,0.025945337489247322,0.02565355785191059,0.025206029415130615,0.02485511265695095,0.024596713483333588,0.024186374619603157,0.023886309936642647,0.023575318977236748,0.023204989731311798,0.022926831617951393,0.02262110635638237,0.02232522889971733,0.0220410767942667,0.021671701222658157,0.021409325301647186,0.021105343475937843,0.020853446796536446,0.020539170131087303,0.020223768427968025,0.01997535489499569,0.019685136154294014,0.01940079964697361,0.019098853692412376,0.018839601427316666,0.018576813861727715,0.018284784629940987,0.018099898472428322,0.017768336459994316,0.01754235476255417,0.01726526953279972,0.017061499878764153,0.01676325872540474,0.01651846058666706,0.01630411297082901,0.016054527834057808,0.015830403193831444,0.015595286153256893,0.015350746922194958,0.015103996731340885,0.014908701181411743,0.01474959496408701,0.014440386556088924,0.014239061623811722,0.014049222692847252,0.013831019401550293,0.01361372135579586,0.013475584797561169,0.013193774037063122,0.013034353032708168,0.012808351777493954,0.012604975141584873,0.012461104430258274,0.012277551926672459,0.012058626860380173,0.011861845850944519,0.011685539036989212,0.011500510387122631,0.011334862560033798,0.011179537512362003,0.010980497114360332,0.01083781011402607,0.01066792942583561,0.010506668128073215,0.010356580838561058,0.010189666412770748,0.010015255771577358,0.009869588539004326,0.009698530659079552,0.009552962146699429,0.00946814101189375,0.009261470288038254],"yaxis":"y","type":"scatter"},{"mode":"lines","name":"Training","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.03309646248817444,0.03247176110744476,0.03198361396789551,0.03152497112751007,0.031123477965593338,0.03071344457566738,0.03033396042883396,0.029967712238430977,0.029645510017871857,0.0292759258300066,0.02894059382379055,0.028602827340364456,0.028271354734897614,0.027946842834353447,0.027613740414381027,0.027318459004163742,0.026960201561450958,0.026648955419659615,0.026305995881557465,0.025972913950681686,0.02566915936768055,0.025363890454173088,0.025060685351490974,0.024764232337474823,0.024451689794659615,0.024149717763066292,0.023838311433792114,0.023491710424423218,0.023197079077363014,0.02294030599296093,0.022651463747024536,0.022336022928357124,0.022066334262490273,0.021728064864873886,0.021448608487844467,0.021208252757787704,0.020930636674165726,0.020640136674046516,0.02031632699072361,0.020049454644322395,0.019777238368988037,0.01956763304769993,0.019347157329320908,0.01906616799533367,0.018772771582007408,0.018532846122980118,0.01826729252934456,0.018057703971862793,0.01781010627746582,0.017610980197787285,0.017394904047250748,0.017114249989390373,0.016789091750979424,0.016504108905792236,0.01628112979233265,0.01605464331805706,0.015869347378611565,0.015718743205070496,0.015391050837934017,0.015174290165305138,0.014931113459169865,0.01476279553025961,0.014574185945093632,0.01428204495459795,0.014071961864829063,0.013818279840052128,0.013627001084387302,0.013441345654428005,0.013180095702409744,0.01298972126096487,0.012822798453271389,0.01269543543457985,0.012541186064481735,0.012355426326394081,0.01217611227184534,0.011968076229095459,0.011730868369340897,0.011595100164413452,0.011352432891726494,0.011217013001441956,0.011031841859221458,0.01081466767936945,0.010645365342497826,0.010470316745340824,0.010395845398306847,0.010174810886383057,0.010084369219839573,0.009913169778883457,0.009703333489596844,0.00948090199381113,0.009404522366821766,0.009268847294151783,0.009070761501789093,0.008920068852603436,0.008789311163127422,0.008632436394691467,0.008582411333918571,0.008453954942524433,0.008327165618538857,0.008213896304368973],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Training Epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training Loss (Red) vs Validation Loss (Blue)"},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8d814896-8f69-47e8-8534-bc45ef95da9b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell" data-execution_count="66">
<div class="cell-output cell-output-display">

<div>                            <div id="eb47ecbf-4a70-4ee7-bdca-9321efca7c1b" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("eb47ecbf-4a70-4ee7-bdca-9321efca7c1b")) {                    Plotly.newPlot(                        "eb47ecbf-4a70-4ee7-bdca-9321efca7c1b",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[8.01449275362319,4.826086956521739,1.318840579710145,2.2753623188405796,2.5942028985507246,2.9130434782608696,2.5942028985507246,3.8695652173913038,2.5942028985507246,4.826086956521739,3.231884057971015,4.188405797101449,1.63768115942029,4.507246376811594,3.8695652173913038,2.2753623188405796,3.231884057971015,1.63768115942029,2.2753623188405796,3.231884057971015,1.63768115942029,1.63768115942029,2.5942028985507246,2.2753623188405796,1.318840579710145,1.9565217391304348,1.318840579710145,2.2753623188405796,2.2753623188405796,3.550724637681159,2.2753623188405796,1.9565217391304348,1.9565217391304348,1.318840579710145,4.188405797101449,3.231884057971015,1.318840579710145,4.507246376811594,1.63768115942029,1.63768115942029,1.0,1.9565217391304348,1.9565217391304348,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.318840579710145,1.9565217391304348,1.63768115942029,1.318840579710145,3.231884057971015],"xaxis":"x","y":[5.979947090148926,6.267246723175049,2.5140113830566406,2.5271828174591064,2.456575393676758,4.673430919647217,5.309194087982178,2.2134976387023926,2.800144910812378,2.4694292545318604,2.7269532680511475,2.948913097381592,2.8157005310058594,2.673168659210205,2.6930644512176514,2.3177223205566406,2.380643129348755,3.1297214031219482,2.7756972312927246,2.055678606033325,2.2073988914489746,1.9172451496124268,2.469667434692383,2.7750730514526367,2.0203866958618164,2.065380811691284,2.1933419704437256,2.5194008350372314,2.071542501449585,3.5576674938201904,2.331188678741455,2.4583587646484375,1.960256576538086,2.374847412109375,1.9582240581512451,2.430063486099243,2.0963969230651855,2.0592989921569824,2.527292251586914,2.2324612140655518,2.2156858444213867,2.227285385131836,1.9040623903274536,1.9652621746063232,2.0441195964813232,2.5044021606445312,1.9151091575622559,2.0923614501953125,2.1983354091644287,1.9293954372406006,2.1326146125793457,2.899031162261963,1.936091423034668,2.412222146987915,2.0379185676574707],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[5.0,5.0,10.0,8.0,5.999999999999999],"y":[4.806430816650391,3.1789376735687256,1.943547010421753,7.16718053817749,4.917530536651611],"type":"scatter"},{"mode":"lines","x":[8.01449275362319,4.826086956521739,1.318840579710145,2.2753623188405796,2.5942028985507246,2.9130434782608696,2.5942028985507246,3.8695652173913038,2.5942028985507246,4.826086956521739,3.231884057971015,4.188405797101449,1.63768115942029,4.507246376811594,3.8695652173913038,2.2753623188405796,3.231884057971015,1.63768115942029,2.2753623188405796,3.231884057971015,1.63768115942029,1.63768115942029,2.5942028985507246,2.2753623188405796,1.318840579710145,1.9565217391304348,1.318840579710145,2.2753623188405796,2.2753623188405796,3.550724637681159,2.2753623188405796,1.9565217391304348,1.9565217391304348,1.318840579710145,4.188405797101449,3.231884057971015,1.318840579710145,4.507246376811594,1.63768115942029,1.63768115942029,1.0,1.9565217391304348,1.9565217391304348,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.318840579710145,1.9565217391304348,1.63768115942029,1.318840579710145,3.231884057971015],"y":[8.01449275362319,4.826086956521739,1.318840579710145,2.2753623188405796,2.5942028985507246,2.9130434782608696,2.5942028985507246,3.8695652173913038,2.5942028985507246,4.826086956521739,3.231884057971015,4.188405797101449,1.63768115942029,4.507246376811594,3.8695652173913038,2.2753623188405796,3.231884057971015,1.63768115942029,2.2753623188405796,3.231884057971015,1.63768115942029,1.63768115942029,2.5942028985507246,2.2753623188405796,1.318840579710145,1.9565217391304348,1.318840579710145,2.2753623188405796,2.2753623188405796,3.550724637681159,2.2753623188405796,1.9565217391304348,1.9565217391304348,1.318840579710145,4.188405797101449,3.231884057971015,1.318840579710145,4.507246376811594,1.63768115942029,1.63768115942029,1.0,1.9565217391304348,1.9565217391304348,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.318840579710145,1.9565217391304348,1.63768115942029,1.318840579710145,3.231884057971015],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('eb47ecbf-4a70-4ee7-bdca-9321efca7c1b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell" data-execution_count="67">
<div class="cell-output cell-output-display">
<p><img src="Deep-Learning_files/figure-html/cell-68-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="gru-with-l2-regularization" class="level2">
<h2 class="anchored" data-anchor-id="gru-with-l2-regularization">GRU with L2 Regularization</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Visualize Fitting History</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Visualize Parity Plot (Unnormalized Data)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Visualize Predictions (Unnormalized Data)</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell" data-execution_count="71">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 0s 35ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 38ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00185 RMSE = 0.04297
Test MSE = 0.02409 RMSE = 0.15521</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="0c1a14e0-7569-448b-8140-7b9ead40f9e4" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("0c1a14e0-7569-448b-8140-7b9ead40f9e4")) {                    Plotly.newPlot(                        "0c1a14e0-7569-448b-8140-7b9ead40f9e4",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[0.03446871414780617,0.03341825306415558,0.03255404531955719,0.03188684210181236,0.03129979223012924,0.030608711764216423,0.03009009175002575,0.029532931745052338,0.02906113676726818,0.02849547751247883,0.027960311621427536,0.027414826676249504,0.02698967419564724,0.02646012417972088,0.025973735377192497,0.02548270858824253,0.025060860440135002,0.024597233161330223,0.024079017341136932,0.023683764040470123,0.02334456518292427,0.02283629961311817,0.022434638813138008,0.02195061556994915,0.021571556106209755,0.021191807463765144,0.020771151408553123,0.020382294431328773,0.020061440765857697,0.019601356238126755,0.01921302266418934,0.018854649737477303,0.018479084596037865,0.01816985197365284,0.017852451652288437,0.01741027645766735,0.017071910202503204,0.01673971861600876,0.0164375901222229,0.016087669879198074,0.01577877253293991,0.015489265322685242,0.015116116963326931,0.014797507785260677,0.014536908827722073,0.014239484444260597,0.013928379863500595,0.013630303554236889,0.013351633213460445,0.013083717785775661,0.01278698816895485,0.012491838075220585,0.01231639739125967,0.012011685408651829,0.011720282025635242,0.011476358398795128,0.011237883009016514,0.010985448025166988,0.010752894915640354,0.010539292357861996,0.010305455885827541,0.010083820670843124,0.009857161901891232,0.009694498032331467,0.009405557066202164,0.009202161803841591,0.009022844024002552,0.008809947408735752,0.008621418848633766,0.00842604972422123,0.00821820367127657,0.00807244423776865,0.007880664430558681,0.007677240762859583,0.007518589496612549,0.007359577342867851,0.007191393990069628,0.007034147158265114,0.006899713072925806,0.0067039611749351025,0.006571349687874317,0.006442071869969368,0.006324616260826588,0.006157067604362965,0.006005028262734413,0.00587570620700717,0.005756397731602192,0.005644825287163258,0.0055394480004906654,0.005413946695625782,0.005286723840981722,0.005178314168006182,0.005076529458165169,0.004959198646247387,0.004888624418526888,0.004762938246130943,0.004659135360270739,0.004611477255821228,0.004480922594666481,0.00452511478215456],"yaxis":"y","type":"scatter"},{"mode":"lines","name":"Training","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.02978397160768509,0.028961719945073128,0.02836875431239605,0.027729002758860588,0.027215803042054176,0.026727980002760887,0.026235826313495636,0.025771377608180046,0.02529085800051689,0.024830369278788567,0.024382056668400764,0.023948444053530693,0.023511527106165886,0.023082219064235687,0.022664017975330353,0.02224987931549549,0.0218362957239151,0.02143368497490883,0.021031316369771957,0.020636633038520813,0.02024930901825428,0.01986781507730484,0.01949336938560009,0.019125178456306458,0.01876217871904373,0.01839720644056797,0.01804651878774166,0.017704352736473083,0.01737038977444172,0.01702129654586315,0.016678672283887863,0.016355469822883606,0.016022609546780586,0.015729552134871483,0.015412873588502407,0.01509429793804884,0.014790576882660389,0.01449278648942709,0.0142029644921422,0.013899710960686207,0.013653431087732315,0.01333997305482626,0.013045351952314377,0.01279434934258461,0.012570708058774471,0.012258749455213547,0.01200280524790287,0.011775449849665165,0.011529223062098026,0.011275139637291431,0.01102591585367918,0.010756843723356724,0.010540390387177467,0.01030204351991415,0.010089002549648285,0.009818725287914276,0.009554561227560043,0.00935428962111473,0.009121648035943508,0.008988466113805771,0.008801798336207867,0.008570906706154346,0.008310413919389248,0.008163622580468655,0.008036276325583458,0.007844587787985802,0.007705922704190016,0.0074177952483296394,0.007255850359797478,0.007099709939211607,0.006998257711529732,0.006766775622963905,0.006693735718727112,0.006475340109318495,0.006429338362067938,0.006255395244807005,0.0060078757815063,0.005879118572920561,0.0056913867592811584,0.005580191500484943,0.005351505242288113,0.005354682449251413,0.005231472663581371,0.005076591856777668,0.004929250106215477,0.004788494668900967,0.004762785043567419,0.004540048539638519,0.004480860661715269,0.004371799062937498,0.0043741250410676,0.004216616507619619,0.0041091847233474255,0.004109235014766455,0.003922143019735813,0.003924526274204254,0.0037363297306001186,0.0036226101219654083,0.003573442343622446,0.003464425215497613],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Training Epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training Loss (Red) vs Validation Loss (Blue)"},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('0c1a14e0-7569-448b-8140-7b9ead40f9e4');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell" data-execution_count="72">
<div class="cell-output cell-output-display">

<div>                            <div id="3cda03a5-1e63-4efd-b867-c71e4c62f843" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("3cda03a5-1e63-4efd-b867-c71e4c62f843")) {                    Plotly.newPlot(                        "3cda03a5-1e63-4efd-b867-c71e4c62f843",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[8.01449275362319,4.826086956521739,1.318840579710145,2.2753623188405796,2.5942028985507246,2.9130434782608696,2.5942028985507246,3.8695652173913038,2.5942028985507246,4.826086956521739,3.231884057971015,4.188405797101449,1.63768115942029,4.507246376811594,3.8695652173913038,2.2753623188405796,3.231884057971015,1.63768115942029,2.2753623188405796,3.231884057971015,1.63768115942029,1.63768115942029,2.5942028985507246,2.2753623188405796,1.318840579710145,1.9565217391304348,1.318840579710145,2.2753623188405796,2.2753623188405796,3.550724637681159,2.2753623188405796,1.9565217391304348,1.9565217391304348,1.318840579710145,4.188405797101449,3.231884057971015,1.318840579710145,4.507246376811594,1.63768115942029,1.63768115942029,1.0,1.9565217391304348,1.9565217391304348,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.318840579710145,1.9565217391304348,1.63768115942029,1.318840579710145,3.231884057971015],"xaxis":"x","y":[6.842930793762207,5.973597049713135,2.605499267578125,2.6067280769348145,2.5874581336975098,3.75297474861145,4.310536861419678,3.1209263801574707,3.1896352767944336,2.6928598880767822,2.5281341075897217,3.0331318378448486,2.7117555141448975,2.6748507022857666,2.945037603378296,2.290226697921753,2.2840514183044434,2.8199045658111572,2.4400665760040283,1.9683444499969482,2.3273561000823975,1.89785635471344,2.2188003063201904,2.3501789569854736,2.0661253929138184,1.9840264320373535,2.0233185291290283,2.3544082641601562,2.3223960399627686,3.161555767059326,2.242947578430176,2.3141427040100098,2.172886610031128,2.1216018199920654,1.8083630800247192,2.454636812210083,1.94864821434021,2.02526593208313,2.7213637828826904,2.2927465438842773,1.9491528272628784,1.8935277462005615,1.7704551219940186,1.836456060409546,1.9303630590438843,2.2221620082855225,1.7531708478927612,1.8799916505813599,2.0007948875427246,1.747235894203186,1.979928731918335,2.3404390811920166,1.7554594278335571,2.327486991882324,2.1399123668670654],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[5.0,5.0,10.0,8.0,5.999999999999999],"y":[5.899129390716553,3.6887874603271484,2.846604585647583,6.35098123550415,4.630124568939209],"type":"scatter"},{"mode":"lines","x":[8.01449275362319,4.826086956521739,1.318840579710145,2.2753623188405796,2.5942028985507246,2.9130434782608696,2.5942028985507246,3.8695652173913038,2.5942028985507246,4.826086956521739,3.231884057971015,4.188405797101449,1.63768115942029,4.507246376811594,3.8695652173913038,2.2753623188405796,3.231884057971015,1.63768115942029,2.2753623188405796,3.231884057971015,1.63768115942029,1.63768115942029,2.5942028985507246,2.2753623188405796,1.318840579710145,1.9565217391304348,1.318840579710145,2.2753623188405796,2.2753623188405796,3.550724637681159,2.2753623188405796,1.9565217391304348,1.9565217391304348,1.318840579710145,4.188405797101449,3.231884057971015,1.318840579710145,4.507246376811594,1.63768115942029,1.63768115942029,1.0,1.9565217391304348,1.9565217391304348,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.318840579710145,1.9565217391304348,1.63768115942029,1.318840579710145,3.231884057971015],"y":[8.01449275362319,4.826086956521739,1.318840579710145,2.2753623188405796,2.5942028985507246,2.9130434782608696,2.5942028985507246,3.8695652173913038,2.5942028985507246,4.826086956521739,3.231884057971015,4.188405797101449,1.63768115942029,4.507246376811594,3.8695652173913038,2.2753623188405796,3.231884057971015,1.63768115942029,2.2753623188405796,3.231884057971015,1.63768115942029,1.63768115942029,2.5942028985507246,2.2753623188405796,1.318840579710145,1.9565217391304348,1.318840579710145,2.2753623188405796,2.2753623188405796,3.550724637681159,2.2753623188405796,1.9565217391304348,1.9565217391304348,1.318840579710145,4.188405797101449,3.231884057971015,1.318840579710145,4.507246376811594,1.63768115942029,1.63768115942029,1.0,1.9565217391304348,1.9565217391304348,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.318840579710145,1.9565217391304348,1.63768115942029,1.318840579710145,3.231884057971015],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('3cda03a5-1e63-4efd-b867-c71e4c62f843');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell" data-execution_count="73">
<div class="cell-output cell-output-display">
<p><img src="Deep-Learning_files/figure-html/cell-74-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="bidirectional-lstm-no-regularization" class="level2">
<h2 class="anchored" data-anchor-id="bidirectional-lstm-no-regularization">Bidirectional LSTM (no regularization)</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Visualize Fitting History</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Visualize Parity Plot (Unnormalized Data)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Visualize Predictions (Unnormalized Data)</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell" data-execution_count="77">
<div class="cell-output cell-output-stdout">
<pre><code>1/2 [==============&gt;...............] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 0s 58ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - ETA: 0s</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 120ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Train MSE = 0.00157 RMSE = 0.03963
Test MSE = 0.02184 RMSE = 0.14778</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="c15cbeee-50b0-4a0f-bc9b-ef86044d860a" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c15cbeee-50b0-4a0f-bc9b-ef86044d860a")) {                    Plotly.newPlot(                        "c15cbeee-50b0-4a0f-bc9b-ef86044d860a",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"xaxis":"x","y":[0.0054625775665044785,0.004602161701768637,0.004200708586722612,0.00397581048309803,0.003800171660259366,0.003551913658156991,0.00340849906206131,0.003178786486387253,0.003072671825066209,0.0029821658972650766,0.002773275366052985,0.002749248407781124,0.0025752431247383356,0.002487317193299532,0.0024384960997849703,0.002361429389566183,0.002257600659504533,0.002211251761764288,0.0021522731985896826,0.0020691787358373404,0.0021355347707867622,0.001999044558033347,0.0019524071831256151,0.0019436120055615902,0.0019361271988600492,0.001890016719698906,0.0018694075988605618,0.0018724919063970447,0.001856719609349966,0.0019567152485251427,0.0018304469995200634,0.0018379099201411009,0.0018158081220462918,0.001802555052563548,0.0018182408530265093,0.0018146262736991048,0.0018387113232165575],"yaxis":"y","type":"scatter"},{"mode":"lines","name":"Training","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[0.0005657717701978981,0.0007009385735727847,0.0006664494867436588,0.0006920286105014384,0.0006560744368471205,0.0006319935782812536,0.0006114118150435388,0.0005468960152938962,0.0005574813112616539,0.0005184875335544348,0.0005290805129334331,0.0005310276756063104,0.0005213760305196047,0.0005134931416250765,0.0005177659331820905,0.0005207275389693677,0.0005201302119530737,0.0005251975380815566,0.0005271887639537454,0.0005613933899439871,0.000559749489184469,0.0005490264156833291,0.000567943265195936,0.0005952889332547784,0.0005840597441419959,0.0006236904300749302,0.0006538978777825832,0.0006912556127645075,0.0007759913569316268,0.000727573991753161,0.0006749432650394738,0.0007498674676753581,0.0007269722991622984,0.0007102233357727528,0.0007143737166188657,0.00068101123906672,0.0007375655113719404],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Number of Training Epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Training Loss (Red) vs Validation Loss (Blue)"},"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('c15cbeee-50b0-4a0f-bc9b-ef86044d860a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell" data-execution_count="78">
<div class="cell-output cell-output-display">

<div>                            <div id="87d03294-aff8-4165-ba6d-3e0e82861ad7" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("87d03294-aff8-4165-ba6d-3e0e82861ad7")) {                    Plotly.newPlot(                        "87d03294-aff8-4165-ba6d-3e0e82861ad7",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[8.01449275362319,4.826086956521739,1.318840579710145,2.2753623188405796,2.5942028985507246,2.9130434782608696,2.5942028985507246,3.8695652173913038,2.5942028985507246,4.826086956521739,3.231884057971015,4.188405797101449,1.63768115942029,4.507246376811594,3.8695652173913038,2.2753623188405796,3.231884057971015,1.63768115942029,2.2753623188405796,3.231884057971015,1.63768115942029,1.63768115942029,2.5942028985507246,2.2753623188405796,1.318840579710145,1.9565217391304348,1.318840579710145,2.2753623188405796,2.2753623188405796,3.550724637681159,2.2753623188405796,1.9565217391304348,1.9565217391304348,1.318840579710145,4.188405797101449,3.231884057971015,1.318840579710145,4.507246376811594,1.63768115942029,1.63768115942029,1.0,1.9565217391304348,1.9565217391304348,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.318840579710145,1.9565217391304348,1.63768115942029,1.318840579710145,3.231884057971015],"xaxis":"x","y":[7.366649627685547,5.704391956329346,2.952493906021118,2.6231675148010254,2.4879701137542725,3.4410712718963623,4.1888580322265625,3.7809524536132812,3.2702555656433105,3.2729811668395996,2.693474054336548,2.9169297218322754,2.6653048992156982,2.6696107387542725,2.922912120819092,2.399637222290039,2.2327377796173096,2.699105978012085,2.1621766090393066,2.1040780544281006,2.4588308334350586,1.8860604763031006,2.0335445404052734,2.2334399223327637,2.064690589904785,1.98451828956604,1.8972554206848145,2.2336974143981934,2.4625487327575684,2.6943094730377197,2.3769962787628174,2.18229603767395,2.394073009490967,1.8525421619415283,1.9079653024673462,2.4507248401641846,2.013380765914917,2.1093316078186035,2.6313364505767822,2.056525707244873,1.9195222854614258,1.6565349102020264,1.7379417419433594,1.628461241722107,1.6902117729187012,1.8766958713531494,1.6147096157073975,1.7230926752090454,1.8448225259780884,1.6102442741394043,1.8090003728866577,1.9686002731323242,1.608061671257019,2.1807830333709717,2.144223690032959],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[5.0,5.0,10.0,8.0,5.999999999999999],"y":[5.10646390914917,4.28394079208374,3.340916395187378,5.758261680603027,4.280174732208252],"type":"scatter"},{"mode":"lines","x":[8.01449275362319,4.826086956521739,1.318840579710145,2.2753623188405796,2.5942028985507246,2.9130434782608696,2.5942028985507246,3.8695652173913038,2.5942028985507246,4.826086956521739,3.231884057971015,4.188405797101449,1.63768115942029,4.507246376811594,3.8695652173913038,2.2753623188405796,3.231884057971015,1.63768115942029,2.2753623188405796,3.231884057971015,1.63768115942029,1.63768115942029,2.5942028985507246,2.2753623188405796,1.318840579710145,1.9565217391304348,1.318840579710145,2.2753623188405796,2.2753623188405796,3.550724637681159,2.2753623188405796,1.9565217391304348,1.9565217391304348,1.318840579710145,4.188405797101449,3.231884057971015,1.318840579710145,4.507246376811594,1.63768115942029,1.63768115942029,1.0,1.9565217391304348,1.9565217391304348,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.318840579710145,1.9565217391304348,1.63768115942029,1.318840579710145,3.231884057971015],"y":[8.01449275362319,4.826086956521739,1.318840579710145,2.2753623188405796,2.5942028985507246,2.9130434782608696,2.5942028985507246,3.8695652173913038,2.5942028985507246,4.826086956521739,3.231884057971015,4.188405797101449,1.63768115942029,4.507246376811594,3.8695652173913038,2.2753623188405796,3.231884057971015,1.63768115942029,2.2753623188405796,3.231884057971015,1.63768115942029,1.63768115942029,2.5942028985507246,2.2753623188405796,1.318840579710145,1.9565217391304348,1.318840579710145,2.2753623188405796,2.2753623188405796,3.550724637681159,2.2753623188405796,1.9565217391304348,1.9565217391304348,1.318840579710145,4.188405797101449,3.231884057971015,1.318840579710145,4.507246376811594,1.63768115942029,1.63768115942029,1.0,1.9565217391304348,1.9565217391304348,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.0,1.318840579710145,1.318840579710145,1.318840579710145,1.9565217391304348,1.63768115942029,1.318840579710145,3.231884057971015],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('87d03294-aff8-4165-ba6d-3e0e82861ad7');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell" data-execution_count="79">
<div class="cell-output cell-output-display">
<p><img src="Deep-Learning_files/figure-html/cell-80-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="discussion-7" class="level2">
<h2 class="anchored" data-anchor-id="discussion-7">Discussion</h2>
<p>Wow, the LSTM model outputs the lowest RMSE when the size of the test set is increased! This is a very interesting result, and it is likely due to the fact that the LSTM model is better able to capture the seasonality of the data when testing for number of attacks after 2016. Therefore, when predicting more time steps in the future, the LSTM model is better able to generalize to unseen data and could be recommended for future use.</p>
</section>
</section>
<section id="comparison-with-arima-and-sarima" class="level1">
<h1>Comparison with ARIMA and SARIMA</h1>
<p>From the <a href="https://tegveerg.georgetown.domains/Time-Series-Project/ARMA-ARIMA-SARIMA.html">ARMA/ARIMA/SARIMA section</a>, we observed that both the ARIMA models, <code>ARIMA(0,1,1)</code> AND <code>ARIMA(2,1,3)</code>, were subpar at forecasting the number of attacks for 2 years. The forecasting results of ARIMA are shown below:</p>
<p><img src="ARIMA_forecast.png" class="img-fluid"></p>
<p>The SARIMA model (<code>ARIMA(0,1,1)(0,1,1)</code>), on the other hand, was better able to capture both the seasonality and trend in the data, and was able to forecast the number of attacks for 2 years with a Train RMSE of 4.317518. Although this RMSE metric for SARIMA is significantly higher than those of all the Recurrent Neural Networks tested in this section, it should be noted that relatively simpler models, including SARIMA, are still powerful in forecasting the number of attacks for the next 3 years. Moreover, we also employed Seasonal Cross-Validation for 1 step ahead (RMSE = 7.41) and 12 steps ahead forecasting (MSE = 30). Although these results seem significantly worse than those of all the Recurrent Neural Networks tested in this section, it should be noted that the SARIMA model is still able to capture the seasonality and trend in the data. Therefore, it can help us strike the balance between predictive power, interpretability, and computational efficiency. The forecasting results of SARIMA are shown below:</p>
<p><img src="SARIMA_forecast.png" class="img-fluid"></p>
<p>A major limitation for this section was the amount of data inputted to each model. It is recommended to feed in enormous amounts of data to RNNs for them to learn better representations of the model and help “capture seasonality”, in our case. Elaborate hyper-parameter tuning methods, such as GridSearch CV, could also be utilized to fine-tune the performance of the model for better results.</p>
<section id="section-code" class="level2">
<h2 class="anchored" data-anchor-id="section-code">Section Code</h2>
<p><strong>Code for this section can be found <a href="https://github.com/TegveerG/Time-Series-Project/blob/main/Time%20Series%20Analysis/Deep-Learning.qmd">here</a></strong></p>


<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-chollet2021deep" class="csl-entry" role="doc-biblioentry">
Chollet, François. 2021. <em>Deep Learning with Python, Second Edition</em>. Manning Publications.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb209" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Deep Learning for Time Series</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> bibliography.bib</span></span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a><span class="fu"># Summary</span></span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a>After fitting several time-series models to both monthly as well as yearly aggregated terrorist attacks data and financial data in the previous sections, we will now focus on the efficacy of Deep Learning models in helping us predict the monthly number of terrorist attacks, the same univariate time-series data employed in the <span class="co">[</span><span class="ot">ARMA/ARIMA/SARIMA section</span><span class="co">](https://tegveerg.georgetown.domains/Time-Series-Project/ARMA-ARIMA-SARIMA.html)</span>. We shall employ popular Recurrent Neural Networks (RNNs), including a Dense RNN, a Gated Recurrent Unit (GRU), and a Long Short-Term Memory Network (LSTM), with and without L2 regularization, a method to curb overfitting by forcing the weights of the parameters to decay towards zero, to predict the number number of terrorist attacks per month in the future. Doing so will help us compare not only the performance of the three RNNs, but also the performance of the three RNNs to that of the traditional univariate time-series models, ARIMA and SARIMA. Lastly, we shall discuss the effect of regularization on the results of our RNNs, assess how far into the future the RNNs can accurately predict the future, and compare the results of the trained deep learning models to the traditional single-variable time-series ARMA/ARIMA models.</span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>To train these models, we use Python's *Keras* library, a wrapper for *Tensorflow* and take inspiration from Francois Chollet's Deep Learning in Python, Second Edition, Book <span class="co">[</span><span class="ot">@chollet2021deep</span><span class="co">]</span>. Visualizations of the architecture of a simple RNN and LSTM are shown below:</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a><span class="al">![](RNN_Chollet.png)</span></span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;center&gt;&lt;em&gt;</span>A simple RNN, unrolled over time<span class="kw">&lt;/em&gt;&lt;/center&gt;</span></span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span></span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a><span class="al">![](LSTM_Chollet.png)</span></span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;center&gt;&lt;em&gt;</span>Anatomy of an LSTM<span class="kw">&lt;/em&gt;&lt;/center&gt;</span></span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb209-32"><a href="#cb209-32" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span></span>
<span id="cb209-33"><a href="#cb209-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-34"><a href="#cb209-34" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overall Training Parameter Methodology</span></span>
<span id="cb209-35"><a href="#cb209-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-36"><a href="#cb209-36" aria-hidden="true" tabindex="-1"></a>These are the parameters that are used to define and train the models:</span>
<span id="cb209-37"><a href="#cb209-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-38"><a href="#cb209-38" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`recurrent_hidden_units`</span>: This is the number of recurrent hidden units in the Simple RNN layer of the model. The more hidden units, the more complex the model can be and the more features it can potentially learn. However, increasing the number of hidden units also increases the number of parameters in the model and can lead to overfitting.</span>
<span id="cb209-39"><a href="#cb209-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-40"><a href="#cb209-40" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="in">`epochs`</span>: This is the number of times the model is trained on the entire training dataset. Each epoch consists of one forward pass and one backward pass through the model. The default value of 100 epochs is used for all models.</span>
<span id="cb209-41"><a href="#cb209-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-42"><a href="#cb209-42" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="in">`f_batch`</span>: This is the fraction of the training dataset that is used for each batch during training. Batches are used to update the model parameters more frequently and efficiently than training on the entire dataset at once. The value of f_batch is multiplied by the total number of samples in the training dataset to determine the batch size and we shall be using a default value of 20% or 0.2.</span>
<span id="cb209-43"><a href="#cb209-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-44"><a href="#cb209-44" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span><span class="in">`optimizer`</span>: This is the optimization algorithm used to update the model parameters during training. The RMSprop optimizer is a popular choice for deep learning tasks that involve recurrent neural networks. Other state-of-the-art optimizers include Adam and Nadam. RMSprop is used for all models.</span>
<span id="cb209-45"><a href="#cb209-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-46"><a href="#cb209-46" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span><span class="in">`validation_split`</span>: This is the fraction of the training dataset that is used for validation during training. The validation dataset is used to monitor the performance of the model during training and to prevent overfitting. A value of 0.2 for validation_split means that 20% of the training data will be held out for validation, and the remaining 80% will be used for training.</span>
<span id="cb209-47"><a href="#cb209-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-48"><a href="#cb209-48" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span><span class="in">`activation`</span>: This is the activation function used for the recurrent hidden units in the model. The vanishing gradient problem is the primary problem in RNNs. To ensure the gradients stay in the linear region of the activation function, we need a function whose second derivative can sustain for a long range before going to zero. <span class="in">`tanh`</span>, as a result, satisfies these properties better than <span class="in">`ReLU`</span> activation does. The Rectified Linear Unit (ReLU) activation function is unbounded on the positive side, meaning that its output can take any positive value. The hyperbolic tangent (tanh) activation function, however, is bounded both on the positive and negative sides. Note: Only for the Bidirectional LSTM model, we use <span class="in">`ReLU`</span> activation for the recurrent hidden units.</span>
<span id="cb209-49"><a href="#cb209-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-50"><a href="#cb209-50" aria-hidden="true" tabindex="-1"></a><span class="fu"># Read in Data and Normalize</span></span>
<span id="cb209-51"><a href="#cb209-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-52"><a href="#cb209-52" aria-hidden="true" tabindex="-1"></a>When working with Deep Learning models, it is advisable to scale our features to a range of values, for example 0-1 range <span class="co">[</span><span class="ot">@chollet2021deep</span><span class="co">]</span>. Even though our exercise focuses on univariate data, it is still imperative to normalize the monthly count of terrorist attacks. In general, it isn’t safe to feed into a neural network data that takes relatively large values or data that is heterogeneous. Doing so can trigger large gradient updates that will prevent the network from converging. To make learning easier for our network, the the univariate monthly number of attacks data should take small values. Typically, most values should be in the 0–1 range.</span>
<span id="cb209-53"><a href="#cb209-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-54"><a href="#cb209-54" aria-hidden="true" tabindex="-1"></a>Essentially, advantages of normalizing the features include:</span>
<span id="cb209-55"><a href="#cb209-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-56"><a href="#cb209-56" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Prevents issues with vanishing or exploding gradients: When the input features to a neural network have very different scales, it can cause issues with the gradients during backpropagation. If some features have very large values and others have very small values, the gradients for the small features can become very small, or even zero, which can slow down or prevent the convergence of the optimization process. </span>
<span id="cb209-57"><a href="#cb209-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-58"><a href="#cb209-58" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Helps to optimize the model more efficiently: When the input features are normalized, it can help to improve the optimization process by ensuring that the gradients are more consistent across all of the features. This can help to prevent the optimization process from getting stuck in local minima and can lead to faster convergence.</span>
<span id="cb209-59"><a href="#cb209-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-60"><a href="#cb209-60" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Improves generalization: Normalizing the features can help to improve the generalization performance of the neural network by reducing the effects of outliers or extreme values in the input features. By scaling the features to a similar range, the neural network is less likely to overfit to extreme values in the training set and is more likely to generalize well to unseen data.</span>
<span id="cb209-61"><a href="#cb209-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-64"><a href="#cb209-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-65"><a href="#cb209-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-66"><a href="#cb209-66" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-67"><a href="#cb209-67" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-68"><a href="#cb209-68" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb209-69"><a href="#cb209-69" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb209-70"><a href="#cb209-70" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb209-71"><a href="#cb209-71" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb209-72"><a href="#cb209-72" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb209-73"><a href="#cb209-73" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> SimpleRNN, Dense, LSTM, GRU, Bidirectional</span>
<span id="cb209-74"><a href="#cb209-74" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> regularizers</span>
<span id="cb209-75"><a href="#cb209-75" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb209-76"><a href="#cb209-76" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> RMSprop</span>
<span id="cb209-77"><a href="#cb209-77" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb209-78"><a href="#cb209-78" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb209-79"><a href="#cb209-79" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb209-80"><a href="#cb209-80" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb209-81"><a href="#cb209-81" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb209-82"><a href="#cb209-82" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb209-83"><a href="#cb209-83" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb209-84"><a href="#cb209-84" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">82716</span>)</span>
<span id="cb209-85"><a href="#cb209-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-86"><a href="#cb209-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-89"><a href="#cb209-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-90"><a href="#cb209-90" aria-hidden="true" tabindex="-1"></a><span class="co"># read in data and convert to numpy array</span></span>
<span id="cb209-91"><a href="#cb209-91" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">"univariate_train.csv"</span>)</span>
<span id="cb209-92"><a href="#cb209-92" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">"univariate_test.csv"</span>)</span>
<span id="cb209-93"><a href="#cb209-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-94"><a href="#cb209-94" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> np.array(train.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-95"><a href="#cb209-95" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> np.array(test.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-96"><a href="#cb209-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-97"><a href="#cb209-97" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize values</span></span>
<span id="cb209-98"><a href="#cb209-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-99"><a href="#cb209-99" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb209-100"><a href="#cb209-100" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> scaler.fit_transform(train_data).flatten()</span>
<span id="cb209-101"><a href="#cb209-101" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> scaler.fit_transform(test_data).flatten()</span>
<span id="cb209-102"><a href="#cb209-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-103"><a href="#cb209-103" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Train Data Shape: "</span>, train_data.shape)</span>
<span id="cb209-104"><a href="#cb209-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test Data Shape: "</span>, test_data.shape)</span>
<span id="cb209-105"><a href="#cb209-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-106"><a href="#cb209-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-109"><a href="#cb209-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-110"><a href="#cb209-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-111"><a href="#cb209-111" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-112"><a href="#cb209-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-113"><a href="#cb209-113" aria-hidden="true" tabindex="-1"></a><span class="co"># utility function for producing loss (model result) visualizations</span></span>
<span id="cb209-114"><a href="#cb209-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-115"><a href="#cb209-115" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb209-116"><a href="#cb209-116" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">"plotly_mimetype+notebook_connected"</span></span>
<span id="cb209-117"><a href="#cb209-117" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb209-118"><a href="#cb209-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-119"><a href="#cb209-119" aria-hidden="true" tabindex="-1"></a><span class="co"># UTILITY</span></span>
<span id="cb209-120"><a href="#cb209-120" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plotly_line_plot(t, y, title<span class="op">=</span><span class="st">"Plot"</span>, x_label<span class="op">=</span><span class="st">"t: time (months)"</span>, y_label<span class="op">=</span><span class="st">"y(t): Response variable"</span>):</span>
<span id="cb209-121"><a href="#cb209-121" aria-hidden="true" tabindex="-1"></a>    <span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-122"><a href="#cb209-122" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> px.line(x<span class="op">=</span>t[<span class="dv">0</span>], y<span class="op">=</span>y[<span class="dv">0</span>], title<span class="op">=</span>title, render_mode<span class="op">=</span><span class="st">'SVG'</span>)  </span>
<span id="cb209-123"><a href="#cb209-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb209-124"><a href="#cb209-124" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ADD MORE</span></span>
<span id="cb209-125"><a href="#cb209-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(y)):</span>
<span id="cb209-126"><a href="#cb209-126" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(t[i]) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb209-127"><a href="#cb209-127" aria-hidden="true" tabindex="-1"></a>            fig.add_scatter(x<span class="op">=</span>t[i], y<span class="op">=</span>y[i], name<span class="op">=</span><span class="st">'Training'</span> <span class="cf">if</span> i<span class="op">==</span><span class="dv">1</span> <span class="cf">else</span> <span class="st">'Validation'</span>)</span>
<span id="cb209-128"><a href="#cb209-128" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb209-129"><a href="#cb209-129" aria-hidden="true" tabindex="-1"></a>            fig.add_scatter(x<span class="op">=</span>t[i], y<span class="op">=</span>y[i], mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'Training'</span> <span class="cf">if</span> i<span class="op">==</span><span class="dv">1</span> <span class="cf">else</span> <span class="st">'Validation'</span>)</span>
<span id="cb209-130"><a href="#cb209-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-131"><a href="#cb209-131" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(</span>
<span id="cb209-132"><a href="#cb209-132" aria-hidden="true" tabindex="-1"></a>        xaxis_title<span class="op">=</span>x_label,</span>
<span id="cb209-133"><a href="#cb209-133" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span>y_label,</span>
<span id="cb209-134"><a href="#cb209-134" aria-hidden="true" tabindex="-1"></a>        template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-135"><a href="#cb209-135" aria-hidden="true" tabindex="-1"></a>        showlegend<span class="op">=</span><span class="va">True</span></span>
<span id="cb209-136"><a href="#cb209-136" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb209-137"><a href="#cb209-137" aria-hidden="true" tabindex="-1"></a>    fig.show()</span>
<span id="cb209-138"><a href="#cb209-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-139"><a href="#cb209-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-142"><a href="#cb209-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-143"><a href="#cb209-143" aria-hidden="true" tabindex="-1"></a><span class="co"># PREPARE THE INPUT X AND TARGET Y</span></span>
<span id="cb209-144"><a href="#cb209-144" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-145"><a href="#cb209-145" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-146"><a href="#cb209-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-147"><a href="#cb209-147" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-148"><a href="#cb209-148" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-149"><a href="#cb209-149" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-150"><a href="#cb209-150" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-151"><a href="#cb209-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-152"><a href="#cb209-152" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-153"><a href="#cb209-153" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-154"><a href="#cb209-154" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-155"><a href="#cb209-155" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-156"><a href="#cb209-156" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-157"><a href="#cb209-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-158"><a href="#cb209-158" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-159"><a href="#cb209-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-160"><a href="#cb209-160" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-161"><a href="#cb209-161" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-162"><a href="#cb209-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-163"><a href="#cb209-163" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-164"><a href="#cb209-164" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-165"><a href="#cb209-165" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-166"><a href="#cb209-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-167"><a href="#cb209-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-168"><a href="#cb209-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-169"><a href="#cb209-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-170"><a href="#cb209-170" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-171"><a href="#cb209-171" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-172"><a href="#cb209-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-173"><a href="#cb209-173" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb209-174"><a href="#cb209-174" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span>
<span id="cb209-175"><a href="#cb209-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-176"><a href="#cb209-176" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"testX shape:"</span>, testX.shape, <span class="st">"testY shape:"</span>, testY.shape)</span>
<span id="cb209-177"><a href="#cb209-177" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"trainX shape:"</span>, trainX.shape, <span class="st">"trainY shape:"</span>, trainY.shape)</span>
<span id="cb209-178"><a href="#cb209-178" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(trainX))</span>
<span id="cb209-179"><a href="#cb209-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-180"><a href="#cb209-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-181"><a href="#cb209-181" aria-hidden="true" tabindex="-1"></a><span class="fu"># Training and Evaluating a Simple RNN </span></span>
<span id="cb209-182"><a href="#cb209-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-183"><a href="#cb209-183" aria-hidden="true" tabindex="-1"></a>A recurrent neural network (RNN) processes sequences by iterating through the sequence elements and maintaining a state that contains information relative to what it has seen so far. In effect, an RNN is a type of neural network that has an internal loop. The state of the RNN is reset between processing two different, independent sequences (such as two samples in a batch), so we still consider one sequence to be a single data point: a single input to the network. What changes is that this data point is no longer processed in a single step; rather, the network internally loops over sequence elements. In summary, an RNN is a for loop that reuses quantities computed</span>
<span id="cb209-184"><a href="#cb209-184" aria-hidden="true" tabindex="-1"></a>during the previous iteration of the loop, nothing more. <span class="co">[</span><span class="ot">@chollet2021deep</span><span class="co">]</span></span>
<span id="cb209-185"><a href="#cb209-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-186"><a href="#cb209-186" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model and Training Parameters</span></span>
<span id="cb209-187"><a href="#cb209-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-188"><a href="#cb209-188" aria-hidden="true" tabindex="-1"></a>The input to the model is a 3D tensor with shape (batch_size, timesteps, input_dim). The output of the RNN layer is fed into a Dense layer with a single output unit, which is used to generate a scalar output. </span>
<span id="cb209-189"><a href="#cb209-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-192"><a href="#cb209-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-193"><a href="#cb209-193" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb209-194"><a href="#cb209-194" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb209-195"><a href="#cb209-195" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb209-196"><a href="#cb209-196" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb209-197"><a href="#cb209-197" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb209-198"><a href="#cb209-198" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb209-199"><a href="#cb209-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-200"><a href="#cb209-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-201"><a href="#cb209-201" aria-hidden="true" tabindex="-1"></a><span class="fu">## Create Simple RNN Model</span></span>
<span id="cb209-202"><a href="#cb209-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-205"><a href="#cb209-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-206"><a href="#cb209-206" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb209-207"><a href="#cb209-207" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb209-208"><a href="#cb209-208" aria-hidden="true" tabindex="-1"></a>model.add(SimpleRNN(</span>
<span id="cb209-209"><a href="#cb209-209" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb209-210"><a href="#cb209-210" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb209-211"><a href="#cb209-211" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb209-212"><a href="#cb209-212" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb209-213"><a href="#cb209-213" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb209-214"><a href="#cb209-214" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb209-215"><a href="#cb209-215" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb209-216"><a href="#cb209-216" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb209-217"><a href="#cb209-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-218"><a href="#cb209-218" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb209-219"><a href="#cb209-219" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb209-220"><a href="#cb209-220" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb209-221"><a href="#cb209-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-222"><a href="#cb209-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-223"><a href="#cb209-223" aria-hidden="true" tabindex="-1"></a><span class="fu">## Train Model and Visualize Performance</span></span>
<span id="cb209-224"><a href="#cb209-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-227"><a href="#cb209-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-228"><a href="#cb209-228" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb209-229"><a href="#cb209-229" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb209-230"><a href="#cb209-230" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb209-231"><a href="#cb209-231" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb209-232"><a href="#cb209-232" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb209-233"><a href="#cb209-233" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb209-234"><a href="#cb209-234" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span>
<span id="cb209-235"><a href="#cb209-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-236"><a href="#cb209-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-237"><a href="#cb209-237" aria-hidden="true" tabindex="-1"></a>:::panel-tabset</span>
<span id="cb209-238"><a href="#cb209-238" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Fitting History</span></span>
<span id="cb209-239"><a href="#cb209-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-242"><a href="#cb209-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-243"><a href="#cb209-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-244"><a href="#cb209-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-245"><a href="#cb209-245" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-246"><a href="#cb209-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-247"><a href="#cb209-247" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb209-248"><a href="#cb209-248" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb209-249"><a href="#cb209-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-250"><a href="#cb209-250" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb209-251"><a href="#cb209-251" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb209-252"><a href="#cb209-252" aria-hidden="true" tabindex="-1"></a>unnormalized_train_predict <span class="op">=</span> scaler.inverse_transform(train_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-253"><a href="#cb209-253" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb209-254"><a href="#cb209-254" aria-hidden="true" tabindex="-1"></a>unnormalized_test_predict <span class="op">=</span> scaler.inverse_transform(test_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-255"><a href="#cb209-255" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></span>
<span id="cb209-256"><a href="#cb209-256" aria-hidden="true" tabindex="-1"></a>trainY_unnormalized <span class="op">=</span> scaler.inverse_transform(trainY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-257"><a href="#cb209-257" aria-hidden="true" tabindex="-1"></a>testY_unnormalized <span class="op">=</span> scaler.inverse_transform(testY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-258"><a href="#cb209-258" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb209-259"><a href="#cb209-259" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainY.shape, train_predict.shape)</span></span>
<span id="cb209-260"><a href="#cb209-260" aria-hidden="true" tabindex="-1"></a>train_rmse_1 <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb209-261"><a href="#cb209-261" aria-hidden="true" tabindex="-1"></a>test_rmse_1 <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb209-262"><a href="#cb209-262" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((trainY-train_predict)**2.0))</span></span>
<span id="cb209-263"><a href="#cb209-263" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((testY-test_predict)**2.0))</span></span>
<span id="cb209-264"><a href="#cb209-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-265"><a href="#cb209-265" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse_1<span class="op">**</span><span class="fl">2.0</span>,train_rmse_1))</span>
<span id="cb209-266"><a href="#cb209-266" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse_1<span class="op">**</span><span class="fl">2.0</span>,test_rmse_1))    </span>
<span id="cb209-267"><a href="#cb209-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-268"><a href="#cb209-268" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb209-269"><a href="#cb209-269" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Training Loss (Red) vs Validation Loss (Blue)"</span>,x_label<span class="op">=</span><span class="st">"Number of Training Epochs"</span>,y_label<span class="op">=</span><span class="st">"Loss (MSE)"</span>)</span>
<span id="cb209-270"><a href="#cb209-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-271"><a href="#cb209-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-272"><a href="#cb209-272" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Parity Plot (Unnormalized Data)</span></span>
<span id="cb209-273"><a href="#cb209-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-276"><a href="#cb209-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-277"><a href="#cb209-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-278"><a href="#cb209-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-279"><a href="#cb209-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-280"><a href="#cb209-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-281"><a href="#cb209-281" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb209-282"><a href="#cb209-282" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-283"><a href="#cb209-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-284"><a href="#cb209-284" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_train_predict.flatten(),height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb209-285"><a href="#cb209-285" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_test_predict.flatten(),mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb209-286"><a href="#cb209-286" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>trainY_unnormalized.flatten(), mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb209-287"><a href="#cb209-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-288"><a href="#cb209-288" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb209-289"><a href="#cb209-289" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb209-290"><a href="#cb209-290" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb209-291"><a href="#cb209-291" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-292"><a href="#cb209-292" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb209-293"><a href="#cb209-293" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-294"><a href="#cb209-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-295"><a href="#cb209-295" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb209-296"><a href="#cb209-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-297"><a href="#cb209-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-298"><a href="#cb209-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Predictions (Unnormalized Data)</span></span>
<span id="cb209-299"><a href="#cb209-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-302"><a href="#cb209-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-303"><a href="#cb209-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-304"><a href="#cb209-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-305"><a href="#cb209-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-306"><a href="#cb209-306" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-307"><a href="#cb209-307" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-308"><a href="#cb209-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-309"><a href="#cb209-309" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-310"><a href="#cb209-310" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-311"><a href="#cb209-311" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-312"><a href="#cb209-312" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-313"><a href="#cb209-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-314"><a href="#cb209-314" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-315"><a href="#cb209-315" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-316"><a href="#cb209-316" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-317"><a href="#cb209-317" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-318"><a href="#cb209-318" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-319"><a href="#cb209-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-320"><a href="#cb209-320" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-321"><a href="#cb209-321" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-322"><a href="#cb209-322" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-323"><a href="#cb209-323" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-324"><a href="#cb209-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-325"><a href="#cb209-325" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-326"><a href="#cb209-326" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-327"><a href="#cb209-327" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-328"><a href="#cb209-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-329"><a href="#cb209-329" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-330"><a href="#cb209-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-331"><a href="#cb209-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-332"><a href="#cb209-332" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-333"><a href="#cb209-333" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-334"><a href="#cb209-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-335"><a href="#cb209-335" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(np.array(test.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-336"><a href="#cb209-336" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(np.array(train.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-337"><a href="#cb209-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-338"><a href="#cb209-338" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT THE RESULT</span></span>
<span id="cb209-339"><a href="#cb209-339" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb209-340"><a href="#cb209-340" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-341"><a href="#cb209-341" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb209-342"><a href="#cb209-342" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(X.shape,Y.shape)</span></span>
<span id="cb209-343"><a href="#cb209-343" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb209-344"><a href="#cb209-344" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb209-345"><a href="#cb209-345" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb209-346"><a href="#cb209-346" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb209-347"><a href="#cb209-347" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb209-348"><a href="#cb209-348" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb209-349"><a href="#cb209-349" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of attacks'</span>)</span>
<span id="cb209-350"><a href="#cb209-350" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual vs Predicted Values'</span>)</span>
<span id="cb209-351"><a href="#cb209-351" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb209-352"><a href="#cb209-352" aria-hidden="true" tabindex="-1"></a>plot_result(trainY_unnormalized, testY_unnormalized, unnormalized_train_predict, unnormalized_test_predict)</span>
<span id="cb209-353"><a href="#cb209-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-354"><a href="#cb209-354" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb209-355"><a href="#cb209-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-356"><a href="#cb209-356" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb209-357"><a href="#cb209-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-360"><a href="#cb209-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-361"><a href="#cb209-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-362"><a href="#cb209-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-363"><a href="#cb209-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-364"><a href="#cb209-364" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb209-365"><a href="#cb209-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-366"><a href="#cb209-366" aria-hidden="true" tabindex="-1"></a>display(Markdown(</span>
<span id="cb209-367"><a href="#cb209-367" aria-hidden="true" tabindex="-1"></a><span class="ss">f"""</span></span>
<span id="cb209-368"><a href="#cb209-368" aria-hidden="true" tabindex="-1"></a><span class="ss">The train RMSE (Root Mean Squared Error) outputted by the Simple RNN model is </span><span class="sc">{</span>train_rmse_1<span class="sc">:.2f}</span><span class="ss"> and test RMSE is </span><span class="sc">{</span>test_rmse_1<span class="sc">:.2f}</span></span>
<span id="cb209-369"><a href="#cb209-369" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb209-370"><a href="#cb209-370" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb209-371"><a href="#cb209-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-372"><a href="#cb209-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-373"><a href="#cb209-373" aria-hidden="true" tabindex="-1"></a>The parity plot provides further evidence of the model's accuracy and suggests that the model's performance is better for smaller Y values, as the deviation from the line increases for larger Y values. This is likely due to the fact that the model is trained on a larger number of smaller Y values (the data contains a lot of 0 values), and thus is better at predicting smaller Y values. The *Visualize Predictions* plot shows that the model is able to predict the general trend of the data, and is able to predict the peaks and valleys of the data. The model does, to an extent, capture the seasonality of the data but not completely, implying overfitting! Let's see if we can improve the model's performance by adding L2 regularization.</span>
<span id="cb209-374"><a href="#cb209-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-375"><a href="#cb209-375" aria-hidden="true" tabindex="-1"></a><span class="fu"># Training and Evaluating a Simple RNN with L2 Regularization</span></span>
<span id="cb209-376"><a href="#cb209-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-379"><a href="#cb209-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-380"><a href="#cb209-380" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-381"><a href="#cb209-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-382"><a href="#cb209-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-383"><a href="#cb209-383" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">"univariate_train.csv"</span>)</span>
<span id="cb209-384"><a href="#cb209-384" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">"univariate_test.csv"</span>)</span>
<span id="cb209-385"><a href="#cb209-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-386"><a href="#cb209-386" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> np.array(train.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-387"><a href="#cb209-387" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> np.array(test.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-388"><a href="#cb209-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-389"><a href="#cb209-389" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize values</span></span>
<span id="cb209-390"><a href="#cb209-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-391"><a href="#cb209-391" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb209-392"><a href="#cb209-392" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> scaler.fit_transform(train_data).flatten()</span>
<span id="cb209-393"><a href="#cb209-393" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> scaler.fit_transform(test_data).flatten()</span>
<span id="cb209-394"><a href="#cb209-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-395"><a href="#cb209-395" aria-hidden="true" tabindex="-1"></a><span class="co">#print(train_data.shape)</span></span>
<span id="cb209-396"><a href="#cb209-396" aria-hidden="true" tabindex="-1"></a><span class="co">#print(test_data.shape)</span></span>
<span id="cb209-397"><a href="#cb209-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-398"><a href="#cb209-398" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-399"><a href="#cb209-399" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-400"><a href="#cb209-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-401"><a href="#cb209-401" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-402"><a href="#cb209-402" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-403"><a href="#cb209-403" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-404"><a href="#cb209-404" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-405"><a href="#cb209-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-406"><a href="#cb209-406" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-407"><a href="#cb209-407" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-408"><a href="#cb209-408" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-409"><a href="#cb209-409" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-410"><a href="#cb209-410" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-411"><a href="#cb209-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-412"><a href="#cb209-412" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-413"><a href="#cb209-413" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-414"><a href="#cb209-414" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-415"><a href="#cb209-415" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-416"><a href="#cb209-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-417"><a href="#cb209-417" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-418"><a href="#cb209-418" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-419"><a href="#cb209-419" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-420"><a href="#cb209-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-421"><a href="#cb209-421" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-422"><a href="#cb209-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-423"><a href="#cb209-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-424"><a href="#cb209-424" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-425"><a href="#cb209-425" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-426"><a href="#cb209-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-427"><a href="#cb209-427" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb209-428"><a href="#cb209-428" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span>
<span id="cb209-429"><a href="#cb209-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-430"><a href="#cb209-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-431"><a href="#cb209-431" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model and Training Parameters</span></span>
<span id="cb209-432"><a href="#cb209-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-435"><a href="#cb209-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-436"><a href="#cb209-436" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb209-437"><a href="#cb209-437" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb209-438"><a href="#cb209-438" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span> </span>
<span id="cb209-439"><a href="#cb209-439" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb209-440"><a href="#cb209-440" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb209-441"><a href="#cb209-441" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb209-442"><a href="#cb209-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-443"><a href="#cb209-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-444"><a href="#cb209-444" aria-hidden="true" tabindex="-1"></a><span class="fu">## Create Simple RNN Model With L2 Regularization</span></span>
<span id="cb209-445"><a href="#cb209-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-448"><a href="#cb209-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-449"><a href="#cb209-449" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb209-450"><a href="#cb209-450" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb209-451"><a href="#cb209-451" aria-hidden="true" tabindex="-1"></a>model.add(SimpleRNN(</span>
<span id="cb209-452"><a href="#cb209-452" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb209-453"><a href="#cb209-453" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb209-454"><a href="#cb209-454" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb209-455"><a href="#cb209-455" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb209-456"><a href="#cb209-456" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb209-457"><a href="#cb209-457" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb209-458"><a href="#cb209-458" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb209-459"><a href="#cb209-459" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb209-460"><a href="#cb209-460" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb209-461"><a href="#cb209-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-462"><a href="#cb209-462" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb209-463"><a href="#cb209-463" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb209-464"><a href="#cb209-464" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb209-465"><a href="#cb209-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-466"><a href="#cb209-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-467"><a href="#cb209-467" aria-hidden="true" tabindex="-1"></a><span class="fu">## Train Model and Visualize Performance</span></span>
<span id="cb209-468"><a href="#cb209-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-471"><a href="#cb209-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-472"><a href="#cb209-472" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb209-473"><a href="#cb209-473" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb209-474"><a href="#cb209-474" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb209-475"><a href="#cb209-475" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb209-476"><a href="#cb209-476" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb209-477"><a href="#cb209-477" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb209-478"><a href="#cb209-478" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span>
<span id="cb209-479"><a href="#cb209-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-480"><a href="#cb209-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-481"><a href="#cb209-481" aria-hidden="true" tabindex="-1"></a>:::panel-tabset</span>
<span id="cb209-482"><a href="#cb209-482" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Fitting History</span></span>
<span id="cb209-483"><a href="#cb209-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-486"><a href="#cb209-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-487"><a href="#cb209-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-488"><a href="#cb209-488" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-489"><a href="#cb209-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-490"><a href="#cb209-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-491"><a href="#cb209-491" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb209-492"><a href="#cb209-492" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb209-493"><a href="#cb209-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-494"><a href="#cb209-494" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb209-495"><a href="#cb209-495" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb209-496"><a href="#cb209-496" aria-hidden="true" tabindex="-1"></a>unnormalized_train_predict <span class="op">=</span> scaler.inverse_transform(train_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-497"><a href="#cb209-497" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb209-498"><a href="#cb209-498" aria-hidden="true" tabindex="-1"></a>unnormalized_test_predict <span class="op">=</span> scaler.inverse_transform(test_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-499"><a href="#cb209-499" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></span>
<span id="cb209-500"><a href="#cb209-500" aria-hidden="true" tabindex="-1"></a>trainY_unnormalized <span class="op">=</span> scaler.inverse_transform(trainY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-501"><a href="#cb209-501" aria-hidden="true" tabindex="-1"></a>testY_unnormalized <span class="op">=</span> scaler.inverse_transform(testY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-502"><a href="#cb209-502" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb209-503"><a href="#cb209-503" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainY.shape, train_predict.shape)</span></span>
<span id="cb209-504"><a href="#cb209-504" aria-hidden="true" tabindex="-1"></a>train_rmse_2 <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb209-505"><a href="#cb209-505" aria-hidden="true" tabindex="-1"></a>test_rmse_2 <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb209-506"><a href="#cb209-506" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((trainY-train_predict)**2.0))</span></span>
<span id="cb209-507"><a href="#cb209-507" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((testY-test_predict)**2.0))</span></span>
<span id="cb209-508"><a href="#cb209-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-509"><a href="#cb209-509" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse_2<span class="op">**</span><span class="fl">2.0</span>,train_rmse_2))</span>
<span id="cb209-510"><a href="#cb209-510" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse_2<span class="op">**</span><span class="fl">2.0</span>,test_rmse_2))    </span>
<span id="cb209-511"><a href="#cb209-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-512"><a href="#cb209-512" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb209-513"><a href="#cb209-513" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Training Loss (Red) vs Validation Loss (Blue)"</span>,x_label<span class="op">=</span><span class="st">"Number of Training Epochs"</span>,y_label<span class="op">=</span><span class="st">"Loss (MSE)"</span>)</span>
<span id="cb209-514"><a href="#cb209-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-515"><a href="#cb209-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-516"><a href="#cb209-516" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Parity Plot (Unnormalized Data)</span></span>
<span id="cb209-517"><a href="#cb209-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-520"><a href="#cb209-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-521"><a href="#cb209-521" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-522"><a href="#cb209-522" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-523"><a href="#cb209-523" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-524"><a href="#cb209-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-525"><a href="#cb209-525" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb209-526"><a href="#cb209-526" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-527"><a href="#cb209-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-528"><a href="#cb209-528" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_train_predict.flatten(),height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb209-529"><a href="#cb209-529" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_test_predict.flatten(),mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb209-530"><a href="#cb209-530" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>trainY_unnormalized.flatten(), mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb209-531"><a href="#cb209-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-532"><a href="#cb209-532" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb209-533"><a href="#cb209-533" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb209-534"><a href="#cb209-534" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb209-535"><a href="#cb209-535" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-536"><a href="#cb209-536" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb209-537"><a href="#cb209-537" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-538"><a href="#cb209-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-539"><a href="#cb209-539" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb209-540"><a href="#cb209-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-541"><a href="#cb209-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-542"><a href="#cb209-542" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Predictions (Unnormalized Data)</span></span>
<span id="cb209-543"><a href="#cb209-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-546"><a href="#cb209-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-547"><a href="#cb209-547" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-548"><a href="#cb209-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-549"><a href="#cb209-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-550"><a href="#cb209-550" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-551"><a href="#cb209-551" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-552"><a href="#cb209-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-553"><a href="#cb209-553" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-554"><a href="#cb209-554" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-555"><a href="#cb209-555" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-556"><a href="#cb209-556" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-557"><a href="#cb209-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-558"><a href="#cb209-558" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-559"><a href="#cb209-559" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-560"><a href="#cb209-560" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-561"><a href="#cb209-561" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-562"><a href="#cb209-562" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-563"><a href="#cb209-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-564"><a href="#cb209-564" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-565"><a href="#cb209-565" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-566"><a href="#cb209-566" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-567"><a href="#cb209-567" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-568"><a href="#cb209-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-569"><a href="#cb209-569" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-570"><a href="#cb209-570" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-571"><a href="#cb209-571" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-572"><a href="#cb209-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-573"><a href="#cb209-573" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-574"><a href="#cb209-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-575"><a href="#cb209-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-576"><a href="#cb209-576" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-577"><a href="#cb209-577" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-578"><a href="#cb209-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-579"><a href="#cb209-579" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(np.array(test.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-580"><a href="#cb209-580" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(np.array(train.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-581"><a href="#cb209-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-582"><a href="#cb209-582" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb209-583"><a href="#cb209-583" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-584"><a href="#cb209-584" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb209-585"><a href="#cb209-585" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(X.shape,Y.shape)</span></span>
<span id="cb209-586"><a href="#cb209-586" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb209-587"><a href="#cb209-587" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb209-588"><a href="#cb209-588" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb209-589"><a href="#cb209-589" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb209-590"><a href="#cb209-590" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb209-591"><a href="#cb209-591" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb209-592"><a href="#cb209-592" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of attacks'</span>)</span>
<span id="cb209-593"><a href="#cb209-593" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual vs Predicted Values'</span>)</span>
<span id="cb209-594"><a href="#cb209-594" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb209-595"><a href="#cb209-595" aria-hidden="true" tabindex="-1"></a>plot_result(trainY_unnormalized, testY_unnormalized, unnormalized_train_predict, unnormalized_test_predict)</span>
<span id="cb209-596"><a href="#cb209-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-597"><a href="#cb209-597" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb209-598"><a href="#cb209-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-599"><a href="#cb209-599" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb209-600"><a href="#cb209-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-603"><a href="#cb209-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-604"><a href="#cb209-604" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-605"><a href="#cb209-605" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-606"><a href="#cb209-606" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-607"><a href="#cb209-607" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb209-608"><a href="#cb209-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-609"><a href="#cb209-609" aria-hidden="true" tabindex="-1"></a>display(Markdown(</span>
<span id="cb209-610"><a href="#cb209-610" aria-hidden="true" tabindex="-1"></a><span class="ss">f"""</span></span>
<span id="cb209-611"><a href="#cb209-611" aria-hidden="true" tabindex="-1"></a><span class="ss">With L2 Regularization (lambda = 0.01) added to the Simple RNN model, the Train RMSE remained constant at </span></span>
<span id="cb209-612"><a href="#cb209-612" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>train_rmse_1<span class="sc">:.2f}</span><span class="ss"> but test RMSE decreased from </span><span class="sc">{</span>test_rmse_1<span class="sc">:.2f}</span><span class="ss"> to </span><span class="sc">{</span>test_rmse_2<span class="sc">:.2f}</span><span class="ss">.</span></span>
<span id="cb209-613"><a href="#cb209-613" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb209-614"><a href="#cb209-614" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb209-615"><a href="#cb209-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-616"><a href="#cb209-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-617"><a href="#cb209-617" aria-hidden="true" tabindex="-1"></a>I experimented with the number of epochs, trying 50 first, before arriving at 100. It seems that the regularization penalty was too strong relative to the capacity of the model, resulting in a higher RMSE when using the same number of epochs as before. However, when the number of epochs is reduced, the model had less time to overfit to the training data, and the regularization penalty was able to help the model generalize better.</span>
<span id="cb209-618"><a href="#cb209-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-619"><a href="#cb209-619" aria-hidden="true" tabindex="-1"></a><span class="fu"># Training and Evaluating a GRU with L2 Regularization</span></span>
<span id="cb209-620"><a href="#cb209-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-621"><a href="#cb209-621" aria-hidden="true" tabindex="-1"></a>The GRU is very similar to LSTM—you can think of it as a slightly simpler, streamlined version of the LSTM architecture. It was introduced in 2014 by Cho et al. and have gained popularity in the last few years. GRU's have become popular alternatives to LSTMs because they combine the forget and input gates into a single “update gate.” Therefore, it uses gating mechanisms to selectively update and reset the hidden state, allowing it to learn long-term dependencies more effectively. <span class="co">[</span><span class="ot">@chollet2021deep</span><span class="co">]</span></span>
<span id="cb209-622"><a href="#cb209-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-625"><a href="#cb209-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-626"><a href="#cb209-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-627"><a href="#cb209-627" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-628"><a href="#cb209-628" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-629"><a href="#cb209-629" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">"univariate_train.csv"</span>)</span>
<span id="cb209-630"><a href="#cb209-630" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">"univariate_test.csv"</span>)</span>
<span id="cb209-631"><a href="#cb209-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-632"><a href="#cb209-632" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> np.array(train.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-633"><a href="#cb209-633" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> np.array(test.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-634"><a href="#cb209-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-635"><a href="#cb209-635" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize values</span></span>
<span id="cb209-636"><a href="#cb209-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-637"><a href="#cb209-637" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb209-638"><a href="#cb209-638" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> scaler.fit_transform(train_data).flatten()</span>
<span id="cb209-639"><a href="#cb209-639" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> scaler.fit_transform(test_data).flatten()</span>
<span id="cb209-640"><a href="#cb209-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-641"><a href="#cb209-641" aria-hidden="true" tabindex="-1"></a><span class="co">#print(train_data.shape)</span></span>
<span id="cb209-642"><a href="#cb209-642" aria-hidden="true" tabindex="-1"></a><span class="co">#print(test_data.shape)</span></span>
<span id="cb209-643"><a href="#cb209-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-644"><a href="#cb209-644" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-645"><a href="#cb209-645" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-646"><a href="#cb209-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-647"><a href="#cb209-647" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-648"><a href="#cb209-648" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-649"><a href="#cb209-649" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-650"><a href="#cb209-650" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-651"><a href="#cb209-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-652"><a href="#cb209-652" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-653"><a href="#cb209-653" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-654"><a href="#cb209-654" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-655"><a href="#cb209-655" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-656"><a href="#cb209-656" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-657"><a href="#cb209-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-658"><a href="#cb209-658" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-659"><a href="#cb209-659" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-660"><a href="#cb209-660" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-661"><a href="#cb209-661" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-662"><a href="#cb209-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-663"><a href="#cb209-663" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-664"><a href="#cb209-664" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-665"><a href="#cb209-665" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-666"><a href="#cb209-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-667"><a href="#cb209-667" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-668"><a href="#cb209-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-669"><a href="#cb209-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-670"><a href="#cb209-670" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-671"><a href="#cb209-671" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-672"><a href="#cb209-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-673"><a href="#cb209-673" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb209-674"><a href="#cb209-674" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span>
<span id="cb209-675"><a href="#cb209-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-676"><a href="#cb209-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-677"><a href="#cb209-677" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model and Training Parameters</span></span>
<span id="cb209-678"><a href="#cb209-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-681"><a href="#cb209-681" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-682"><a href="#cb209-682" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb209-683"><a href="#cb209-683" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb209-684"><a href="#cb209-684" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb209-685"><a href="#cb209-685" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb209-686"><a href="#cb209-686" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb209-687"><a href="#cb209-687" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb209-688"><a href="#cb209-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-689"><a href="#cb209-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-690"><a href="#cb209-690" aria-hidden="true" tabindex="-1"></a><span class="fu">## Create GRU Model With L2 Regularization</span></span>
<span id="cb209-691"><a href="#cb209-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-694"><a href="#cb209-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-695"><a href="#cb209-695" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb209-696"><a href="#cb209-696" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb209-697"><a href="#cb209-697" aria-hidden="true" tabindex="-1"></a>model.add(GRU(</span>
<span id="cb209-698"><a href="#cb209-698" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb209-699"><a href="#cb209-699" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb209-700"><a href="#cb209-700" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb209-701"><a href="#cb209-701" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb209-702"><a href="#cb209-702" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb209-703"><a href="#cb209-703" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb209-704"><a href="#cb209-704" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb209-705"><a href="#cb209-705" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb209-706"><a href="#cb209-706" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb209-707"><a href="#cb209-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-708"><a href="#cb209-708" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb209-709"><a href="#cb209-709" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb209-710"><a href="#cb209-710" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb209-711"><a href="#cb209-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-712"><a href="#cb209-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-713"><a href="#cb209-713" aria-hidden="true" tabindex="-1"></a><span class="fu">## Train Model and Visualize Performance</span></span>
<span id="cb209-714"><a href="#cb209-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-717"><a href="#cb209-717" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-718"><a href="#cb209-718" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb209-719"><a href="#cb209-719" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb209-720"><a href="#cb209-720" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb209-721"><a href="#cb209-721" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb209-722"><a href="#cb209-722" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb209-723"><a href="#cb209-723" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb209-724"><a href="#cb209-724" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span>
<span id="cb209-725"><a href="#cb209-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-726"><a href="#cb209-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-727"><a href="#cb209-727" aria-hidden="true" tabindex="-1"></a>:::panel-tabset</span>
<span id="cb209-728"><a href="#cb209-728" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Fitting History</span></span>
<span id="cb209-729"><a href="#cb209-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-732"><a href="#cb209-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-733"><a href="#cb209-733" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-734"><a href="#cb209-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-735"><a href="#cb209-735" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-736"><a href="#cb209-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-737"><a href="#cb209-737" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb209-738"><a href="#cb209-738" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb209-739"><a href="#cb209-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-740"><a href="#cb209-740" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb209-741"><a href="#cb209-741" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb209-742"><a href="#cb209-742" aria-hidden="true" tabindex="-1"></a>unnormalized_train_predict <span class="op">=</span> scaler.inverse_transform(train_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-743"><a href="#cb209-743" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb209-744"><a href="#cb209-744" aria-hidden="true" tabindex="-1"></a>unnormalized_test_predict <span class="op">=</span> scaler.inverse_transform(test_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-745"><a href="#cb209-745" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></span>
<span id="cb209-746"><a href="#cb209-746" aria-hidden="true" tabindex="-1"></a>trainY_unnormalized <span class="op">=</span> scaler.inverse_transform(trainY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-747"><a href="#cb209-747" aria-hidden="true" tabindex="-1"></a>testY_unnormalized <span class="op">=</span> scaler.inverse_transform(testY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-748"><a href="#cb209-748" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb209-749"><a href="#cb209-749" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainY.shape, train_predict.shape)</span></span>
<span id="cb209-750"><a href="#cb209-750" aria-hidden="true" tabindex="-1"></a>train_rmse_3 <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb209-751"><a href="#cb209-751" aria-hidden="true" tabindex="-1"></a>test_rmse_3 <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb209-752"><a href="#cb209-752" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((trainY-train_predict)**2.0))</span></span>
<span id="cb209-753"><a href="#cb209-753" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((testY-test_predict)**2.0))</span></span>
<span id="cb209-754"><a href="#cb209-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-755"><a href="#cb209-755" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse_3<span class="op">**</span><span class="fl">2.0</span>,train_rmse_3))</span>
<span id="cb209-756"><a href="#cb209-756" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse_3<span class="op">**</span><span class="fl">2.0</span>,test_rmse_3))    </span>
<span id="cb209-757"><a href="#cb209-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-758"><a href="#cb209-758" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb209-759"><a href="#cb209-759" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Training Loss (Red) vs Validation Loss (Blue)"</span>,x_label<span class="op">=</span><span class="st">"Number of Training Epochs"</span>,y_label<span class="op">=</span><span class="st">"Loss (MSE)"</span>)</span>
<span id="cb209-760"><a href="#cb209-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-761"><a href="#cb209-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-762"><a href="#cb209-762" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Parity Plot (Unnormalized Data)</span></span>
<span id="cb209-763"><a href="#cb209-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-766"><a href="#cb209-766" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-767"><a href="#cb209-767" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-768"><a href="#cb209-768" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-769"><a href="#cb209-769" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-770"><a href="#cb209-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-771"><a href="#cb209-771" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb209-772"><a href="#cb209-772" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-773"><a href="#cb209-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-774"><a href="#cb209-774" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_train_predict.flatten(),height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb209-775"><a href="#cb209-775" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_test_predict.flatten(),mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb209-776"><a href="#cb209-776" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>trainY_unnormalized.flatten(), mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb209-777"><a href="#cb209-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-778"><a href="#cb209-778" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb209-779"><a href="#cb209-779" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb209-780"><a href="#cb209-780" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb209-781"><a href="#cb209-781" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-782"><a href="#cb209-782" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb209-783"><a href="#cb209-783" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-784"><a href="#cb209-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-785"><a href="#cb209-785" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb209-786"><a href="#cb209-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-787"><a href="#cb209-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-788"><a href="#cb209-788" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Predictions (Unnormalized Data)</span></span>
<span id="cb209-789"><a href="#cb209-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-792"><a href="#cb209-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-793"><a href="#cb209-793" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-794"><a href="#cb209-794" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-795"><a href="#cb209-795" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-796"><a href="#cb209-796" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-797"><a href="#cb209-797" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-798"><a href="#cb209-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-799"><a href="#cb209-799" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-800"><a href="#cb209-800" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-801"><a href="#cb209-801" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-802"><a href="#cb209-802" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-803"><a href="#cb209-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-804"><a href="#cb209-804" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-805"><a href="#cb209-805" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-806"><a href="#cb209-806" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-807"><a href="#cb209-807" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-808"><a href="#cb209-808" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-809"><a href="#cb209-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-810"><a href="#cb209-810" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-811"><a href="#cb209-811" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-812"><a href="#cb209-812" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-813"><a href="#cb209-813" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-814"><a href="#cb209-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-815"><a href="#cb209-815" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-816"><a href="#cb209-816" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-817"><a href="#cb209-817" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-818"><a href="#cb209-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-819"><a href="#cb209-819" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-820"><a href="#cb209-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-821"><a href="#cb209-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-822"><a href="#cb209-822" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-823"><a href="#cb209-823" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-824"><a href="#cb209-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-825"><a href="#cb209-825" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(np.array(test.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-826"><a href="#cb209-826" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(np.array(train.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-827"><a href="#cb209-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-828"><a href="#cb209-828" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb209-829"><a href="#cb209-829" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-830"><a href="#cb209-830" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb209-831"><a href="#cb209-831" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(X.shape,Y.shape)</span></span>
<span id="cb209-832"><a href="#cb209-832" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb209-833"><a href="#cb209-833" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb209-834"><a href="#cb209-834" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb209-835"><a href="#cb209-835" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb209-836"><a href="#cb209-836" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb209-837"><a href="#cb209-837" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb209-838"><a href="#cb209-838" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of attacks'</span>)</span>
<span id="cb209-839"><a href="#cb209-839" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual vs Predicted Values'</span>)</span>
<span id="cb209-840"><a href="#cb209-840" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb209-841"><a href="#cb209-841" aria-hidden="true" tabindex="-1"></a>plot_result(trainY_unnormalized, testY_unnormalized, unnormalized_train_predict, unnormalized_test_predict)</span>
<span id="cb209-842"><a href="#cb209-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-843"><a href="#cb209-843" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb209-844"><a href="#cb209-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-845"><a href="#cb209-845" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb209-846"><a href="#cb209-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-849"><a href="#cb209-849" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-850"><a href="#cb209-850" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-851"><a href="#cb209-851" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-852"><a href="#cb209-852" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-853"><a href="#cb209-853" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb209-854"><a href="#cb209-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-855"><a href="#cb209-855" aria-hidden="true" tabindex="-1"></a>display(Markdown(</span>
<span id="cb209-856"><a href="#cb209-856" aria-hidden="true" tabindex="-1"></a><span class="ss">f"""</span></span>
<span id="cb209-857"><a href="#cb209-857" aria-hidden="true" tabindex="-1"></a><span class="ss">The GRU with L2 Regularization performs better, as observed by its Train RMSE of </span><span class="sc">{</span>train_rmse_3<span class="sc">:.2f}</span><span class="ss"> and test RMSE of </span><span class="sc">{</span>test_rmse_3<span class="sc">:.2f}</span><span class="ss">, a slight drop from that of the Simple RNN models.</span></span>
<span id="cb209-858"><a href="#cb209-858" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb209-859"><a href="#cb209-859" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb209-860"><a href="#cb209-860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-861"><a href="#cb209-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-862"><a href="#cb209-862" aria-hidden="true" tabindex="-1"></a>Although this is a good sign that a more complex model performs better, the prediction plot remains fairly similar compared to those of the RNN models.  Let's try a Bidirectional GRU model, keeping the same number of epochs (100), to see if we can further improve the model's performance.</span>
<span id="cb209-863"><a href="#cb209-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-864"><a href="#cb209-864" aria-hidden="true" tabindex="-1"></a><span class="fu"># Training and Evaluating a Bidirectional GRU </span></span>
<span id="cb209-865"><a href="#cb209-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-868"><a href="#cb209-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-869"><a href="#cb209-869" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-870"><a href="#cb209-870" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-871"><a href="#cb209-871" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-872"><a href="#cb209-872" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">"univariate_train.csv"</span>)</span>
<span id="cb209-873"><a href="#cb209-873" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">"univariate_test.csv"</span>)</span>
<span id="cb209-874"><a href="#cb209-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-875"><a href="#cb209-875" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> np.array(train.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-876"><a href="#cb209-876" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> np.array(test.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-877"><a href="#cb209-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-878"><a href="#cb209-878" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize values</span></span>
<span id="cb209-879"><a href="#cb209-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-880"><a href="#cb209-880" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb209-881"><a href="#cb209-881" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> scaler.fit_transform(train_data).flatten()</span>
<span id="cb209-882"><a href="#cb209-882" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> scaler.fit_transform(test_data).flatten()</span>
<span id="cb209-883"><a href="#cb209-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-884"><a href="#cb209-884" aria-hidden="true" tabindex="-1"></a><span class="co">#print(train_data.shape)</span></span>
<span id="cb209-885"><a href="#cb209-885" aria-hidden="true" tabindex="-1"></a><span class="co">#print(test_data.shape)</span></span>
<span id="cb209-886"><a href="#cb209-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-887"><a href="#cb209-887" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-888"><a href="#cb209-888" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-889"><a href="#cb209-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-890"><a href="#cb209-890" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-891"><a href="#cb209-891" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-892"><a href="#cb209-892" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-893"><a href="#cb209-893" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-894"><a href="#cb209-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-895"><a href="#cb209-895" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-896"><a href="#cb209-896" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-897"><a href="#cb209-897" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-898"><a href="#cb209-898" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-899"><a href="#cb209-899" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-900"><a href="#cb209-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-901"><a href="#cb209-901" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-902"><a href="#cb209-902" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-903"><a href="#cb209-903" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-904"><a href="#cb209-904" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-905"><a href="#cb209-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-906"><a href="#cb209-906" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-907"><a href="#cb209-907" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-908"><a href="#cb209-908" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-909"><a href="#cb209-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-910"><a href="#cb209-910" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-911"><a href="#cb209-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-912"><a href="#cb209-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-913"><a href="#cb209-913" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-914"><a href="#cb209-914" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-915"><a href="#cb209-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-916"><a href="#cb209-916" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb209-917"><a href="#cb209-917" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span>
<span id="cb209-918"><a href="#cb209-918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-919"><a href="#cb209-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-920"><a href="#cb209-920" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model and Training Parameters</span></span>
<span id="cb209-921"><a href="#cb209-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-924"><a href="#cb209-924" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-925"><a href="#cb209-925" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb209-926"><a href="#cb209-926" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb209-927"><a href="#cb209-927" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb209-928"><a href="#cb209-928" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb209-929"><a href="#cb209-929" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb209-930"><a href="#cb209-930" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb209-931"><a href="#cb209-931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-932"><a href="#cb209-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-933"><a href="#cb209-933" aria-hidden="true" tabindex="-1"></a><span class="fu">## Create Bidirectional GRU</span></span>
<span id="cb209-934"><a href="#cb209-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-937"><a href="#cb209-937" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-938"><a href="#cb209-938" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb209-939"><a href="#cb209-939" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb209-940"><a href="#cb209-940" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(GRU(</span>
<span id="cb209-941"><a href="#cb209-941" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb209-942"><a href="#cb209-942" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb209-943"><a href="#cb209-943" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb209-944"><a href="#cb209-944" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb209-945"><a href="#cb209-945" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb209-946"><a href="#cb209-946" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb209-947"><a href="#cb209-947" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb209-948"><a href="#cb209-948" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb209-949"><a href="#cb209-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-950"><a href="#cb209-950" aria-hidden="true" tabindex="-1"></a><span class="co"># BUILD THE MODEL </span></span>
<span id="cb209-951"><a href="#cb209-951" aria-hidden="true" tabindex="-1"></a>model.build(input_shape<span class="op">=</span>(<span class="va">None</span>, trainX.shape[<span class="dv">1</span>], trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb209-952"><a href="#cb209-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-953"><a href="#cb209-953" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb209-954"><a href="#cb209-954" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb209-955"><a href="#cb209-955" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb209-956"><a href="#cb209-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-957"><a href="#cb209-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-958"><a href="#cb209-958" aria-hidden="true" tabindex="-1"></a><span class="fu">## Train Model and Visualize Performance</span></span>
<span id="cb209-959"><a href="#cb209-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-962"><a href="#cb209-962" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-963"><a href="#cb209-963" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb209-964"><a href="#cb209-964" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb209-965"><a href="#cb209-965" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb209-966"><a href="#cb209-966" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb209-967"><a href="#cb209-967" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb209-968"><a href="#cb209-968" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb209-969"><a href="#cb209-969" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span>
<span id="cb209-970"><a href="#cb209-970" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-971"><a href="#cb209-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-972"><a href="#cb209-972" aria-hidden="true" tabindex="-1"></a>:::panel-tabset</span>
<span id="cb209-973"><a href="#cb209-973" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Fitting History</span></span>
<span id="cb209-974"><a href="#cb209-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-977"><a href="#cb209-977" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-978"><a href="#cb209-978" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-979"><a href="#cb209-979" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-980"><a href="#cb209-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-981"><a href="#cb209-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-982"><a href="#cb209-982" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb209-983"><a href="#cb209-983" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb209-984"><a href="#cb209-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-985"><a href="#cb209-985" aria-hidden="true" tabindex="-1"></a><span class="co">## MAKE PREDICTIONS</span></span>
<span id="cb209-986"><a href="#cb209-986" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb209-987"><a href="#cb209-987" aria-hidden="true" tabindex="-1"></a>unnormalized_train_predict <span class="op">=</span> scaler.inverse_transform(train_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-988"><a href="#cb209-988" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb209-989"><a href="#cb209-989" aria-hidden="true" tabindex="-1"></a>unnormalized_test_predict <span class="op">=</span> scaler.inverse_transform(test_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-990"><a href="#cb209-990" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></span>
<span id="cb209-991"><a href="#cb209-991" aria-hidden="true" tabindex="-1"></a>trainY_unnormalized <span class="op">=</span> scaler.inverse_transform(trainY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-992"><a href="#cb209-992" aria-hidden="true" tabindex="-1"></a>testY_unnormalized <span class="op">=</span> scaler.inverse_transform(testY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-993"><a href="#cb209-993" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb209-994"><a href="#cb209-994" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainY.shape, train_predict.shape)</span></span>
<span id="cb209-995"><a href="#cb209-995" aria-hidden="true" tabindex="-1"></a>train_rmse_4 <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb209-996"><a href="#cb209-996" aria-hidden="true" tabindex="-1"></a>test_rmse_4 <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb209-997"><a href="#cb209-997" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((trainY-train_predict)**2.0))</span></span>
<span id="cb209-998"><a href="#cb209-998" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((testY-test_predict)**2.0))</span></span>
<span id="cb209-999"><a href="#cb209-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1000"><a href="#cb209-1000" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse_4<span class="op">**</span><span class="fl">2.0</span>,train_rmse_4))</span>
<span id="cb209-1001"><a href="#cb209-1001" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse_4<span class="op">**</span><span class="fl">2.0</span>,test_rmse_4))    </span>
<span id="cb209-1002"><a href="#cb209-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1003"><a href="#cb209-1003" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb209-1004"><a href="#cb209-1004" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Training Loss (Red) vs Validation Loss (Blue)"</span>,x_label<span class="op">=</span><span class="st">"Number of Training Epochs"</span>,y_label<span class="op">=</span><span class="st">"Loss (MSE)"</span>)</span>
<span id="cb209-1005"><a href="#cb209-1005" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1006"><a href="#cb209-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1007"><a href="#cb209-1007" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Parity Plot (Unnormalized Data)</span></span>
<span id="cb209-1008"><a href="#cb209-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1011"><a href="#cb209-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1012"><a href="#cb209-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1013"><a href="#cb209-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1014"><a href="#cb209-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1015"><a href="#cb209-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1016"><a href="#cb209-1016" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb209-1017"><a href="#cb209-1017" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-1018"><a href="#cb209-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1019"><a href="#cb209-1019" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_train_predict.flatten(),height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb209-1020"><a href="#cb209-1020" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_test_predict.flatten(),mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb209-1021"><a href="#cb209-1021" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>trainY_unnormalized.flatten(), mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb209-1022"><a href="#cb209-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1023"><a href="#cb209-1023" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb209-1024"><a href="#cb209-1024" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb209-1025"><a href="#cb209-1025" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb209-1026"><a href="#cb209-1026" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-1027"><a href="#cb209-1027" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb209-1028"><a href="#cb209-1028" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-1029"><a href="#cb209-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1030"><a href="#cb209-1030" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb209-1031"><a href="#cb209-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1032"><a href="#cb209-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1033"><a href="#cb209-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Predictions (Unnormalized Data)</span></span>
<span id="cb209-1034"><a href="#cb209-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1037"><a href="#cb209-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1038"><a href="#cb209-1038" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1039"><a href="#cb209-1039" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1040"><a href="#cb209-1040" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1041"><a href="#cb209-1041" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-1042"><a href="#cb209-1042" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-1043"><a href="#cb209-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1044"><a href="#cb209-1044" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-1045"><a href="#cb209-1045" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-1046"><a href="#cb209-1046" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-1047"><a href="#cb209-1047" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-1048"><a href="#cb209-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1049"><a href="#cb209-1049" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-1050"><a href="#cb209-1050" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-1051"><a href="#cb209-1051" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-1052"><a href="#cb209-1052" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-1053"><a href="#cb209-1053" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-1054"><a href="#cb209-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1055"><a href="#cb209-1055" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-1056"><a href="#cb209-1056" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-1057"><a href="#cb209-1057" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1058"><a href="#cb209-1058" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-1059"><a href="#cb209-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1060"><a href="#cb209-1060" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-1061"><a href="#cb209-1061" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-1062"><a href="#cb209-1062" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-1063"><a href="#cb209-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1064"><a href="#cb209-1064" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-1065"><a href="#cb209-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1066"><a href="#cb209-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1067"><a href="#cb209-1067" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-1068"><a href="#cb209-1068" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-1069"><a href="#cb209-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1070"><a href="#cb209-1070" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(np.array(test.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-1071"><a href="#cb209-1071" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(np.array(train.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-1072"><a href="#cb209-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1073"><a href="#cb209-1073" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb209-1074"><a href="#cb209-1074" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1075"><a href="#cb209-1075" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb209-1076"><a href="#cb209-1076" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(X.shape,Y.shape)</span></span>
<span id="cb209-1077"><a href="#cb209-1077" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb209-1078"><a href="#cb209-1078" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb209-1079"><a href="#cb209-1079" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb209-1080"><a href="#cb209-1080" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb209-1081"><a href="#cb209-1081" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb209-1082"><a href="#cb209-1082" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb209-1083"><a href="#cb209-1083" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of attacks'</span>)</span>
<span id="cb209-1084"><a href="#cb209-1084" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual vs Predicted Values'</span>)</span>
<span id="cb209-1085"><a href="#cb209-1085" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb209-1086"><a href="#cb209-1086" aria-hidden="true" tabindex="-1"></a>plot_result(trainY_unnormalized, testY_unnormalized, unnormalized_train_predict, unnormalized_test_predict)</span>
<span id="cb209-1087"><a href="#cb209-1087" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1088"><a href="#cb209-1088" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb209-1089"><a href="#cb209-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1090"><a href="#cb209-1090" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb209-1091"><a href="#cb209-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1094"><a href="#cb209-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1095"><a href="#cb209-1095" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1096"><a href="#cb209-1096" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1097"><a href="#cb209-1097" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1098"><a href="#cb209-1098" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb209-1099"><a href="#cb209-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1100"><a href="#cb209-1100" aria-hidden="true" tabindex="-1"></a>display(Markdown(</span>
<span id="cb209-1101"><a href="#cb209-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">f"""</span></span>
<span id="cb209-1102"><a href="#cb209-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">The Bidirectional GRU with no regularization performs worse than not only the GRU with L2 Regularization but also the Simple RNN models! Its Train RMSE of </span><span class="sc">{</span>train_rmse_4<span class="sc">:.2f}</span><span class="ss"> and test RMSE of </span><span class="sc">{</span>test_rmse_4<span class="sc">:.2f}</span><span class="ss"> are worse than the previous 3 models tested. This is likely due to the fact that the Bidirectional GRU is a more complex model and thus requires more regularization to prevent overfitting. Let's introduce regularization again, but this time with a Stacked Bidirectional GRU.</span></span>
<span id="cb209-1103"><a href="#cb209-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb209-1104"><a href="#cb209-1104" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb209-1105"><a href="#cb209-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1106"><a href="#cb209-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1107"><a href="#cb209-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1108"><a href="#cb209-1108" aria-hidden="true" tabindex="-1"></a><span class="fu"># Training and Evaluating a Stacked Bidirectional GRU with L2 Regularization</span></span>
<span id="cb209-1109"><a href="#cb209-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1112"><a href="#cb209-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1113"><a href="#cb209-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1114"><a href="#cb209-1114" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1115"><a href="#cb209-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1116"><a href="#cb209-1116" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">"univariate_train.csv"</span>)</span>
<span id="cb209-1117"><a href="#cb209-1117" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">"univariate_test.csv"</span>)</span>
<span id="cb209-1118"><a href="#cb209-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1119"><a href="#cb209-1119" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> np.array(train.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-1120"><a href="#cb209-1120" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> np.array(test.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-1121"><a href="#cb209-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1122"><a href="#cb209-1122" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize values</span></span>
<span id="cb209-1123"><a href="#cb209-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1124"><a href="#cb209-1124" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb209-1125"><a href="#cb209-1125" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> scaler.fit_transform(train_data).flatten()</span>
<span id="cb209-1126"><a href="#cb209-1126" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> scaler.fit_transform(test_data).flatten()</span>
<span id="cb209-1127"><a href="#cb209-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1128"><a href="#cb209-1128" aria-hidden="true" tabindex="-1"></a><span class="co">#print(train_data.shape)</span></span>
<span id="cb209-1129"><a href="#cb209-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#print(test_data.shape)</span></span>
<span id="cb209-1130"><a href="#cb209-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1131"><a href="#cb209-1131" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-1132"><a href="#cb209-1132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-1133"><a href="#cb209-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1134"><a href="#cb209-1134" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-1135"><a href="#cb209-1135" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-1136"><a href="#cb209-1136" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-1137"><a href="#cb209-1137" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-1138"><a href="#cb209-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1139"><a href="#cb209-1139" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-1140"><a href="#cb209-1140" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-1141"><a href="#cb209-1141" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-1142"><a href="#cb209-1142" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-1143"><a href="#cb209-1143" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-1144"><a href="#cb209-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1145"><a href="#cb209-1145" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-1146"><a href="#cb209-1146" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-1147"><a href="#cb209-1147" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1148"><a href="#cb209-1148" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-1149"><a href="#cb209-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1150"><a href="#cb209-1150" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-1151"><a href="#cb209-1151" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-1152"><a href="#cb209-1152" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-1153"><a href="#cb209-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1154"><a href="#cb209-1154" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-1155"><a href="#cb209-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1156"><a href="#cb209-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1157"><a href="#cb209-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-1158"><a href="#cb209-1158" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-1159"><a href="#cb209-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1160"><a href="#cb209-1160" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb209-1161"><a href="#cb209-1161" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span>
<span id="cb209-1162"><a href="#cb209-1162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1163"><a href="#cb209-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1164"><a href="#cb209-1164" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model and Training Parameters</span></span>
<span id="cb209-1165"><a href="#cb209-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1168"><a href="#cb209-1168" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1169"><a href="#cb209-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb209-1170"><a href="#cb209-1170" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb209-1171"><a href="#cb209-1171" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span> </span>
<span id="cb209-1172"><a href="#cb209-1172" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb209-1173"><a href="#cb209-1173" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb209-1174"><a href="#cb209-1174" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb209-1175"><a href="#cb209-1175" aria-hidden="true" tabindex="-1"></a>callback <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'loss'</span>, patience<span class="op">=</span><span class="dv">3</span>) <span class="co"># This callback will stop the training when there is no improvement in the loss for three consecutive epochs</span></span>
<span id="cb209-1176"><a href="#cb209-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1177"><a href="#cb209-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1178"><a href="#cb209-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">## Create Stacked Bidirectional GRU with L2 Regularization</span></span>
<span id="cb209-1179"><a href="#cb209-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1182"><a href="#cb209-1182" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1183"><a href="#cb209-1183" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb209-1184"><a href="#cb209-1184" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(GRU(</span>
<span id="cb209-1185"><a href="#cb209-1185" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units, </span>
<span id="cb209-1186"><a href="#cb209-1186" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb209-1187"><a href="#cb209-1187" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb209-1188"><a href="#cb209-1188" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb209-1189"><a href="#cb209-1189" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(GRU(</span>
<span id="cb209-1190"><a href="#cb209-1190" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb209-1191"><a href="#cb209-1191" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb209-1192"><a href="#cb209-1192" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'relu'</span>)</span>
<span id="cb209-1193"><a href="#cb209-1193" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb209-1194"><a href="#cb209-1194" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb209-1195"><a href="#cb209-1195" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb209-1196"><a href="#cb209-1196" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb209-1197"><a href="#cb209-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1198"><a href="#cb209-1198" aria-hidden="true" tabindex="-1"></a><span class="co"># BUILD THE MODEL </span></span>
<span id="cb209-1199"><a href="#cb209-1199" aria-hidden="true" tabindex="-1"></a>model.build(input_shape<span class="op">=</span>(<span class="va">None</span>, trainX.shape[<span class="dv">1</span>], trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb209-1200"><a href="#cb209-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1201"><a href="#cb209-1201" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb209-1202"><a href="#cb209-1202" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb209-1203"><a href="#cb209-1203" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb209-1204"><a href="#cb209-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1205"><a href="#cb209-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1206"><a href="#cb209-1206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Train Model and Visualize Performance</span></span>
<span id="cb209-1207"><a href="#cb209-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1210"><a href="#cb209-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1211"><a href="#cb209-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb209-1212"><a href="#cb209-1212" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb209-1213"><a href="#cb209-1213" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb209-1214"><a href="#cb209-1214" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb209-1215"><a href="#cb209-1215" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb209-1216"><a href="#cb209-1216" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb209-1217"><a href="#cb209-1217" aria-hidden="true" tabindex="-1"></a>callbacks<span class="op">=</span>[callback], <span class="co">#early stopping</span></span>
<span id="cb209-1218"><a href="#cb209-1218" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span>
<span id="cb209-1219"><a href="#cb209-1219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1220"><a href="#cb209-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1221"><a href="#cb209-1221" aria-hidden="true" tabindex="-1"></a>:::panel-tabset</span>
<span id="cb209-1222"><a href="#cb209-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Fitting History</span></span>
<span id="cb209-1223"><a href="#cb209-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1226"><a href="#cb209-1226" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1227"><a href="#cb209-1227" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1228"><a href="#cb209-1228" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1229"><a href="#cb209-1229" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1230"><a href="#cb209-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1231"><a href="#cb209-1231" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb209-1232"><a href="#cb209-1232" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb209-1233"><a href="#cb209-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1234"><a href="#cb209-1234" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb209-1235"><a href="#cb209-1235" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb209-1236"><a href="#cb209-1236" aria-hidden="true" tabindex="-1"></a>unnormalized_train_predict <span class="op">=</span> scaler.inverse_transform(train_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1237"><a href="#cb209-1237" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb209-1238"><a href="#cb209-1238" aria-hidden="true" tabindex="-1"></a>unnormalized_test_predict <span class="op">=</span> scaler.inverse_transform(test_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1239"><a href="#cb209-1239" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></span>
<span id="cb209-1240"><a href="#cb209-1240" aria-hidden="true" tabindex="-1"></a>trainY_unnormalized <span class="op">=</span> scaler.inverse_transform(trainY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1241"><a href="#cb209-1241" aria-hidden="true" tabindex="-1"></a>testY_unnormalized <span class="op">=</span> scaler.inverse_transform(testY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1242"><a href="#cb209-1242" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb209-1243"><a href="#cb209-1243" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainY.shape, train_predict.shape)</span></span>
<span id="cb209-1244"><a href="#cb209-1244" aria-hidden="true" tabindex="-1"></a>train_rmse_5 <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict)) </span>
<span id="cb209-1245"><a href="#cb209-1245" aria-hidden="true" tabindex="-1"></a>test_rmse_5 <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb209-1246"><a href="#cb209-1246" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((trainY-train_predict)**2.0))</span></span>
<span id="cb209-1247"><a href="#cb209-1247" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((testY-test_predict)**2.0))</span></span>
<span id="cb209-1248"><a href="#cb209-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1249"><a href="#cb209-1249" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse_5<span class="op">**</span><span class="fl">2.0</span>,train_rmse_5))</span>
<span id="cb209-1250"><a href="#cb209-1250" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse_5<span class="op">**</span><span class="fl">2.0</span>,test_rmse_5))    </span>
<span id="cb209-1251"><a href="#cb209-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1252"><a href="#cb209-1252" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb209-1253"><a href="#cb209-1253" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Training Loss (Red) vs Validation Loss (Blue)"</span>,x_label<span class="op">=</span><span class="st">"Number of Training Epochs"</span>,y_label<span class="op">=</span><span class="st">"Loss (MSE)"</span>)</span>
<span id="cb209-1254"><a href="#cb209-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1255"><a href="#cb209-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1256"><a href="#cb209-1256" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Parity Plot (Unnormalized Data)</span></span>
<span id="cb209-1257"><a href="#cb209-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1260"><a href="#cb209-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1261"><a href="#cb209-1261" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1262"><a href="#cb209-1262" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1263"><a href="#cb209-1263" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1264"><a href="#cb209-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1265"><a href="#cb209-1265" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb209-1266"><a href="#cb209-1266" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-1267"><a href="#cb209-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1268"><a href="#cb209-1268" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_train_predict.flatten(),height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb209-1269"><a href="#cb209-1269" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_test_predict.flatten(),mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb209-1270"><a href="#cb209-1270" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>trainY_unnormalized.flatten(), mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb209-1271"><a href="#cb209-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1272"><a href="#cb209-1272" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb209-1273"><a href="#cb209-1273" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb209-1274"><a href="#cb209-1274" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb209-1275"><a href="#cb209-1275" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-1276"><a href="#cb209-1276" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb209-1277"><a href="#cb209-1277" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-1278"><a href="#cb209-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1279"><a href="#cb209-1279" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb209-1280"><a href="#cb209-1280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1281"><a href="#cb209-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1282"><a href="#cb209-1282" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Predictions (Unnormalized Data)</span></span>
<span id="cb209-1283"><a href="#cb209-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1286"><a href="#cb209-1286" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1287"><a href="#cb209-1287" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1288"><a href="#cb209-1288" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1289"><a href="#cb209-1289" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1290"><a href="#cb209-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1291"><a href="#cb209-1291" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-1292"><a href="#cb209-1292" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-1293"><a href="#cb209-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1294"><a href="#cb209-1294" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-1295"><a href="#cb209-1295" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-1296"><a href="#cb209-1296" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-1297"><a href="#cb209-1297" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-1298"><a href="#cb209-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1299"><a href="#cb209-1299" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-1300"><a href="#cb209-1300" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-1301"><a href="#cb209-1301" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-1302"><a href="#cb209-1302" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-1303"><a href="#cb209-1303" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-1304"><a href="#cb209-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1305"><a href="#cb209-1305" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-1306"><a href="#cb209-1306" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-1307"><a href="#cb209-1307" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1308"><a href="#cb209-1308" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-1309"><a href="#cb209-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1310"><a href="#cb209-1310" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-1311"><a href="#cb209-1311" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-1312"><a href="#cb209-1312" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-1313"><a href="#cb209-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1314"><a href="#cb209-1314" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-1315"><a href="#cb209-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1316"><a href="#cb209-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1317"><a href="#cb209-1317" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-1318"><a href="#cb209-1318" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-1319"><a href="#cb209-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1320"><a href="#cb209-1320" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(np.array(test.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-1321"><a href="#cb209-1321" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(np.array(train.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-1322"><a href="#cb209-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1323"><a href="#cb209-1323" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb209-1324"><a href="#cb209-1324" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1325"><a href="#cb209-1325" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb209-1326"><a href="#cb209-1326" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(X.shape,Y.shape)</span></span>
<span id="cb209-1327"><a href="#cb209-1327" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb209-1328"><a href="#cb209-1328" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb209-1329"><a href="#cb209-1329" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb209-1330"><a href="#cb209-1330" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb209-1331"><a href="#cb209-1331" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb209-1332"><a href="#cb209-1332" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb209-1333"><a href="#cb209-1333" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of attacks'</span>)</span>
<span id="cb209-1334"><a href="#cb209-1334" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual vs Predicted Values'</span>)</span>
<span id="cb209-1335"><a href="#cb209-1335" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb209-1336"><a href="#cb209-1336" aria-hidden="true" tabindex="-1"></a>plot_result(trainY_unnormalized, testY_unnormalized, unnormalized_train_predict, unnormalized_test_predict)</span>
<span id="cb209-1337"><a href="#cb209-1337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1338"><a href="#cb209-1338" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb209-1339"><a href="#cb209-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1340"><a href="#cb209-1340" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb209-1341"><a href="#cb209-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1342"><a href="#cb209-1342" aria-hidden="true" tabindex="-1"></a>When using the Stacked Bidirectional GRU, it is imperative to add <span class="in">`return_sequences=True`</span> to stack recurrent layers on top of each other in Keras. All intermediate layers should return their full sequence of outputs (a rank-3 tensor) rather than their output at the last timestep. </span>
<span id="cb209-1345"><a href="#cb209-1345" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1346"><a href="#cb209-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1347"><a href="#cb209-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1348"><a href="#cb209-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1349"><a href="#cb209-1349" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb209-1350"><a href="#cb209-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1351"><a href="#cb209-1351" aria-hidden="true" tabindex="-1"></a>display(Markdown(</span>
<span id="cb209-1352"><a href="#cb209-1352" aria-hidden="true" tabindex="-1"></a><span class="ss">f"""</span></span>
<span id="cb209-1353"><a href="#cb209-1353" aria-hidden="true" tabindex="-1"></a><span class="ss">The output of this model is the worst out of all models so far, given its train RMSE of </span><span class="sc">{</span>train_rmse_5<span class="sc">:.2f}</span><span class="ss"> and test RMSE of </span><span class="sc">{</span>test_rmse_5<span class="sc">:.2f}</span><span class="ss">. Therefore, the best GRU model for predicting number of terorrist attacks in the US is the GRU model with L2 Regularization.</span></span>
<span id="cb209-1354"><a href="#cb209-1354" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb209-1355"><a href="#cb209-1355" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb209-1356"><a href="#cb209-1356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1357"><a href="#cb209-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1358"><a href="#cb209-1358" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb209-1359"><a href="#cb209-1359" aria-hidden="true" tabindex="-1"></a><span class="fu"># Training and Evaluating a Bidirectional LSTM</span></span>
<span id="cb209-1360"><a href="#cb209-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1363"><a href="#cb209-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1364"><a href="#cb209-1364" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1365"><a href="#cb209-1365" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1366"><a href="#cb209-1366" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1367"><a href="#cb209-1367" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">"univariate_train.csv"</span>)</span>
<span id="cb209-1368"><a href="#cb209-1368" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">"univariate_test.csv"</span>)</span>
<span id="cb209-1369"><a href="#cb209-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1370"><a href="#cb209-1370" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> np.array(train.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-1371"><a href="#cb209-1371" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> np.array(test.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-1372"><a href="#cb209-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1373"><a href="#cb209-1373" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize values</span></span>
<span id="cb209-1374"><a href="#cb209-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1375"><a href="#cb209-1375" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb209-1376"><a href="#cb209-1376" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> scaler.fit_transform(train_data).flatten()</span>
<span id="cb209-1377"><a href="#cb209-1377" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> scaler.fit_transform(test_data).flatten()</span>
<span id="cb209-1378"><a href="#cb209-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1379"><a href="#cb209-1379" aria-hidden="true" tabindex="-1"></a><span class="co">#print(train_data.shape)</span></span>
<span id="cb209-1380"><a href="#cb209-1380" aria-hidden="true" tabindex="-1"></a><span class="co">#print(test_data.shape)</span></span>
<span id="cb209-1381"><a href="#cb209-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1382"><a href="#cb209-1382" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-1383"><a href="#cb209-1383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-1384"><a href="#cb209-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1385"><a href="#cb209-1385" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-1386"><a href="#cb209-1386" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-1387"><a href="#cb209-1387" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-1388"><a href="#cb209-1388" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-1389"><a href="#cb209-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1390"><a href="#cb209-1390" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-1391"><a href="#cb209-1391" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-1392"><a href="#cb209-1392" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-1393"><a href="#cb209-1393" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-1394"><a href="#cb209-1394" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-1395"><a href="#cb209-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1396"><a href="#cb209-1396" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-1397"><a href="#cb209-1397" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-1398"><a href="#cb209-1398" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1399"><a href="#cb209-1399" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-1400"><a href="#cb209-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1401"><a href="#cb209-1401" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-1402"><a href="#cb209-1402" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-1403"><a href="#cb209-1403" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-1404"><a href="#cb209-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1405"><a href="#cb209-1405" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-1406"><a href="#cb209-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1407"><a href="#cb209-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1408"><a href="#cb209-1408" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-1409"><a href="#cb209-1409" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-1410"><a href="#cb209-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1411"><a href="#cb209-1411" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb209-1412"><a href="#cb209-1412" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span>
<span id="cb209-1413"><a href="#cb209-1413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1414"><a href="#cb209-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1415"><a href="#cb209-1415" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model and Training Parameters</span></span>
<span id="cb209-1416"><a href="#cb209-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1419"><a href="#cb209-1419" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1420"><a href="#cb209-1420" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb209-1421"><a href="#cb209-1421" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb209-1422"><a href="#cb209-1422" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span> </span>
<span id="cb209-1423"><a href="#cb209-1423" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb209-1424"><a href="#cb209-1424" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb209-1425"><a href="#cb209-1425" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb209-1426"><a href="#cb209-1426" aria-hidden="true" tabindex="-1"></a>callback <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'loss'</span>, patience<span class="op">=</span><span class="dv">3</span>) <span class="co"># This callback will stop the training when there is no improvement in the loss for three consecutive epochs</span></span>
<span id="cb209-1427"><a href="#cb209-1427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1428"><a href="#cb209-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1429"><a href="#cb209-1429" aria-hidden="true" tabindex="-1"></a><span class="fu">## Create Bidirectional LSTM</span></span>
<span id="cb209-1430"><a href="#cb209-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1433"><a href="#cb209-1433" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1434"><a href="#cb209-1434" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb209-1435"><a href="#cb209-1435" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(LSTM(</span>
<span id="cb209-1436"><a href="#cb209-1436" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb209-1437"><a href="#cb209-1437" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb209-1438"><a href="#cb209-1438" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]),</span>
<span id="cb209-1439"><a href="#cb209-1439" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb209-1440"><a href="#cb209-1440" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb209-1441"><a href="#cb209-1441" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb209-1442"><a href="#cb209-1442" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb209-1443"><a href="#cb209-1443" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb209-1444"><a href="#cb209-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1445"><a href="#cb209-1445" aria-hidden="true" tabindex="-1"></a><span class="co"># BUILD THE MODEL </span></span>
<span id="cb209-1446"><a href="#cb209-1446" aria-hidden="true" tabindex="-1"></a>model.build(input_shape<span class="op">=</span>(<span class="va">None</span>, trainX.shape[<span class="dv">1</span>], trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb209-1447"><a href="#cb209-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1448"><a href="#cb209-1448" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb209-1449"><a href="#cb209-1449" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb209-1450"><a href="#cb209-1450" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb209-1451"><a href="#cb209-1451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1452"><a href="#cb209-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1453"><a href="#cb209-1453" aria-hidden="true" tabindex="-1"></a><span class="fu">## Train Model and Visualize Performance</span></span>
<span id="cb209-1454"><a href="#cb209-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1457"><a href="#cb209-1457" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1458"><a href="#cb209-1458" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb209-1459"><a href="#cb209-1459" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb209-1460"><a href="#cb209-1460" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb209-1461"><a href="#cb209-1461" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb209-1462"><a href="#cb209-1462" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb209-1463"><a href="#cb209-1463" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb209-1464"><a href="#cb209-1464" aria-hidden="true" tabindex="-1"></a>callbacks<span class="op">=</span>[callback], <span class="co">#early stopping</span></span>
<span id="cb209-1465"><a href="#cb209-1465" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span>
<span id="cb209-1466"><a href="#cb209-1466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1467"><a href="#cb209-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1468"><a href="#cb209-1468" aria-hidden="true" tabindex="-1"></a>:::panel-tabset</span>
<span id="cb209-1469"><a href="#cb209-1469" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Fitting History</span></span>
<span id="cb209-1470"><a href="#cb209-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1473"><a href="#cb209-1473" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1474"><a href="#cb209-1474" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1475"><a href="#cb209-1475" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1476"><a href="#cb209-1476" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1477"><a href="#cb209-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1478"><a href="#cb209-1478" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb209-1479"><a href="#cb209-1479" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb209-1480"><a href="#cb209-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1481"><a href="#cb209-1481" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb209-1482"><a href="#cb209-1482" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb209-1483"><a href="#cb209-1483" aria-hidden="true" tabindex="-1"></a>unnormalized_train_predict <span class="op">=</span> scaler.inverse_transform(train_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1484"><a href="#cb209-1484" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb209-1485"><a href="#cb209-1485" aria-hidden="true" tabindex="-1"></a>unnormalized_test_predict <span class="op">=</span> scaler.inverse_transform(test_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1486"><a href="#cb209-1486" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></span>
<span id="cb209-1487"><a href="#cb209-1487" aria-hidden="true" tabindex="-1"></a>trainY_unnormalized <span class="op">=</span> scaler.inverse_transform(trainY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1488"><a href="#cb209-1488" aria-hidden="true" tabindex="-1"></a>testY_unnormalized <span class="op">=</span> scaler.inverse_transform(testY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1489"><a href="#cb209-1489" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb209-1490"><a href="#cb209-1490" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainY.shape, train_predict.shape)</span></span>
<span id="cb209-1491"><a href="#cb209-1491" aria-hidden="true" tabindex="-1"></a>train_rmse_6 <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb209-1492"><a href="#cb209-1492" aria-hidden="true" tabindex="-1"></a>test_rmse_6 <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb209-1493"><a href="#cb209-1493" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((trainY-train_predict)**2.0))</span></span>
<span id="cb209-1494"><a href="#cb209-1494" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((testY-test_predict)**2.0))</span></span>
<span id="cb209-1495"><a href="#cb209-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1496"><a href="#cb209-1496" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse_6<span class="op">**</span><span class="fl">2.0</span>,train_rmse_6))</span>
<span id="cb209-1497"><a href="#cb209-1497" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse_6<span class="op">**</span><span class="fl">2.0</span>,test_rmse_6))    </span>
<span id="cb209-1498"><a href="#cb209-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1499"><a href="#cb209-1499" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb209-1500"><a href="#cb209-1500" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Training Loss (Red) vs Validation Loss (Blue)"</span>,x_label<span class="op">=</span><span class="st">"Number of Training Epochs"</span>,y_label<span class="op">=</span><span class="st">"Loss (MSE)"</span>)</span>
<span id="cb209-1501"><a href="#cb209-1501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1502"><a href="#cb209-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1503"><a href="#cb209-1503" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Parity Plot (Unnormalized Data)</span></span>
<span id="cb209-1504"><a href="#cb209-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1507"><a href="#cb209-1507" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1508"><a href="#cb209-1508" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1509"><a href="#cb209-1509" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1510"><a href="#cb209-1510" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1511"><a href="#cb209-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1512"><a href="#cb209-1512" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb209-1513"><a href="#cb209-1513" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-1514"><a href="#cb209-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1515"><a href="#cb209-1515" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_train_predict.flatten(),height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb209-1516"><a href="#cb209-1516" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_test_predict.flatten(),mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb209-1517"><a href="#cb209-1517" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>trainY_unnormalized.flatten(), mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb209-1518"><a href="#cb209-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1519"><a href="#cb209-1519" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb209-1520"><a href="#cb209-1520" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb209-1521"><a href="#cb209-1521" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb209-1522"><a href="#cb209-1522" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-1523"><a href="#cb209-1523" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb209-1524"><a href="#cb209-1524" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-1525"><a href="#cb209-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1526"><a href="#cb209-1526" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb209-1527"><a href="#cb209-1527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1528"><a href="#cb209-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1529"><a href="#cb209-1529" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Predictions (Unnormalized Data)</span></span>
<span id="cb209-1530"><a href="#cb209-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1533"><a href="#cb209-1533" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1534"><a href="#cb209-1534" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1535"><a href="#cb209-1535" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1536"><a href="#cb209-1536" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1537"><a href="#cb209-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1538"><a href="#cb209-1538" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-1539"><a href="#cb209-1539" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-1540"><a href="#cb209-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1541"><a href="#cb209-1541" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-1542"><a href="#cb209-1542" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-1543"><a href="#cb209-1543" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-1544"><a href="#cb209-1544" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-1545"><a href="#cb209-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1546"><a href="#cb209-1546" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-1547"><a href="#cb209-1547" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-1548"><a href="#cb209-1548" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-1549"><a href="#cb209-1549" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-1550"><a href="#cb209-1550" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-1551"><a href="#cb209-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1552"><a href="#cb209-1552" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-1553"><a href="#cb209-1553" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-1554"><a href="#cb209-1554" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1555"><a href="#cb209-1555" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-1556"><a href="#cb209-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1557"><a href="#cb209-1557" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-1558"><a href="#cb209-1558" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-1559"><a href="#cb209-1559" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-1560"><a href="#cb209-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1561"><a href="#cb209-1561" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-1562"><a href="#cb209-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1563"><a href="#cb209-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1564"><a href="#cb209-1564" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-1565"><a href="#cb209-1565" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-1566"><a href="#cb209-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1567"><a href="#cb209-1567" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(np.array(test.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-1568"><a href="#cb209-1568" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(np.array(train.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-1569"><a href="#cb209-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1570"><a href="#cb209-1570" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb209-1571"><a href="#cb209-1571" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1572"><a href="#cb209-1572" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb209-1573"><a href="#cb209-1573" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(X.shape,Y.shape)</span></span>
<span id="cb209-1574"><a href="#cb209-1574" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb209-1575"><a href="#cb209-1575" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb209-1576"><a href="#cb209-1576" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb209-1577"><a href="#cb209-1577" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb209-1578"><a href="#cb209-1578" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb209-1579"><a href="#cb209-1579" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb209-1580"><a href="#cb209-1580" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of attacks'</span>)</span>
<span id="cb209-1581"><a href="#cb209-1581" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual vs Predicted Values'</span>)</span>
<span id="cb209-1582"><a href="#cb209-1582" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb209-1583"><a href="#cb209-1583" aria-hidden="true" tabindex="-1"></a>plot_result(trainY_unnormalized, testY_unnormalized, unnormalized_train_predict, unnormalized_test_predict)</span>
<span id="cb209-1584"><a href="#cb209-1584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1585"><a href="#cb209-1585" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb209-1586"><a href="#cb209-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1587"><a href="#cb209-1587" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb209-1588"><a href="#cb209-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1591"><a href="#cb209-1591" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1592"><a href="#cb209-1592" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1593"><a href="#cb209-1593" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1594"><a href="#cb209-1594" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1595"><a href="#cb209-1595" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb209-1596"><a href="#cb209-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1597"><a href="#cb209-1597" aria-hidden="true" tabindex="-1"></a>display(Markdown(</span>
<span id="cb209-1598"><a href="#cb209-1598" aria-hidden="true" tabindex="-1"></a><span class="ss">f"""</span></span>
<span id="cb209-1599"><a href="#cb209-1599" aria-hidden="true" tabindex="-1"></a><span class="ss">The Bidirectional LSTM with no regularization performs better than the Stacked GRU with L2 regularization, but worse than both the Bidirectional GRU and the GRU with L2 regularization. The train RMSE of this Bidirectional LSTM is </span><span class="sc">{</span>train_rmse_6<span class="sc">:.2f}</span><span class="ss"> and test RMSE is </span><span class="sc">{</span>test_rmse_6<span class="sc">:.2f}</span><span class="ss">. The LSTM model, which is more complex than the GRU, is likely overfitting the data. The GRU model with L2 regularization is the best model so far. Let's see if we can improve the performance of the Bidirectional LSTM with L2 regularization by tuning the hyperparameters.</span></span>
<span id="cb209-1600"><a href="#cb209-1600" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb209-1601"><a href="#cb209-1601" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb209-1602"><a href="#cb209-1602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1603"><a href="#cb209-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1604"><a href="#cb209-1604" aria-hidden="true" tabindex="-1"></a><span class="fu"># Training and Evaluating a Bidirectional LSTM with L2 Regularization</span></span>
<span id="cb209-1605"><a href="#cb209-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1608"><a href="#cb209-1608" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1609"><a href="#cb209-1609" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1610"><a href="#cb209-1610" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1611"><a href="#cb209-1611" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1612"><a href="#cb209-1612" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">"univariate_train.csv"</span>)</span>
<span id="cb209-1613"><a href="#cb209-1613" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">"univariate_test.csv"</span>)</span>
<span id="cb209-1614"><a href="#cb209-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1615"><a href="#cb209-1615" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> np.array(train.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-1616"><a href="#cb209-1616" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> np.array(test.astype(<span class="st">'float32'</span>))</span>
<span id="cb209-1617"><a href="#cb209-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1618"><a href="#cb209-1618" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize values</span></span>
<span id="cb209-1619"><a href="#cb209-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1620"><a href="#cb209-1620" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb209-1621"><a href="#cb209-1621" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> scaler.fit_transform(train_data).flatten()</span>
<span id="cb209-1622"><a href="#cb209-1622" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> scaler.fit_transform(test_data).flatten()</span>
<span id="cb209-1623"><a href="#cb209-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1624"><a href="#cb209-1624" aria-hidden="true" tabindex="-1"></a><span class="co">#print(train_data.shape)</span></span>
<span id="cb209-1625"><a href="#cb209-1625" aria-hidden="true" tabindex="-1"></a><span class="co">#print(test_data.shape)</span></span>
<span id="cb209-1626"><a href="#cb209-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1627"><a href="#cb209-1627" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-1628"><a href="#cb209-1628" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-1629"><a href="#cb209-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1630"><a href="#cb209-1630" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-1631"><a href="#cb209-1631" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-1632"><a href="#cb209-1632" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-1633"><a href="#cb209-1633" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-1634"><a href="#cb209-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1635"><a href="#cb209-1635" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-1636"><a href="#cb209-1636" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-1637"><a href="#cb209-1637" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-1638"><a href="#cb209-1638" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-1639"><a href="#cb209-1639" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-1640"><a href="#cb209-1640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1641"><a href="#cb209-1641" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-1642"><a href="#cb209-1642" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-1643"><a href="#cb209-1643" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1644"><a href="#cb209-1644" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-1645"><a href="#cb209-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1646"><a href="#cb209-1646" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-1647"><a href="#cb209-1647" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-1648"><a href="#cb209-1648" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-1649"><a href="#cb209-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1650"><a href="#cb209-1650" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-1651"><a href="#cb209-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1652"><a href="#cb209-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1653"><a href="#cb209-1653" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-1654"><a href="#cb209-1654" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-1655"><a href="#cb209-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1656"><a href="#cb209-1656" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb209-1657"><a href="#cb209-1657" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span>
<span id="cb209-1658"><a href="#cb209-1658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1659"><a href="#cb209-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1660"><a href="#cb209-1660" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model and Training Parameters</span></span>
<span id="cb209-1661"><a href="#cb209-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1664"><a href="#cb209-1664" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1665"><a href="#cb209-1665" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb209-1666"><a href="#cb209-1666" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb209-1667"><a href="#cb209-1667" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb209-1668"><a href="#cb209-1668" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb209-1669"><a href="#cb209-1669" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb209-1670"><a href="#cb209-1670" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb209-1671"><a href="#cb209-1671" aria-hidden="true" tabindex="-1"></a>callback <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'loss'</span>, patience<span class="op">=</span><span class="dv">3</span>) <span class="co"># This callback will stop the training when there is no improvement in the loss for three consecutive epochs</span></span>
<span id="cb209-1672"><a href="#cb209-1672" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1673"><a href="#cb209-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1674"><a href="#cb209-1674" aria-hidden="true" tabindex="-1"></a><span class="fu">## Create Bidirectional LSTM with L2 Regularization</span></span>
<span id="cb209-1675"><a href="#cb209-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1678"><a href="#cb209-1678" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1679"><a href="#cb209-1679" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb209-1680"><a href="#cb209-1680" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(LSTM(</span>
<span id="cb209-1681"><a href="#cb209-1681" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb209-1682"><a href="#cb209-1682" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb209-1683"><a href="#cb209-1683" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]),</span>
<span id="cb209-1684"><a href="#cb209-1684" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb209-1685"><a href="#cb209-1685" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb209-1686"><a href="#cb209-1686" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb209-1687"><a href="#cb209-1687" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb209-1688"><a href="#cb209-1688" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb209-1689"><a href="#cb209-1689" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb209-1690"><a href="#cb209-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1691"><a href="#cb209-1691" aria-hidden="true" tabindex="-1"></a><span class="co"># BUILD THE MODEL </span></span>
<span id="cb209-1692"><a href="#cb209-1692" aria-hidden="true" tabindex="-1"></a>model.build(input_shape<span class="op">=</span>(<span class="va">None</span>, trainX.shape[<span class="dv">1</span>], trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb209-1693"><a href="#cb209-1693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1694"><a href="#cb209-1694" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb209-1695"><a href="#cb209-1695" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb209-1696"><a href="#cb209-1696" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb209-1697"><a href="#cb209-1697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1698"><a href="#cb209-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1699"><a href="#cb209-1699" aria-hidden="true" tabindex="-1"></a><span class="fu">## Train Model and Visualize Performance</span></span>
<span id="cb209-1700"><a href="#cb209-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1703"><a href="#cb209-1703" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1704"><a href="#cb209-1704" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb209-1705"><a href="#cb209-1705" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb209-1706"><a href="#cb209-1706" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb209-1707"><a href="#cb209-1707" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb209-1708"><a href="#cb209-1708" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb209-1709"><a href="#cb209-1709" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb209-1710"><a href="#cb209-1710" aria-hidden="true" tabindex="-1"></a>callbacks<span class="op">=</span>[callback], <span class="co">#early stopping</span></span>
<span id="cb209-1711"><a href="#cb209-1711" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span>
<span id="cb209-1712"><a href="#cb209-1712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1713"><a href="#cb209-1713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1714"><a href="#cb209-1714" aria-hidden="true" tabindex="-1"></a>:::panel-tabset</span>
<span id="cb209-1715"><a href="#cb209-1715" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Fitting History</span></span>
<span id="cb209-1716"><a href="#cb209-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1719"><a href="#cb209-1719" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1720"><a href="#cb209-1720" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1721"><a href="#cb209-1721" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1722"><a href="#cb209-1722" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1723"><a href="#cb209-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1724"><a href="#cb209-1724" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb209-1725"><a href="#cb209-1725" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb209-1726"><a href="#cb209-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1727"><a href="#cb209-1727" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb209-1728"><a href="#cb209-1728" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb209-1729"><a href="#cb209-1729" aria-hidden="true" tabindex="-1"></a>unnormalized_train_predict <span class="op">=</span> scaler.inverse_transform(train_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1730"><a href="#cb209-1730" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb209-1731"><a href="#cb209-1731" aria-hidden="true" tabindex="-1"></a>unnormalized_test_predict <span class="op">=</span> scaler.inverse_transform(test_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1732"><a href="#cb209-1732" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></span>
<span id="cb209-1733"><a href="#cb209-1733" aria-hidden="true" tabindex="-1"></a>trainY_unnormalized <span class="op">=</span> scaler.inverse_transform(trainY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1734"><a href="#cb209-1734" aria-hidden="true" tabindex="-1"></a>testY_unnormalized <span class="op">=</span> scaler.inverse_transform(testY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-1735"><a href="#cb209-1735" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb209-1736"><a href="#cb209-1736" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainY.shape, train_predict.shape)</span></span>
<span id="cb209-1737"><a href="#cb209-1737" aria-hidden="true" tabindex="-1"></a>train_rmse_7 <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb209-1738"><a href="#cb209-1738" aria-hidden="true" tabindex="-1"></a>test_rmse_7 <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb209-1739"><a href="#cb209-1739" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((trainY-train_predict)**2.0))</span></span>
<span id="cb209-1740"><a href="#cb209-1740" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((testY-test_predict)**2.0))</span></span>
<span id="cb209-1741"><a href="#cb209-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1742"><a href="#cb209-1742" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse_7<span class="op">**</span><span class="fl">2.0</span>,train_rmse_7))</span>
<span id="cb209-1743"><a href="#cb209-1743" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse_7<span class="op">**</span><span class="fl">2.0</span>,test_rmse_7))    </span>
<span id="cb209-1744"><a href="#cb209-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1745"><a href="#cb209-1745" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb209-1746"><a href="#cb209-1746" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Training Loss (Red) vs Validation Loss (Blue)"</span>,x_label<span class="op">=</span><span class="st">"Number of Training Epochs"</span>,y_label<span class="op">=</span><span class="st">"Loss (MSE)"</span>)</span>
<span id="cb209-1747"><a href="#cb209-1747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1748"><a href="#cb209-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1749"><a href="#cb209-1749" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Parity Plot (Unnormalized Data)</span></span>
<span id="cb209-1750"><a href="#cb209-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1753"><a href="#cb209-1753" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1754"><a href="#cb209-1754" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1755"><a href="#cb209-1755" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1756"><a href="#cb209-1756" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1757"><a href="#cb209-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1758"><a href="#cb209-1758" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb209-1759"><a href="#cb209-1759" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-1760"><a href="#cb209-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1761"><a href="#cb209-1761" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_train_predict.flatten(),height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb209-1762"><a href="#cb209-1762" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_test_predict.flatten(),mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb209-1763"><a href="#cb209-1763" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>trainY_unnormalized.flatten(), mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb209-1764"><a href="#cb209-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1765"><a href="#cb209-1765" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb209-1766"><a href="#cb209-1766" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb209-1767"><a href="#cb209-1767" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb209-1768"><a href="#cb209-1768" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-1769"><a href="#cb209-1769" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb209-1770"><a href="#cb209-1770" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-1771"><a href="#cb209-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1772"><a href="#cb209-1772" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb209-1773"><a href="#cb209-1773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1774"><a href="#cb209-1774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1775"><a href="#cb209-1775" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Predictions (Unnormalized Data)</span></span>
<span id="cb209-1776"><a href="#cb209-1776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1779"><a href="#cb209-1779" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1780"><a href="#cb209-1780" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1781"><a href="#cb209-1781" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1782"><a href="#cb209-1782" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1783"><a href="#cb209-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1784"><a href="#cb209-1784" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-1785"><a href="#cb209-1785" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-1786"><a href="#cb209-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1787"><a href="#cb209-1787" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-1788"><a href="#cb209-1788" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-1789"><a href="#cb209-1789" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-1790"><a href="#cb209-1790" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-1791"><a href="#cb209-1791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1792"><a href="#cb209-1792" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-1793"><a href="#cb209-1793" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-1794"><a href="#cb209-1794" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-1795"><a href="#cb209-1795" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-1796"><a href="#cb209-1796" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-1797"><a href="#cb209-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1798"><a href="#cb209-1798" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-1799"><a href="#cb209-1799" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-1800"><a href="#cb209-1800" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1801"><a href="#cb209-1801" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-1802"><a href="#cb209-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1803"><a href="#cb209-1803" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-1804"><a href="#cb209-1804" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-1805"><a href="#cb209-1805" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-1806"><a href="#cb209-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1807"><a href="#cb209-1807" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-1808"><a href="#cb209-1808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1809"><a href="#cb209-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1810"><a href="#cb209-1810" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-1811"><a href="#cb209-1811" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-1812"><a href="#cb209-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1813"><a href="#cb209-1813" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(np.array(test.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-1814"><a href="#cb209-1814" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(np.array(train.astype(<span class="st">'float32'</span>)), p)</span>
<span id="cb209-1815"><a href="#cb209-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1816"><a href="#cb209-1816" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb209-1817"><a href="#cb209-1817" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1818"><a href="#cb209-1818" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb209-1819"><a href="#cb209-1819" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(X.shape,Y.shape)</span></span>
<span id="cb209-1820"><a href="#cb209-1820" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb209-1821"><a href="#cb209-1821" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb209-1822"><a href="#cb209-1822" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb209-1823"><a href="#cb209-1823" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb209-1824"><a href="#cb209-1824" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb209-1825"><a href="#cb209-1825" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb209-1826"><a href="#cb209-1826" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of attacks'</span>)</span>
<span id="cb209-1827"><a href="#cb209-1827" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual vs Predicted Values'</span>)</span>
<span id="cb209-1828"><a href="#cb209-1828" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb209-1829"><a href="#cb209-1829" aria-hidden="true" tabindex="-1"></a>plot_result(trainY_unnormalized, testY_unnormalized, unnormalized_train_predict, unnormalized_test_predict)</span>
<span id="cb209-1830"><a href="#cb209-1830" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1831"><a href="#cb209-1831" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb209-1832"><a href="#cb209-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1833"><a href="#cb209-1833" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb209-1834"><a href="#cb209-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1837"><a href="#cb209-1837" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1838"><a href="#cb209-1838" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1839"><a href="#cb209-1839" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1840"><a href="#cb209-1840" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1841"><a href="#cb209-1841" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb209-1842"><a href="#cb209-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1843"><a href="#cb209-1843" aria-hidden="true" tabindex="-1"></a>display(Markdown(</span>
<span id="cb209-1844"><a href="#cb209-1844" aria-hidden="true" tabindex="-1"></a><span class="ss">f"""</span></span>
<span id="cb209-1845"><a href="#cb209-1845" aria-hidden="true" tabindex="-1"></a><span class="ss">The Bidirectional LSTM with L2 Regularization outputted a train RMSE of </span><span class="sc">{</span>train_rmse_7<span class="sc">:.2f}</span><span class="ss"> and test RMSE is </span><span class="sc">{</span>test_rmse_7<span class="sc">:.2f}</span><span class="ss">. It performs worse than Bidirectional LSTM without L2 Regularization and significantly worse than the Simple RNN with L2 Regularization and the GRU with L2 Regularization. Now, we can conclude that the GRU with L2 Regularization is the best performing model. But, will it be the best when predicting the number of attacks for the next 5 years instead of 2 years as seen above? Let's find out. </span></span>
<span id="cb209-1846"><a href="#cb209-1846" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb209-1847"><a href="#cb209-1847" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb209-1848"><a href="#cb209-1848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1849"><a href="#cb209-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1850"><a href="#cb209-1850" aria-hidden="true" tabindex="-1"></a><span class="fu"># Final Results Table</span></span>
<span id="cb209-1851"><a href="#cb209-1851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1854"><a href="#cb209-1854" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1855"><a href="#cb209-1855" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1856"><a href="#cb209-1856" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1857"><a href="#cb209-1857" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1858"><a href="#cb209-1858" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the header row of the table</span></span>
<span id="cb209-1859"><a href="#cb209-1859" aria-hidden="true" tabindex="-1"></a>rmse_table <span class="op">=</span> <span class="st">"| Model | L2 Regularization | Train RMSE | Test RMSE |</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb209-1860"><a href="#cb209-1860" aria-hidden="true" tabindex="-1"></a>rmse_table <span class="op">+=</span> <span class="st">"|-------|----------------|------------|-----------|</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb209-1861"><a href="#cb209-1861" aria-hidden="true" tabindex="-1"></a>rmse_table <span class="op">+=</span> <span class="ss">f"| Simple RNN | No | </span><span class="sc">{</span>train_rmse_1<span class="sc">:.2f}</span><span class="ss"> | </span><span class="sc">{</span>test_rmse_1<span class="sc">:.2f}</span><span class="ss"> |</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb209-1862"><a href="#cb209-1862" aria-hidden="true" tabindex="-1"></a>rmse_table <span class="op">+=</span> <span class="ss">f"| Simple RNN | Yes | </span><span class="sc">{</span>train_rmse_2<span class="sc">:.2f}</span><span class="ss"> | </span><span class="sc">{</span>test_rmse_2<span class="sc">:.2f}</span><span class="ss"> |</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb209-1863"><a href="#cb209-1863" aria-hidden="true" tabindex="-1"></a>rmse_table <span class="op">+=</span> <span class="ss">f"| GRU  | Yes | </span><span class="sc">{</span>train_rmse_3<span class="sc">:.2f}</span><span class="ss"> | </span><span class="sc">{</span>test_rmse_3<span class="sc">:.2f}</span><span class="ss"> |</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb209-1864"><a href="#cb209-1864" aria-hidden="true" tabindex="-1"></a>rmse_table <span class="op">+=</span> <span class="ss">f"| Bidirectional GRU | No | </span><span class="sc">{</span>train_rmse_4<span class="sc">:.2f}</span><span class="ss"> | </span><span class="sc">{</span>test_rmse_4<span class="sc">:.2f}</span><span class="ss"> |</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb209-1865"><a href="#cb209-1865" aria-hidden="true" tabindex="-1"></a>rmse_table <span class="op">+=</span> <span class="ss">f"| Stacked Bidirectional GRU | Yes | </span><span class="sc">{</span>train_rmse_5<span class="sc">:.2f}</span><span class="ss"> | </span><span class="sc">{</span>test_rmse_5<span class="sc">:.2f}</span><span class="ss"> |</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb209-1866"><a href="#cb209-1866" aria-hidden="true" tabindex="-1"></a>rmse_table <span class="op">+=</span> <span class="ss">f"| Bidirectional LSTM | No | </span><span class="sc">{</span>train_rmse_6<span class="sc">:.2f}</span><span class="ss"> | </span><span class="sc">{</span>test_rmse_6<span class="sc">:.2f}</span><span class="ss"> |</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb209-1867"><a href="#cb209-1867" aria-hidden="true" tabindex="-1"></a>rmse_table <span class="op">+=</span> <span class="ss">f"| Bidirectional LSTM | Yes | </span><span class="sc">{</span>train_rmse_7<span class="sc">:.2f}</span><span class="ss"> | </span><span class="sc">{</span>test_rmse_7<span class="sc">:.2f}</span><span class="ss"> |</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb209-1868"><a href="#cb209-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1869"><a href="#cb209-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1870"><a href="#cb209-1870" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the markdown table using the `display()` function:</span></span>
<span id="cb209-1871"><a href="#cb209-1871" aria-hidden="true" tabindex="-1"></a>display(Markdown(rmse_table))</span>
<span id="cb209-1872"><a href="#cb209-1872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1873"><a href="#cb209-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1874"><a href="#cb209-1874" aria-hidden="true" tabindex="-1"></a><span class="fu"># How Far Into The Future Can We Predict?</span></span>
<span id="cb209-1875"><a href="#cb209-1875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1876"><a href="#cb209-1876" aria-hidden="true" tabindex="-1"></a>Up until this point, we assessed the models' prediction power for 2 years. Now, we will assess the models' prediction power for 5 years. For this exercise, we shall pick the best performing models (from the three unique models - Simple RNN, GRU, and Bidirectional LSTM), which include the following:</span>
<span id="cb209-1877"><a href="#cb209-1877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1878"><a href="#cb209-1878" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Simple RNN with L2 Regularization</span>
<span id="cb209-1879"><a href="#cb209-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1880"><a href="#cb209-1880" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>GRU with L2 Regularization</span>
<span id="cb209-1881"><a href="#cb209-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1882"><a href="#cb209-1882" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Bidirectional LSTM (no regularization)</span>
<span id="cb209-1883"><a href="#cb209-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1886"><a href="#cb209-1886" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1887"><a href="#cb209-1887" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1888"><a href="#cb209-1888" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1889"><a href="#cb209-1889" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1890"><a href="#cb209-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1891"><a href="#cb209-1891" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb209-1892"><a href="#cb209-1892" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb209-1893"><a href="#cb209-1893" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb209-1894"><a href="#cb209-1894" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb209-1895"><a href="#cb209-1895" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb209-1896"><a href="#cb209-1896" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> SimpleRNN, Dense, LSTM, GRU, Bidirectional</span>
<span id="cb209-1897"><a href="#cb209-1897" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> regularizers</span>
<span id="cb209-1898"><a href="#cb209-1898" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb209-1899"><a href="#cb209-1899" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> RMSprop</span>
<span id="cb209-1900"><a href="#cb209-1900" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb209-1901"><a href="#cb209-1901" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb209-1902"><a href="#cb209-1902" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb209-1903"><a href="#cb209-1903" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb209-1904"><a href="#cb209-1904" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb209-1905"><a href="#cb209-1905" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb209-1906"><a href="#cb209-1906" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb209-1907"><a href="#cb209-1907" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">82716</span>)</span>
<span id="cb209-1908"><a href="#cb209-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1909"><a href="#cb209-1909" aria-hidden="true" tabindex="-1"></a><span class="co"># read in data and convert to numpy array</span></span>
<span id="cb209-1910"><a href="#cb209-1910" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">"univariate_train.csv"</span>)</span>
<span id="cb209-1911"><a href="#cb209-1911" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">"univariate_test.csv"</span>)</span>
<span id="cb209-1912"><a href="#cb209-1912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1913"><a href="#cb209-1913" aria-hidden="true" tabindex="-1"></a><span class="co"># concatenate training and test data</span></span>
<span id="cb209-1914"><a href="#cb209-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1915"><a href="#cb209-1915" aria-hidden="true" tabindex="-1"></a>combined_train_test <span class="op">=</span> pd.concat([train,test],axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb209-1916"><a href="#cb209-1916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1917"><a href="#cb209-1917" aria-hidden="true" tabindex="-1"></a><span class="co"># split into train and test data (test data = 5 years = 60 months or 60 time steps/observations)</span></span>
<span id="cb209-1918"><a href="#cb209-1918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1919"><a href="#cb209-1919" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> np.array(combined_train_test[<span class="dv">0</span>:<span class="dv">552</span>])</span>
<span id="cb209-1920"><a href="#cb209-1920" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> np.array(combined_train_test[<span class="dv">552</span>:])</span>
<span id="cb209-1921"><a href="#cb209-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1922"><a href="#cb209-1922" aria-hidden="true" tabindex="-1"></a><span class="co"># normalize values</span></span>
<span id="cb209-1923"><a href="#cb209-1923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1924"><a href="#cb209-1924" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb209-1925"><a href="#cb209-1925" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> scaler.fit_transform(train_data).flatten()</span>
<span id="cb209-1926"><a href="#cb209-1926" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> scaler.fit_transform(test_data).flatten()</span>
<span id="cb209-1927"><a href="#cb209-1927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1928"><a href="#cb209-1928" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data.shape)</span>
<span id="cb209-1929"><a href="#cb209-1929" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test_data.shape)</span>
<span id="cb209-1930"><a href="#cb209-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1931"><a href="#cb209-1931" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb209-1932"><a href="#cb209-1932" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb209-1933"><a href="#cb209-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1934"><a href="#cb209-1934" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb209-1935"><a href="#cb209-1935" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb209-1936"><a href="#cb209-1936" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb209-1937"><a href="#cb209-1937" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb209-1938"><a href="#cb209-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1939"><a href="#cb209-1939" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb209-1940"><a href="#cb209-1940" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb209-1941"><a href="#cb209-1941" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb209-1942"><a href="#cb209-1942" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb209-1943"><a href="#cb209-1943" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb209-1944"><a href="#cb209-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1945"><a href="#cb209-1945" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb209-1946"><a href="#cb209-1946" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb209-1947"><a href="#cb209-1947" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-1948"><a href="#cb209-1948" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb209-1949"><a href="#cb209-1949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1950"><a href="#cb209-1950" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb209-1951"><a href="#cb209-1951" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb209-1952"><a href="#cb209-1952" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb209-1953"><a href="#cb209-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1954"><a href="#cb209-1954" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span>
<span id="cb209-1955"><a href="#cb209-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1956"><a href="#cb209-1956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1957"><a href="#cb209-1957" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb209-1958"><a href="#cb209-1958" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">10</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb209-1959"><a href="#cb209-1959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1960"><a href="#cb209-1960" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb209-1961"><a href="#cb209-1961" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span>
<span id="cb209-1962"><a href="#cb209-1962" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1963"><a href="#cb209-1963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1964"><a href="#cb209-1964" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simple RNN with L2 Regularization</span></span>
<span id="cb209-1965"><a href="#cb209-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1968"><a href="#cb209-1968" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1969"><a href="#cb209-1969" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1970"><a href="#cb209-1970" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1971"><a href="#cb209-1971" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1972"><a href="#cb209-1972" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb209-1973"><a href="#cb209-1973" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb209-1974"><a href="#cb209-1974" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb209-1975"><a href="#cb209-1975" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb209-1976"><a href="#cb209-1976" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb209-1977"><a href="#cb209-1977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-1978"><a href="#cb209-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1981"><a href="#cb209-1981" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-1982"><a href="#cb209-1982" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-1983"><a href="#cb209-1983" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-1984"><a href="#cb209-1984" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-1985"><a href="#cb209-1985" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb209-1986"><a href="#cb209-1986" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb209-1987"><a href="#cb209-1987" aria-hidden="true" tabindex="-1"></a>model.add(SimpleRNN(</span>
<span id="cb209-1988"><a href="#cb209-1988" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb209-1989"><a href="#cb209-1989" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb209-1990"><a href="#cb209-1990" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb209-1991"><a href="#cb209-1991" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb209-1992"><a href="#cb209-1992" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb209-1993"><a href="#cb209-1993" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb209-1994"><a href="#cb209-1994" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb209-1995"><a href="#cb209-1995" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb209-1996"><a href="#cb209-1996" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb209-1997"><a href="#cb209-1997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-1998"><a href="#cb209-1998" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb209-1999"><a href="#cb209-1999" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb209-2000"><a href="#cb209-2000" aria-hidden="true" tabindex="-1"></a><span class="co">#model.summary()</span></span>
<span id="cb209-2001"><a href="#cb209-2001" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2002"><a href="#cb209-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2005"><a href="#cb209-2005" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2006"><a href="#cb209-2006" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2007"><a href="#cb209-2007" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2008"><a href="#cb209-2008" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2009"><a href="#cb209-2009" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb209-2010"><a href="#cb209-2010" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb209-2011"><a href="#cb209-2011" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb209-2012"><a href="#cb209-2012" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb209-2013"><a href="#cb209-2013" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb209-2014"><a href="#cb209-2014" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb209-2015"><a href="#cb209-2015" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span>
<span id="cb209-2016"><a href="#cb209-2016" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2017"><a href="#cb209-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2018"><a href="#cb209-2018" aria-hidden="true" tabindex="-1"></a>:::panel-tabset</span>
<span id="cb209-2019"><a href="#cb209-2019" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Fitting History</span></span>
<span id="cb209-2020"><a href="#cb209-2020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2023"><a href="#cb209-2023" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2024"><a href="#cb209-2024" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2025"><a href="#cb209-2025" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2026"><a href="#cb209-2026" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2027"><a href="#cb209-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2028"><a href="#cb209-2028" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb209-2029"><a href="#cb209-2029" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb209-2030"><a href="#cb209-2030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2031"><a href="#cb209-2031" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb209-2032"><a href="#cb209-2032" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb209-2033"><a href="#cb209-2033" aria-hidden="true" tabindex="-1"></a>unnormalized_train_predict <span class="op">=</span> scaler.inverse_transform(train_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2034"><a href="#cb209-2034" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb209-2035"><a href="#cb209-2035" aria-hidden="true" tabindex="-1"></a>unnormalized_test_predict <span class="op">=</span> scaler.inverse_transform(test_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2036"><a href="#cb209-2036" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></span>
<span id="cb209-2037"><a href="#cb209-2037" aria-hidden="true" tabindex="-1"></a>trainY_unnormalized <span class="op">=</span> scaler.inverse_transform(trainY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2038"><a href="#cb209-2038" aria-hidden="true" tabindex="-1"></a>testY_unnormalized <span class="op">=</span> scaler.inverse_transform(testY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2039"><a href="#cb209-2039" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb209-2040"><a href="#cb209-2040" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainY.shape, train_predict.shape)</span></span>
<span id="cb209-2041"><a href="#cb209-2041" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb209-2042"><a href="#cb209-2042" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb209-2043"><a href="#cb209-2043" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((trainY-train_predict)**2.0))</span></span>
<span id="cb209-2044"><a href="#cb209-2044" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((testY-test_predict)**2.0))</span></span>
<span id="cb209-2045"><a href="#cb209-2045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2046"><a href="#cb209-2046" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse<span class="op">**</span><span class="fl">2.0</span>,train_rmse))</span>
<span id="cb209-2047"><a href="#cb209-2047" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse<span class="op">**</span><span class="fl">2.0</span>,test_rmse))    </span>
<span id="cb209-2048"><a href="#cb209-2048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2049"><a href="#cb209-2049" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb209-2050"><a href="#cb209-2050" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Training Loss (Red) vs Validation Loss (Blue)"</span>,x_label<span class="op">=</span><span class="st">"Number of Training Epochs"</span>,y_label<span class="op">=</span><span class="st">"Loss (MSE)"</span>)</span>
<span id="cb209-2051"><a href="#cb209-2051" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2052"><a href="#cb209-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2053"><a href="#cb209-2053" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Parity Plot (Unnormalized Data)</span></span>
<span id="cb209-2054"><a href="#cb209-2054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2057"><a href="#cb209-2057" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2058"><a href="#cb209-2058" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2059"><a href="#cb209-2059" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2060"><a href="#cb209-2060" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2061"><a href="#cb209-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2062"><a href="#cb209-2062" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb209-2063"><a href="#cb209-2063" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-2064"><a href="#cb209-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2065"><a href="#cb209-2065" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_train_predict.flatten(),height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb209-2066"><a href="#cb209-2066" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_test_predict.flatten(),mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb209-2067"><a href="#cb209-2067" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>trainY_unnormalized.flatten(), mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb209-2068"><a href="#cb209-2068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2069"><a href="#cb209-2069" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb209-2070"><a href="#cb209-2070" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb209-2071"><a href="#cb209-2071" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb209-2072"><a href="#cb209-2072" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-2073"><a href="#cb209-2073" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb209-2074"><a href="#cb209-2074" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-2075"><a href="#cb209-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2076"><a href="#cb209-2076" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb209-2077"><a href="#cb209-2077" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2078"><a href="#cb209-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2079"><a href="#cb209-2079" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Predictions (Unnormalized Data)</span></span>
<span id="cb209-2080"><a href="#cb209-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2083"><a href="#cb209-2083" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2084"><a href="#cb209-2084" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2085"><a href="#cb209-2085" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2086"><a href="#cb209-2086" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2087"><a href="#cb209-2087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2088"><a href="#cb209-2088" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT THE RESULT</span></span>
<span id="cb209-2089"><a href="#cb209-2089" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb209-2090"><a href="#cb209-2090" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-2091"><a href="#cb209-2091" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb209-2092"><a href="#cb209-2092" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(X.shape,Y.shape)</span></span>
<span id="cb209-2093"><a href="#cb209-2093" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, scaler.inverse_transform(Y.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="fl">3.2</span>),<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb209-2094"><a href="#cb209-2094" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, scaler.inverse_transform(X.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="fl">3.2</span>),<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb209-2095"><a href="#cb209-2095" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb209-2096"><a href="#cb209-2096" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb209-2097"><a href="#cb209-2097" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb209-2098"><a href="#cb209-2098" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb209-2099"><a href="#cb209-2099" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of attacks'</span>)</span>
<span id="cb209-2100"><a href="#cb209-2100" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual vs Predicted Values'</span>)</span>
<span id="cb209-2101"><a href="#cb209-2101" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb209-2102"><a href="#cb209-2102" aria-hidden="true" tabindex="-1"></a>plot_result(trainY_unnormalized, testY_unnormalized, unnormalized_train_predict, unnormalized_test_predict)</span>
<span id="cb209-2103"><a href="#cb209-2103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2104"><a href="#cb209-2104" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb209-2105"><a href="#cb209-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2106"><a href="#cb209-2106" aria-hidden="true" tabindex="-1"></a><span class="fu">## GRU with L2 Regularization</span></span>
<span id="cb209-2107"><a href="#cb209-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2110"><a href="#cb209-2110" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2111"><a href="#cb209-2111" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2112"><a href="#cb209-2112" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2113"><a href="#cb209-2113" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2114"><a href="#cb209-2114" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb209-2115"><a href="#cb209-2115" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb209-2116"><a href="#cb209-2116" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb209-2117"><a href="#cb209-2117" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb209-2118"><a href="#cb209-2118" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb209-2119"><a href="#cb209-2119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2120"><a href="#cb209-2120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2123"><a href="#cb209-2123" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2124"><a href="#cb209-2124" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2125"><a href="#cb209-2125" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2126"><a href="#cb209-2126" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2127"><a href="#cb209-2127" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb209-2128"><a href="#cb209-2128" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb209-2129"><a href="#cb209-2129" aria-hidden="true" tabindex="-1"></a>model.add(GRU(</span>
<span id="cb209-2130"><a href="#cb209-2130" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb209-2131"><a href="#cb209-2131" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb209-2132"><a href="#cb209-2132" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb209-2133"><a href="#cb209-2133" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-2</span>),</span>
<span id="cb209-2134"><a href="#cb209-2134" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb209-2135"><a href="#cb209-2135" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb209-2136"><a href="#cb209-2136" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb209-2137"><a href="#cb209-2137" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb209-2138"><a href="#cb209-2138" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb209-2139"><a href="#cb209-2139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2140"><a href="#cb209-2140" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb209-2141"><a href="#cb209-2141" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb209-2142"><a href="#cb209-2142" aria-hidden="true" tabindex="-1"></a><span class="co">#model.summary()</span></span>
<span id="cb209-2143"><a href="#cb209-2143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2144"><a href="#cb209-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2147"><a href="#cb209-2147" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2148"><a href="#cb209-2148" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2149"><a href="#cb209-2149" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2150"><a href="#cb209-2150" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2151"><a href="#cb209-2151" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb209-2152"><a href="#cb209-2152" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb209-2153"><a href="#cb209-2153" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb209-2154"><a href="#cb209-2154" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb209-2155"><a href="#cb209-2155" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb209-2156"><a href="#cb209-2156" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb209-2157"><a href="#cb209-2157" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span>
<span id="cb209-2158"><a href="#cb209-2158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2159"><a href="#cb209-2159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2160"><a href="#cb209-2160" aria-hidden="true" tabindex="-1"></a>:::panel-tabset</span>
<span id="cb209-2161"><a href="#cb209-2161" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Fitting History</span></span>
<span id="cb209-2162"><a href="#cb209-2162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2165"><a href="#cb209-2165" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2166"><a href="#cb209-2166" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2167"><a href="#cb209-2167" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2168"><a href="#cb209-2168" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2169"><a href="#cb209-2169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2170"><a href="#cb209-2170" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb209-2171"><a href="#cb209-2171" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb209-2172"><a href="#cb209-2172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2173"><a href="#cb209-2173" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb209-2174"><a href="#cb209-2174" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb209-2175"><a href="#cb209-2175" aria-hidden="true" tabindex="-1"></a>unnormalized_train_predict <span class="op">=</span> scaler.inverse_transform(train_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2176"><a href="#cb209-2176" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb209-2177"><a href="#cb209-2177" aria-hidden="true" tabindex="-1"></a>unnormalized_test_predict <span class="op">=</span> scaler.inverse_transform(test_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2178"><a href="#cb209-2178" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></span>
<span id="cb209-2179"><a href="#cb209-2179" aria-hidden="true" tabindex="-1"></a>trainY_unnormalized <span class="op">=</span> scaler.inverse_transform(trainY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2180"><a href="#cb209-2180" aria-hidden="true" tabindex="-1"></a>testY_unnormalized <span class="op">=</span> scaler.inverse_transform(testY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2181"><a href="#cb209-2181" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb209-2182"><a href="#cb209-2182" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainY.shape, train_predict.shape)</span></span>
<span id="cb209-2183"><a href="#cb209-2183" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb209-2184"><a href="#cb209-2184" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb209-2185"><a href="#cb209-2185" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((trainY-train_predict)**2.0))</span></span>
<span id="cb209-2186"><a href="#cb209-2186" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((testY-test_predict)**2.0))</span></span>
<span id="cb209-2187"><a href="#cb209-2187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2188"><a href="#cb209-2188" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse<span class="op">**</span><span class="fl">2.0</span>,train_rmse))</span>
<span id="cb209-2189"><a href="#cb209-2189" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse<span class="op">**</span><span class="fl">2.0</span>,test_rmse))    </span>
<span id="cb209-2190"><a href="#cb209-2190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2191"><a href="#cb209-2191" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb209-2192"><a href="#cb209-2192" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Training Loss (Red) vs Validation Loss (Blue)"</span>,x_label<span class="op">=</span><span class="st">"Number of Training Epochs"</span>,y_label<span class="op">=</span><span class="st">"Loss (MSE)"</span>)</span>
<span id="cb209-2193"><a href="#cb209-2193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2194"><a href="#cb209-2194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2195"><a href="#cb209-2195" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Parity Plot (Unnormalized Data)</span></span>
<span id="cb209-2196"><a href="#cb209-2196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2199"><a href="#cb209-2199" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2200"><a href="#cb209-2200" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2201"><a href="#cb209-2201" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2202"><a href="#cb209-2202" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2203"><a href="#cb209-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2204"><a href="#cb209-2204" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb209-2205"><a href="#cb209-2205" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-2206"><a href="#cb209-2206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2207"><a href="#cb209-2207" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_train_predict.flatten(),height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb209-2208"><a href="#cb209-2208" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_test_predict.flatten(),mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb209-2209"><a href="#cb209-2209" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>trainY_unnormalized.flatten(), mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb209-2210"><a href="#cb209-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2211"><a href="#cb209-2211" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb209-2212"><a href="#cb209-2212" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb209-2213"><a href="#cb209-2213" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb209-2214"><a href="#cb209-2214" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-2215"><a href="#cb209-2215" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb209-2216"><a href="#cb209-2216" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-2217"><a href="#cb209-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2218"><a href="#cb209-2218" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb209-2219"><a href="#cb209-2219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2220"><a href="#cb209-2220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2221"><a href="#cb209-2221" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Predictions (Unnormalized Data)</span></span>
<span id="cb209-2222"><a href="#cb209-2222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2225"><a href="#cb209-2225" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2226"><a href="#cb209-2226" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2227"><a href="#cb209-2227" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2228"><a href="#cb209-2228" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2229"><a href="#cb209-2229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2230"><a href="#cb209-2230" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT THE RESULT</span></span>
<span id="cb209-2231"><a href="#cb209-2231" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb209-2232"><a href="#cb209-2232" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-2233"><a href="#cb209-2233" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb209-2234"><a href="#cb209-2234" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(X.shape,Y.shape)</span></span>
<span id="cb209-2235"><a href="#cb209-2235" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, scaler.inverse_transform(Y.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="fl">3.2</span>),<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb209-2236"><a href="#cb209-2236" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, scaler.inverse_transform(X.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="fl">3.2</span>),<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb209-2237"><a href="#cb209-2237" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb209-2238"><a href="#cb209-2238" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb209-2239"><a href="#cb209-2239" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb209-2240"><a href="#cb209-2240" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb209-2241"><a href="#cb209-2241" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of attacks'</span>)</span>
<span id="cb209-2242"><a href="#cb209-2242" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual vs Predicted Values'</span>)</span>
<span id="cb209-2243"><a href="#cb209-2243" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb209-2244"><a href="#cb209-2244" aria-hidden="true" tabindex="-1"></a>plot_result(trainY_unnormalized, testY_unnormalized, unnormalized_train_predict, unnormalized_test_predict)</span>
<span id="cb209-2245"><a href="#cb209-2245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2246"><a href="#cb209-2246" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb209-2247"><a href="#cb209-2247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2248"><a href="#cb209-2248" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bidirectional LSTM (no regularization)</span></span>
<span id="cb209-2249"><a href="#cb209-2249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2252"><a href="#cb209-2252" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2253"><a href="#cb209-2253" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2254"><a href="#cb209-2254" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2255"><a href="#cb209-2255" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2256"><a href="#cb209-2256" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb209-2257"><a href="#cb209-2257" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">100</span></span>
<span id="cb209-2258"><a href="#cb209-2258" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb209-2259"><a href="#cb209-2259" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb209-2260"><a href="#cb209-2260" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb209-2261"><a href="#cb209-2261" aria-hidden="true" tabindex="-1"></a>callback <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'loss'</span>, patience<span class="op">=</span><span class="dv">3</span>) <span class="co"># This callback will stop the training when there is no improvement in the loss for three consecutive epochs</span></span>
<span id="cb209-2262"><a href="#cb209-2262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2263"><a href="#cb209-2263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2266"><a href="#cb209-2266" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2267"><a href="#cb209-2267" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2268"><a href="#cb209-2268" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2269"><a href="#cb209-2269" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2270"><a href="#cb209-2270" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb209-2271"><a href="#cb209-2271" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb209-2272"><a href="#cb209-2272" aria-hidden="true" tabindex="-1"></a>model.add(Bidirectional(LSTM(</span>
<span id="cb209-2273"><a href="#cb209-2273" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb209-2274"><a href="#cb209-2274" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb209-2275"><a href="#cb209-2275" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]),</span>
<span id="cb209-2276"><a href="#cb209-2276" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb209-2277"><a href="#cb209-2277" aria-hidden="true" tabindex="-1"></a>          )) </span>
<span id="cb209-2278"><a href="#cb209-2278" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb209-2279"><a href="#cb209-2279" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb209-2280"><a href="#cb209-2280" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb209-2281"><a href="#cb209-2281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2282"><a href="#cb209-2282" aria-hidden="true" tabindex="-1"></a><span class="co"># BUILD THE MODEL </span></span>
<span id="cb209-2283"><a href="#cb209-2283" aria-hidden="true" tabindex="-1"></a>model.build(input_shape<span class="op">=</span>(<span class="va">None</span>, trainX.shape[<span class="dv">1</span>], trainX.shape[<span class="dv">2</span>]))</span>
<span id="cb209-2284"><a href="#cb209-2284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2285"><a href="#cb209-2285" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb209-2286"><a href="#cb209-2286" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb209-2287"><a href="#cb209-2287" aria-hidden="true" tabindex="-1"></a><span class="co">#model.summary()</span></span>
<span id="cb209-2288"><a href="#cb209-2288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2289"><a href="#cb209-2289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2292"><a href="#cb209-2292" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2293"><a href="#cb209-2293" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2294"><a href="#cb209-2294" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2295"><a href="#cb209-2295" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2296"><a href="#cb209-2296" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb209-2297"><a href="#cb209-2297" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb209-2298"><a href="#cb209-2298" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb209-2299"><a href="#cb209-2299" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, <span class="co"># how many times to go through the entire dataset</span></span>
<span id="cb209-2300"><a href="#cb209-2300" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), <span class="co"># 20% of training data as batch size</span></span>
<span id="cb209-2301"><a href="#cb209-2301" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co">#use 20% of training data for validation</span></span>
<span id="cb209-2302"><a href="#cb209-2302" aria-hidden="true" tabindex="-1"></a>callbacks<span class="op">=</span>[callback], <span class="co">#early stopping</span></span>
<span id="cb209-2303"><a href="#cb209-2303" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">0</span>) <span class="co">#suppress messages</span></span>
<span id="cb209-2304"><a href="#cb209-2304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2305"><a href="#cb209-2305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2306"><a href="#cb209-2306" aria-hidden="true" tabindex="-1"></a>:::panel-tabset</span>
<span id="cb209-2307"><a href="#cb209-2307" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Fitting History</span></span>
<span id="cb209-2308"><a href="#cb209-2308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2311"><a href="#cb209-2311" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2312"><a href="#cb209-2312" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2313"><a href="#cb209-2313" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2314"><a href="#cb209-2314" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2315"><a href="#cb209-2315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2316"><a href="#cb209-2316" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb209-2317"><a href="#cb209-2317" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb209-2318"><a href="#cb209-2318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2319"><a href="#cb209-2319" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb209-2320"><a href="#cb209-2320" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb209-2321"><a href="#cb209-2321" aria-hidden="true" tabindex="-1"></a>unnormalized_train_predict <span class="op">=</span> scaler.inverse_transform(train_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2322"><a href="#cb209-2322" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb209-2323"><a href="#cb209-2323" aria-hidden="true" tabindex="-1"></a>unnormalized_test_predict <span class="op">=</span> scaler.inverse_transform(test_predict.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2324"><a href="#cb209-2324" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></span>
<span id="cb209-2325"><a href="#cb209-2325" aria-hidden="true" tabindex="-1"></a>trainY_unnormalized <span class="op">=</span> scaler.inverse_transform(trainY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2326"><a href="#cb209-2326" aria-hidden="true" tabindex="-1"></a>testY_unnormalized <span class="op">=</span> scaler.inverse_transform(testY.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-2327"><a href="#cb209-2327" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb209-2328"><a href="#cb209-2328" aria-hidden="true" tabindex="-1"></a><span class="co">#print(trainY.shape, train_predict.shape)</span></span>
<span id="cb209-2329"><a href="#cb209-2329" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb209-2330"><a href="#cb209-2330" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb209-2331"><a href="#cb209-2331" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((trainY-train_predict)**2.0))</span></span>
<span id="cb209-2332"><a href="#cb209-2332" aria-hidden="true" tabindex="-1"></a><span class="co">#print(np.mean((testY-test_predict)**2.0))</span></span>
<span id="cb209-2333"><a href="#cb209-2333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2334"><a href="#cb209-2334" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse<span class="op">**</span><span class="fl">2.0</span>,train_rmse))</span>
<span id="cb209-2335"><a href="#cb209-2335" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse<span class="op">**</span><span class="fl">2.0</span>,test_rmse))    </span>
<span id="cb209-2336"><a href="#cb209-2336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2337"><a href="#cb209-2337" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb209-2338"><a href="#cb209-2338" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Training Loss (Red) vs Validation Loss (Blue)"</span>,x_label<span class="op">=</span><span class="st">"Number of Training Epochs"</span>,y_label<span class="op">=</span><span class="st">"Loss (MSE)"</span>)</span>
<span id="cb209-2339"><a href="#cb209-2339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2340"><a href="#cb209-2340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2341"><a href="#cb209-2341" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Parity Plot (Unnormalized Data)</span></span>
<span id="cb209-2342"><a href="#cb209-2342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2345"><a href="#cb209-2345" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2346"><a href="#cb209-2346" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2347"><a href="#cb209-2347" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2348"><a href="#cb209-2348" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2349"><a href="#cb209-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2350"><a href="#cb209-2350" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb209-2351"><a href="#cb209-2351" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb209-2352"><a href="#cb209-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2353"><a href="#cb209-2353" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_train_predict.flatten(),height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb209-2354"><a href="#cb209-2354" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY_unnormalized.flatten(),y<span class="op">=</span>unnormalized_test_predict.flatten(),mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb209-2355"><a href="#cb209-2355" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY_unnormalized.flatten(),y<span class="op">=</span>trainY_unnormalized.flatten(), mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb209-2356"><a href="#cb209-2356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2357"><a href="#cb209-2357" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb209-2358"><a href="#cb209-2358" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb209-2359"><a href="#cb209-2359" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb209-2360"><a href="#cb209-2360" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb209-2361"><a href="#cb209-2361" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb209-2362"><a href="#cb209-2362" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-2363"><a href="#cb209-2363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2364"><a href="#cb209-2364" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb209-2365"><a href="#cb209-2365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2366"><a href="#cb209-2366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2367"><a href="#cb209-2367" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualize Predictions (Unnormalized Data)</span></span>
<span id="cb209-2368"><a href="#cb209-2368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2371"><a href="#cb209-2371" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb209-2372"><a href="#cb209-2372" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb209-2373"><a href="#cb209-2373" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb209-2374"><a href="#cb209-2374" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb209-2375"><a href="#cb209-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2376"><a href="#cb209-2376" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT THE RESULT</span></span>
<span id="cb209-2377"><a href="#cb209-2377" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb209-2378"><a href="#cb209-2378" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb209-2379"><a href="#cb209-2379" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb209-2380"><a href="#cb209-2380" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(X.shape,Y.shape)</span></span>
<span id="cb209-2381"><a href="#cb209-2381" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, scaler.inverse_transform(Y.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="fl">3.2</span>),<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb209-2382"><a href="#cb209-2382" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, scaler.inverse_transform(X.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="op">*</span><span class="fl">3.2</span>),<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb209-2383"><a href="#cb209-2383" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb209-2384"><a href="#cb209-2384" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, unnormalized_train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb209-2385"><a href="#cb209-2385" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb209-2386"><a href="#cb209-2386" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb209-2387"><a href="#cb209-2387" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Number of attacks'</span>)</span>
<span id="cb209-2388"><a href="#cb209-2388" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual vs Predicted Values'</span>)</span>
<span id="cb209-2389"><a href="#cb209-2389" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb209-2390"><a href="#cb209-2390" aria-hidden="true" tabindex="-1"></a>plot_result(trainY_unnormalized, testY_unnormalized, unnormalized_train_predict, unnormalized_test_predict)</span>
<span id="cb209-2391"><a href="#cb209-2391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb209-2392"><a href="#cb209-2392" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb209-2393"><a href="#cb209-2393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2394"><a href="#cb209-2394" aria-hidden="true" tabindex="-1"></a><span class="fu">## Discussion</span></span>
<span id="cb209-2395"><a href="#cb209-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2396"><a href="#cb209-2396" aria-hidden="true" tabindex="-1"></a>Wow, the LSTM model outputs the lowest RMSE when the size of the test set is increased! This is a very interesting result, and it is likely due to the fact that the LSTM model is better able to capture the seasonality of the data when testing for number of attacks after 2016. Therefore, when predicting more time steps in the future, the LSTM model is better able to generalize to unseen data and could be recommended for future use.</span>
<span id="cb209-2397"><a href="#cb209-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2398"><a href="#cb209-2398" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparison with ARIMA and SARIMA</span></span>
<span id="cb209-2399"><a href="#cb209-2399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2400"><a href="#cb209-2400" aria-hidden="true" tabindex="-1"></a>From the <span class="co">[</span><span class="ot">ARMA/ARIMA/SARIMA section</span><span class="co">](https://tegveerg.georgetown.domains/Time-Series-Project/ARMA-ARIMA-SARIMA.html)</span>, we observed that both the ARIMA models, <span class="in">`ARIMA(0,1,1)`</span> AND <span class="in">`ARIMA(2,1,3)`</span>, were subpar at forecasting the number of attacks for 2 years. The forecasting results of ARIMA are shown below:</span>
<span id="cb209-2401"><a href="#cb209-2401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2402"><a href="#cb209-2402" aria-hidden="true" tabindex="-1"></a><span class="al">![](ARIMA_forecast.png)</span></span>
<span id="cb209-2403"><a href="#cb209-2403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2404"><a href="#cb209-2404" aria-hidden="true" tabindex="-1"></a>The SARIMA model (<span class="in">`ARIMA(0,1,1)(0,1,1)`</span>), on the other hand, was better able to capture both the seasonality and trend in the data, and was able to forecast the number of attacks for 2 years with a Train RMSE of 4.317518. Although this RMSE metric for SARIMA is significantly higher than those of all the Recurrent Neural Networks tested in this section, it should be noted that relatively simpler models, including SARIMA, are still powerful in forecasting the number of attacks for the next 3 years. Moreover, we also employed Seasonal Cross-Validation for 1 step ahead (RMSE = 7.41) and 12 steps ahead forecasting (MSE = 30). Although these results seem significantly worse than those of all the Recurrent Neural Networks tested in this section, it should be noted that the SARIMA model is still able to capture the seasonality and trend in the data. Therefore, it can help us strike the balance between predictive power, interpretability, and computational efficiency. The forecasting results of SARIMA are shown below:</span>
<span id="cb209-2405"><a href="#cb209-2405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2406"><a href="#cb209-2406" aria-hidden="true" tabindex="-1"></a><span class="al">![](SARIMA_forecast.png)</span></span>
<span id="cb209-2407"><a href="#cb209-2407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2408"><a href="#cb209-2408" aria-hidden="true" tabindex="-1"></a>A major limitation for this section was the amount of data inputted to each model. It is recommended to feed in enormous amounts of data to RNNs for them to learn better representations of the model and help "capture seasonality", in our case. Elaborate hyper-parameter tuning methods, such as GridSearch CV, could also be utilized to fine-tune the performance of the model for better results.</span>
<span id="cb209-2409"><a href="#cb209-2409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2410"><a href="#cb209-2410" aria-hidden="true" tabindex="-1"></a><span class="fu">## Section Code</span></span>
<span id="cb209-2411"><a href="#cb209-2411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-2412"><a href="#cb209-2412" aria-hidden="true" tabindex="-1"></a>**Code for this section can be found [here](https://github.com/TegveerG/Time-Series-Project/blob/main/Time%20Series%20Analysis/Deep-Learning.qmd)**</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>